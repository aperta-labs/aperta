import{createRequire as ix}from"node:module";var _x=Object.create;var{getPrototypeOf:cx,defineProperty:o8,getOwnPropertyNames:dx}=Object;var lx=Object.prototype.hasOwnProperty;var mx=($,J,Q)=>{Q=$!=null?_x(cx($)):{};let z=J||!$||!$.__esModule?o8(Q,"default",{value:$,enumerable:!0}):Q;for(let q of dx($))if(!lx.call(z,q))o8(z,q,{get:()=>$[q],enumerable:!0});return z};var w=($,J)=>()=>(J||$((J={exports:{}}).exports,J),J.exports);var C=ix(import.meta.url);var d7=w((s8)=>{Object.defineProperty(s8,"__esModule",{value:!0});s8.VerbatimString=void 0;class p8 extends String{format;constructor($,J){super(J);this.format=$}}s8.VerbatimString=p8});var c=w((B4)=>{Object.defineProperty(B4,"__esModule",{value:!0});B4.MultiErrorReply=B4.CommandTimeoutDuringMaintenanceError=B4.SocketTimeoutDuringMaintenanceError=B4.TimeoutError=B4.BlobError=B4.SimpleError=B4.ErrorReply=B4.ReconnectStrategyError=B4.RootNodesUnavailableError=B4.SocketClosedUnexpectedlyError=B4.DisconnectsClientError=B4.ClientOfflineError=B4.ClientClosedError=B4.SocketTimeoutError=B4.ConnectionTimeoutError=B4.WatchError=B4.AbortError=void 0;class e8 extends Error{constructor(){super("The command was aborted")}}B4.AbortError=e8;class $4 extends Error{constructor($="One (or more) of the watched keys has been changed"){super($)}}B4.WatchError=$4;class J4 extends Error{constructor(){super("Connection timeout")}}B4.ConnectionTimeoutError=J4;class Q4 extends Error{constructor($){super(`Socket timeout timeout. Expecting data, but didn't receive any in ${$}ms.`)}}B4.SocketTimeoutError=Q4;class z4 extends Error{constructor(){super("The client is closed")}}B4.ClientClosedError=z4;class q4 extends Error{constructor(){super("The client is offline")}}B4.ClientOfflineError=q4;class w4 extends Error{constructor(){super("Disconnects client")}}B4.DisconnectsClientError=w4;class Z4 extends Error{constructor(){super("Socket closed unexpectedly")}}B4.SocketClosedUnexpectedlyError=Z4;class K4 extends Error{constructor(){super("All the root nodes are unavailable")}}B4.RootNodesUnavailableError=K4;class W4 extends Error{originalError;socketError;constructor($,J){super($.message);this.originalError=$,this.socketError=J}}B4.ReconnectStrategyError=W4;class D$ extends Error{}B4.ErrorReply=D$;class V4 extends D${}B4.SimpleError=V4;class Y4 extends D${}B4.BlobError=Y4;class r6 extends Error{}B4.TimeoutError=r6;class X4 extends r6{constructor($){super(`Socket timeout during maintenance. Expecting data, but didn't receive any in ${$}ms.`)}}B4.SocketTimeoutDuringMaintenanceError=X4;class F4 extends r6{constructor($){super(`Command timeout during maintenance. Waited to write command for more than ${$}ms.`)}}B4.CommandTimeoutDuringMaintenanceError=F4;class H4 extends D${replies;errorIndexes;constructor($,J){super(`${J.length} commands failed, see .replies and .errorIndexes for more information`);this.replies=$,this.errorIndexes=J}*errors(){for(let $ of this.errorIndexes)yield this.replies[$]}}B4.MultiErrorReply=H4});var $7=w((G4)=>{var l7;Object.defineProperty(G4,"__esModule",{value:!0});G4.Decoder=G4.PUSH_TYPE_MAPPING=G4.RESP_TYPES=void 0;var v4=d7(),e6=c();G4.RESP_TYPES={NULL:95,BOOLEAN:35,NUMBER:58,BIG_NUMBER:40,DOUBLE:44,SIMPLE_STRING:43,BLOB_STRING:36,VERBATIM_STRING:61,SIMPLE_ERROR:45,BLOB_ERROR:33,ARRAY:42,SET:126,MAP:37,PUSH:62};var N={"\r":13,t:116,"+":43,"-":45,"0":48,".":46,i:105,n:110,E:69,e:101};G4.PUSH_TYPE_MAPPING={[G4.RESP_TYPES.BLOB_STRING]:Buffer};class m7{onReply;onErrorReply;onPush;getTypeMapping;#$=0;#J;constructor($){this.onReply=$.onReply,this.onErrorReply=$.onErrorReply,this.onPush=$.onPush,this.getTypeMapping=$.getTypeMapping}reset(){this.#$=0,this.#J=void 0}write($){if(this.#$>=$.length){this.#$-=$.length;return}if(this.#J){if(this.#J($)||this.#$>=$.length){this.#$-=$.length;return}}do{let J=$[this.#$];if(++this.#$===$.length){this.#J=this.#Q.bind(this,J);break}if(this.#z(J,$))break}while(this.#$<$.length);this.#$-=$.length}#Q($,J){return this.#J=void 0,this.#z($,J)}#z($,J){switch($){case G4.RESP_TYPES.NULL:return this.onReply(this.#q()),!1;case G4.RESP_TYPES.BOOLEAN:return this.#Z(this.onReply,this.#w(J));case G4.RESP_TYPES.NUMBER:return this.#Z(this.onReply,this.#W(this.getTypeMapping()[G4.RESP_TYPES.NUMBER],J));case G4.RESP_TYPES.BIG_NUMBER:return this.#Z(this.onReply,this.#F(this.getTypeMapping()[G4.RESP_TYPES.BIG_NUMBER],J));case G4.RESP_TYPES.DOUBLE:return this.#Z(this.onReply,this.#b(this.getTypeMapping()[G4.RESP_TYPES.DOUBLE],J));case G4.RESP_TYPES.SIMPLE_STRING:return this.#Z(this.onReply,this.#N(this.getTypeMapping()[G4.RESP_TYPES.SIMPLE_STRING],J));case G4.RESP_TYPES.BLOB_STRING:return this.#Z(this.onReply,this.#C(this.getTypeMapping()[G4.RESP_TYPES.BLOB_STRING],J));case G4.RESP_TYPES.VERBATIM_STRING:return this.#Z(this.onReply,this.#M(this.getTypeMapping()[G4.RESP_TYPES.VERBATIM_STRING],J));case G4.RESP_TYPES.SIMPLE_ERROR:return this.#Z(this.onErrorReply,this.#i(J));case G4.RESP_TYPES.BLOB_ERROR:return this.#Z(this.onErrorReply,this.#t(J));case G4.RESP_TYPES.ARRAY:return this.#Z(this.onReply,this.#c(this.getTypeMapping(),J));case G4.RESP_TYPES.SET:return this.#Z(this.onReply,this.#s(this.getTypeMapping(),J));case G4.RESP_TYPES.MAP:return this.#Z(this.onReply,this.#J0(this.getTypeMapping(),J));case G4.RESP_TYPES.PUSH:return this.#Z(this.onPush,this.#c(G4.PUSH_TYPE_MAPPING,J));default:throw Error(`Unknown RESP type ${$} "${String.fromCharCode($)}"`)}}#Z($,J){if(typeof J==="function")return this.#J=this.#K.bind(this,$,J),!0;return $(J),!1}#K($,J,Q){return this.#J=void 0,this.#Z($,J(Q))}#q(){return this.#$+=2,null}#w($){let J=$[this.#$]===N.t;return this.#$+=3,J}#W($,J){if($===String)return this.#N(String,J);switch(J[this.#$]){case N["+"]:return this.#X(!1,J);case N["-"]:return this.#X(!0,J);default:return this.#B(!1,this.#Y.bind(this,0),J)}}#X($,J){let Q=this.#Y.bind(this,0);return++this.#$===J.length?this.#B.bind(this,$,Q):this.#B($,Q,J)}#B($,J,Q){let z=J(Q);return typeof z==="function"?this.#B.bind(this,$,z):$?-z:z}#Y($,J){let Q=this.#$;do{let z=J[Q];if(z===N["\r"])return this.#$=Q+2,$;$=$*10+z-N["0"]}while(++Q<J.length);return this.#$=Q,this.#Y.bind(this,$)}#F($,J){if($===String)return this.#N(String,J);switch(J[this.#$]){case N["+"]:return this.#H(!1,J);case N["-"]:return this.#H(!0,J);default:return this.#G(!1,this.#j.bind(this,0n),J)}}#H($,J){let Q=this.#j.bind(this,0n);return++this.#$===J.length?this.#G.bind(this,$,Q):this.#G($,Q,J)}#G($,J,Q){let z=J(Q);return typeof z==="function"?this.#G.bind(this,$,z):$?-z:z}#j($,J){let Q=this.#$;do{let z=J[Q];if(z===N["\r"])return this.#$=Q+2,$;$=$*10n+BigInt(z-N["0"])}while(++Q<J.length);return this.#$=Q,this.#j.bind(this,$)}#b($,J){if($===String)return this.#N(String,J);switch(J[this.#$]){case N.n:return this.#$+=5,NaN;case N["+"]:return this.#P(!1,J);case N["-"]:return this.#P(!0,J);default:return this.#v(!1,0,J)}}#P($,J){return++this.#$===J.length?this.#v.bind(this,$,0):this.#v($,0,J)}#v($,J,Q){if(Q[this.#$]===N.i)return this.#$+=5,$?-1/0:1/0;return this.#I($,J,Q)}#I($,J,Q){let z=this.#$;do{let q=Q[z];switch(q){case N["."]:return this.#$=z+1,this.#$<Q.length?this.#U($,0,J,Q):this.#U.bind(this,$,0,J);case N.E:case N.e:this.#$=z+1;let Z=$?-J:J;return this.#$<Q.length?this.#O(Z,Q):this.#O.bind(this,Z);case N["\r"]:return this.#$=z+2,$?-J:J;default:J=J*10+q-N["0"]}}while(++z<Q.length);return this.#$=z,this.#I.bind(this,$,J)}static#h=[0.1,0.01,0.001,0.0001,0.00001,0.000001,0.0000001,0.00000001,0.000000001,0.0000000001,0.00000000001,0.000000000001,0.0000000000001,0.00000000000001,0.000000000000001,0.0000000000000001,0.00000000000000001];#U($,J,Q,z){let q=this.#$;do{let Z=z[q];switch(Z){case N.E:case N.e:this.#$=q+1;let W=$?-Q:Q;return this.#$===z.length?this.#O.bind(this,W):this.#O(W,z);case N["\r"]:return this.#$=q+2,$?-Q:Q}if(J<l7.#h.length)Q+=(Z-N["0"])*l7.#h[J++]}while(++q<z.length);return this.#$=q,this.#U.bind(this,$,J,Q)}#O($,J){switch(J[this.#$]){case N["+"]:return++this.#$===J.length?this.#V.bind(this,!1,$,0):this.#V(!1,$,0,J);case N["-"]:return++this.#$===J.length?this.#V.bind(this,!0,$,0):this.#V(!0,$,0,J)}return this.#V(!1,$,0,J)}#V($,J,Q,z){let q=this.#$;do{let Z=z[q];if(Z===N["\r"])return this.#$=q+2,J*10**($?-Q:Q);Q=Q*10+Z-N["0"]}while(++q<z.length);return this.#$=q,this.#V.bind(this,$,J,Q)}#x($,J){while($[J]!==N["\r"])if(++J===$.length)return this.#$=$.length,-1;return this.#$=J+2,J}#N($,J){let Q=this.#$,z=this.#x(J,Q);if(z===-1)return this.#T.bind(this,[J.subarray(Q)],$);let q=J.subarray(Q,z);return $===Buffer?q:q.toString()}#T($,J,Q){let z=this.#$,q=this.#x(Q,z);if(q===-1)return $.push(Q.subarray(z)),this.#T.bind(this,$,J);$.push(Q.subarray(z,q));let Z=Buffer.concat($);return J===Buffer?Z:Z.toString()}#C($,J){if(J[this.#$]===N["-"])return this.#$+=4,null;let Q=this.#Y(0,J);if(typeof Q==="function")return this.#D.bind(this,Q,$);else if(this.#$>=J.length)return this.#A.bind(this,Q,$);return this.#A(Q,$,J)}#D($,J,Q){let z=$(Q);if(typeof z==="function")return this.#D.bind(this,z,J);else if(this.#$>=Q.length)return this.#A.bind(this,z,J);return this.#A(z,J,Q)}#f($,J,Q,z){let q=this.#$+$;if(q>=z.length){let W=z.subarray(this.#$);return this.#$=z.length,this.#g.bind(this,$-W.length,[W],J,Q)}let Z=z.subarray(this.#$,q);return this.#$=q+J,Q===Buffer?Z:Z.toString()}#g($,J,Q,z,q){let Z=this.#$+$;if(Z>=q.length){let V=q.subarray(this.#$);return J.push(V),this.#$=q.length,this.#g.bind(this,$-V.length,J,Q,z)}J.push(q.subarray(this.#$,Z)),this.#$=Z+Q;let W=Buffer.concat(J);return z===Buffer?W:W.toString()}#A($,J,Q){return this.#f($,2,J,Q)}#M($,J){return this.#l(this.#Y.bind(this,0),$,J)}#l($,J,Q){let z=$(Q);return typeof z==="function"?this.#l.bind(this,z,J):this.#W0(z,J,Q)}#W0($,J,Q){let z=$-4;if(J===v4.VerbatimString)return this.#V0(z,Q);return this.#$+=4,this.#$>=Q.length?this.#A.bind(this,z,J):this.#A(z,J,Q)}#V0($,J){let Q=this.#f.bind(this,3,1,String);return this.#$>=J.length?this.#u.bind(this,$,Q):this.#u($,Q,J)}#u($,J,Q){let z=J(Q);return typeof z==="function"?this.#u.bind(this,$,z):this.#Y0($,z,Q)}#Y0($,J,Q){return this.#m(J,this.#A.bind(this,$,String),Q)}#m($,J,Q){let z=J(Q);return typeof z==="function"?this.#m.bind(this,$,z):new v4.VerbatimString($,z)}#i($){let J=this.#N(String,$);return typeof J==="function"?this.#n.bind(this,J):new e6.SimpleError(J)}#n($,J){let Q=$(J);return typeof Q==="function"?this.#n.bind(this,Q):new e6.SimpleError(Q)}#t($){let J=this.#C(String,$);return typeof J==="function"?this.#a.bind(this,J):new e6.BlobError(J)}#a($,J){let Q=$(J);return typeof Q==="function"?this.#a.bind(this,Q):new e6.BlobError(Q)}#L($,J){let Q=J[this.#$];return++this.#$===J.length?this.#_.bind(this,Q,$):this.#_(Q,$,J)}#_($,J,Q){switch($){case G4.RESP_TYPES.NULL:return this.#q();case G4.RESP_TYPES.BOOLEAN:return this.#w(Q);case G4.RESP_TYPES.NUMBER:return this.#W(J[G4.RESP_TYPES.NUMBER],Q);case G4.RESP_TYPES.BIG_NUMBER:return this.#F(J[G4.RESP_TYPES.BIG_NUMBER],Q);case G4.RESP_TYPES.DOUBLE:return this.#b(J[G4.RESP_TYPES.DOUBLE],Q);case G4.RESP_TYPES.SIMPLE_STRING:return this.#N(J[G4.RESP_TYPES.SIMPLE_STRING],Q);case G4.RESP_TYPES.BLOB_STRING:return this.#C(J[G4.RESP_TYPES.BLOB_STRING],Q);case G4.RESP_TYPES.VERBATIM_STRING:return this.#M(J[G4.RESP_TYPES.VERBATIM_STRING],Q);case G4.RESP_TYPES.SIMPLE_ERROR:return this.#i(Q);case G4.RESP_TYPES.BLOB_ERROR:return this.#t(Q);case G4.RESP_TYPES.ARRAY:return this.#c(J,Q);case G4.RESP_TYPES.SET:return this.#s(J,Q);case G4.RESP_TYPES.MAP:return this.#J0(J,Q);default:throw Error(`Unknown RESP type ${$} "${String.fromCharCode($)}"`)}}#c($,J){if(J[this.#$]===N["-"])return this.#$+=4,null;return this.#o(this.#Y(0,J),$,J)}#o($,J,Q){return typeof $==="function"?this.#X0.bind(this,$,J):this.#S(Array($),0,J,Q)}#X0($,J,Q){return this.#o($(Q),J,Q)}#S($,J,Q,z){for(let q=J;q<$.length;q++){if(this.#$>=z.length)return this.#S.bind(this,$,q,Q);let Z=this.#L(Q,z);if(typeof Z==="function")return this.#p.bind(this,$,q,Z,Q);$[q]=Z}return $}#p($,J,Q,z,q){let Z=Q(q);if(typeof Z==="function")return this.#p.bind(this,$,J,Z,z);return $[J++]=Z,this.#S($,J,z,q)}#s($,J){let Q=this.#Y(0,J);if(typeof Q==="function")return this.#r.bind(this,Q,$);return this.#e(Q,$,J)}#r($,J,Q){let z=$(Q);return typeof z==="function"?this.#r.bind(this,z,J):this.#e(z,J,Q)}#e($,J,Q){return J[G4.RESP_TYPES.SET]===Set?this.#d(new Set,$,J,Q):this.#S(Array($),0,J,Q)}#d($,J,Q,z){while(J>0){if(this.#$>=z.length)return this.#d.bind(this,$,J,Q);let q=this.#L(Q,z);if(typeof q==="function")return this.#$0.bind(this,$,J,q,Q);$.add(q),--J}return $}#$0($,J,Q,z,q){let Z=Q(q);if(typeof Z==="function")return this.#$0.bind(this,$,J,Z,z);return $.add(Z),this.#d($,J-1,z,q)}#J0($,J){let Q=this.#Y(0,J);if(typeof Q==="function")return this.#Q0.bind(this,Q,$);return this.#z0(Q,$,J)}#Q0($,J,Q){let z=$(Q);return typeof z==="function"?this.#Q0.bind(this,z,J):this.#z0(z,J,Q)}#z0($,J,Q){switch(J[G4.RESP_TYPES.MAP]){case Map:return this.#R(new Map,$,J,Q);case Array:return this.#S(Array($*2),0,J,Q);default:return this.#y(Object.create(null),$,J,Q)}}#R($,J,Q,z){while(J>0){if(this.#$>=z.length)return this.#R.bind(this,$,J,Q);let q=this.#q0(Q,z);if(typeof q==="function")return this.#Z0.bind(this,$,J,q,Q);if(this.#$>=z.length)return this.#E.bind(this,$,J,q,this.#L.bind(this,Q),Q);let Z=this.#L(Q,z);if(typeof Z==="function")return this.#E.bind(this,$,J,q,Z,Q);$.set(q,Z),--J}return $}#q0($,J){let Q=J[this.#$];return++this.#$===J.length?this.#w0.bind(this,Q,$):this.#w0(Q,$,J)}#w0($,J,Q){switch($){case G4.RESP_TYPES.SIMPLE_STRING:return this.#N(String,Q);case G4.RESP_TYPES.BLOB_STRING:return this.#C(String,Q);default:return this.#_($,J,Q)}}#Z0($,J,Q,z,q){let Z=Q(q);if(typeof Z==="function")return this.#Z0.bind(this,$,J,Z,z);if(this.#$>=q.length)return this.#E.bind(this,$,J,Z,this.#L.bind(this,z),z);let W=this.#L(z,q);if(typeof W==="function")return this.#E.bind(this,$,J,Z,W,z);return $.set(Z,W),this.#R($,J-1,z,q)}#E($,J,Q,z,q,Z){let W=z(Z);if(typeof W==="function")return this.#E.bind(this,$,J,Q,W,q);return $.set(Q,W),this.#R($,J-1,q,Z)}#y($,J,Q,z){while(J>0){if(this.#$>=z.length)return this.#y.bind(this,$,J,Q);let q=this.#q0(Q,z);if(typeof q==="function")return this.#K0.bind(this,$,J,q,Q);if(this.#$>=z.length)return this.#k.bind(this,$,J,q,this.#L.bind(this,Q),Q);let Z=this.#L(Q,z);if(typeof Z==="function")return this.#k.bind(this,$,J,q,Z,Q);$[q]=Z,--J}return $}#K0($,J,Q,z,q){let Z=Q(q);if(typeof Z==="function")return this.#K0.bind(this,$,J,Z,z);if(this.#$>=q.length)return this.#k.bind(this,$,J,Z,this.#L.bind(this,z),z);let W=this.#L(z,q);if(typeof W==="function")return this.#k.bind(this,$,J,Z,W,z);return $[Z]=W,this.#y($,J-1,z,q)}#k($,J,Q,z,q,Z){let W=z(Z);if(typeof W==="function")return this.#k.bind(this,$,J,Q,W,q);return $[Q]=W,this.#y($,J-1,q,Z)}}G4.Decoder=m7;l7=m7});var I4=w((h4)=>{Object.defineProperty(h4,"__esModule",{value:!0});h4.scriptSha1=h4.defineScript=void 0;var W2=C("node:crypto");function V2($){return{...$,SHA1:U4($.SCRIPT)}}h4.defineScript=V2;function U4($){return(0,W2.createHash)("sha1").update($).digest("hex")}h4.scriptSha1=U4});var D4=w((O4)=>{Object.defineProperty(O4,"__esModule",{value:!0});O4.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("ACL","CAT"),J)$.push(J)},transformReply:void 0}});var x4=w((A4)=>{Object.defineProperty(A4,"__esModule",{value:!0});A4.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("ACL","DELUSER"),$.pushVariadic(J)},transformReply:void 0}});var T4=w((C4)=>{Object.defineProperty(C4,"__esModule",{value:!0});C4.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("ACL","DRYRUN",J,...Q)},transformReply:void 0}});var f4=w((L4)=>{Object.defineProperty(L4,"__esModule",{value:!0});L4.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("ACL","GENPASS"),J)$.push(J.toString())},transformReply:void 0}});var S4=w((M4)=>{Object.defineProperty(M4,"__esModule",{value:!0});M4.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("ACL","GETUSER",J)},transformReply:{2:($)=>({flags:$[1],passwords:$[3],commands:$[5],keys:$[7],channels:$[9],selectors:$[11]?.map((J)=>{let Q=J;return{commands:Q[1],keys:Q[3],channels:Q[5]}})}),3:void 0}}});var k4=w((E4)=>{Object.defineProperty(E4,"__esModule",{value:!0});E4.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("ACL","LIST")},transformReply:void 0}});var R4=w((g4)=>{Object.defineProperty(g4,"__esModule",{value:!0});g4.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("ACL","LOAD")},transformReply:void 0}});var d=w((u4)=>{Object.defineProperty(u4,"__esModule",{value:!0});u4.BasicCommandParser=void 0;class y4{#$=[];#J=[];preserve;get redisArgs(){return this.#$}get keys(){return this.#J}get firstKey(){return this.#J[0]}get cacheKey(){let $=Array(this.#$.length*2);for(let J=0;J<this.#$.length;J++)$[J]=this.#$[J].length,$[J+this.#$.length]=this.#$[J];return $.join("_")}push(...$){this.#$.push(...$)}pushVariadic($){if(Array.isArray($))for(let J of $)this.push(J);else this.push($)}pushVariadicWithLength($){if(Array.isArray($))this.#$.push($.length.toString());else this.#$.push("1");this.pushVariadic($)}pushVariadicNumber($){if(Array.isArray($))for(let J of $)this.push(J.toString());else this.push($.toString())}pushKey($){this.#J.push($),this.#$.push($)}pushKeysLength($){if(Array.isArray($))this.#$.push($.length.toString());else this.#$.push("1");this.pushKeys($)}pushKeys($){if(Array.isArray($))this.#J.push(...$),this.#$.push(...$);else this.#J.push($),this.#$.push($)}}u4.BasicCommandParser=y4});var X=w((a4)=>{Object.defineProperty(a4,"__esModule",{value:!0});a4.transformRedisJsonNullReply=a4.transformRedisJsonReply=a4.transformRedisJsonArgument=a4.transformStreamsMessagesReplyResp3=a4.transformStreamsMessagesReplyResp2=a4.transformStreamMessagesReply=a4.transformStreamMessageNullReply=a4.transformStreamMessageReply=a4.parseArgs=a4.parseZKeysArguments=a4.transformRangeReply=a4.parseSlotRangesArguments=a4.transformFunctionListItemReply=a4.RedisFunctionFlags=a4.transformCommandReply=a4.CommandCategories=a4.CommandFlags=a4.parseOptionalVariadicArgument=a4.pushVariadicArgument=a4.pushVariadicNumberArguments=a4.pushVariadicArguments=a4.pushEvalArguments=a4.evalFirstKeyIndex=a4.transformPXAT=a4.transformEXAT=a4.transformSortedSetReply=a4.transformTuplesReply=a4.createTransformTuplesReplyFunc=a4.transformTuplesToMap=a4.transformNullableDoubleReply=a4.createTransformNullableDoubleReplyResp2Func=a4.transformDoubleArrayReply=a4.createTransformDoubleReplyResp2Func=a4.transformDoubleReply=a4.transformStringDoubleArgument=a4.transformDoubleArgument=a4.transformBooleanArrayReply=a4.transformBooleanReply=a4.isArrayReply=a4.isNullReply=void 0;var P2=d(),i7=$7();function n7($){return $===null}a4.isNullReply=n7;function b2($){return Array.isArray($)}a4.isArrayReply=b2;a4.transformBooleanReply={2:($)=>$===1,3:void 0};a4.transformBooleanArrayReply={2:($)=>{return $.map(a4.transformBooleanReply[2])},3:void 0};function J7($){switch($){case 1/0:return"+inf";case-1/0:return"-inf";default:return $.toString()}}a4.transformDoubleArgument=J7;function U2($){if(typeof $!=="number")return $;return J7($)}a4.transformStringDoubleArgument=U2;a4.transformDoubleReply={2:($,J,Q)=>{switch(Q?Q[i7.RESP_TYPES.DOUBLE]:void 0){case String:return $;default:{let q;switch($.toString()){case"inf":case"+inf":q=1/0;case"-inf":q=-1/0;case"nan":q=NaN;default:q=Number($)}return q}}},3:void 0};function i4($,J){return(Q)=>{return a4.transformDoubleReply[2](Q,$,J)}}a4.createTransformDoubleReplyResp2Func=i4;a4.transformDoubleArrayReply={2:($,J,Q)=>{return $.map(i4(J,Q))},3:void 0};function h2($,J){return(Q)=>{return a4.transformNullableDoubleReply[2](Q,$,J)}}a4.createTransformNullableDoubleReplyResp2Func=h2;a4.transformNullableDoubleReply={2:($,J,Q)=>{if($===null)return null;return a4.transformDoubleReply[2]($,J,Q)},3:void 0};function N2($,J){let Q=Object.create(null);for(let z=0;z<$.length;z+=2)Q[$[z].toString()]=J($[z+1]);return Q}a4.transformTuplesToMap=N2;function I2($,J){return(Q)=>{return t7(Q,$,J)}}a4.createTransformTuplesReplyFunc=I2;function t7($,J,Q){let z=Q?Q[i7.RESP_TYPES.MAP]:void 0,q=$;switch(z){case Array:return $;case Map:{let Z=new Map;for(let W=0;W<q.length;W+=2)Z.set(q[W].toString(),q[W+1]);return Z}default:{let Z=Object.create(null);for(let W=0;W<q.length;W+=2)Z[q[W].toString()]=q[W+1];return Z}}}a4.transformTuplesReply=t7;a4.transformSortedSetReply={2:($,J,Q)=>{let z=$,q=[];for(let Z=0;Z<z.length;Z+=2)q.push({value:z[Z],score:a4.transformDoubleReply[2](z[Z+1],J,Q)});return q},3:($)=>{return $.map((J)=>{let[Q,z]=J;return{value:Q,score:z}})}};function O2($){return(typeof $==="number"?$:Math.floor($.getTime()/1000)).toString()}a4.transformEXAT=O2;function D2($){return(typeof $==="number"?$:$.getTime()).toString()}a4.transformPXAT=D2;function A2($){return $?.keys?.[0]}a4.evalFirstKeyIndex=A2;function x2($,J){if(J?.keys)$.push(J.keys.length.toString(),...J.keys);else $.push("0");if(J?.arguments)$.push(...J.arguments);return $}a4.pushEvalArguments=x2;function C2($,J){if(Array.isArray(J))$=$.concat(J);else $.push(J);return $}a4.pushVariadicArguments=C2;function T2($,J){if(Array.isArray(J))for(let Q of J)$.push(Q.toString());else $.push(J.toString());return $}a4.pushVariadicNumberArguments=T2;function L2($,J){if(Array.isArray(J))$.push(J.length.toString(),...J);else $.push("1",J);return $}a4.pushVariadicArgument=L2;function f2($,J,Q){if(Q===void 0)return;$.push(J),$.pushVariadicWithLength(Q)}a4.parseOptionalVariadicArgument=f2;var c4;(function($){$.WRITE="write",$.READONLY="readonly",$.DENYOOM="denyoom",$.ADMIN="admin",$.PUBSUB="pubsub",$.NOSCRIPT="noscript",$.RANDOM="random",$.SORT_FOR_SCRIPT="sort_for_script",$.LOADING="loading",$.STALE="stale",$.SKIP_MONITOR="skip_monitor",$.ASKING="asking",$.FAST="fast",$.MOVABLEKEYS="movablekeys"})(c4||(a4.CommandFlags=c4={}));var d4;(function($){$.KEYSPACE="@keyspace",$.READ="@read",$.WRITE="@write",$.SET="@set",$.SORTEDSET="@sortedset",$.LIST="@list",$.HASH="@hash",$.STRING="@string",$.BITMAP="@bitmap",$.HYPERLOGLOG="@hyperloglog",$.GEO="@geo",$.STREAM="@stream",$.PUBSUB="@pubsub",$.ADMIN="@admin",$.FAST="@fast",$.SLOW="@slow",$.BLOCKING="@blocking",$.DANGEROUS="@dangerous",$.CONNECTION="@connection",$.TRANSACTION="@transaction",$.SCRIPTING="@scripting"})(d4||(a4.CommandCategories=d4={}));function M2([$,J,Q,z,q,Z,W]){return{name:$,arity:J,flags:new Set(Q),firstKeyIndex:z,lastKeyIndex:q,step:Z,categories:new Set(W)}}a4.transformCommandReply=M2;var l4;(function($){$.NO_WRITES="no-writes",$.ALLOW_OOM="allow-oom",$.ALLOW_STALE="allow-stale",$.NO_CLUSTER="no-cluster"})(l4||(a4.RedisFunctionFlags=l4={}));function S2($){return{libraryName:$[1],engine:$[3],functions:$[5].map((J)=>({name:J[1],description:J[3],flags:J[5]}))}}a4.transformFunctionListItemReply=S2;function m4($,J){$.push(J.start.toString(),J.end.toString())}function E2($,J){if(Array.isArray(J))for(let Q of J)m4($,Q);else m4($,J)}a4.parseSlotRangesArguments=E2;function k2([$,J]){return{start:$,end:J}}a4.transformRangeReply=k2;function g2($,J){if(Array.isArray(J)){if($.push(J.length.toString()),J.length)if(R2(J))$.pushKeys(J);else{for(let Q=0;Q<J.length;Q++)$.pushKey(J[Q].key);$.push("WEIGHTS");for(let Q=0;Q<J.length;Q++)$.push(J7(J[Q].weight))}}else if($.push("1"),n4(J))$.pushKey(J);else $.pushKey(J.key),$.push("WEIGHTS",J7(J.weight))}a4.parseZKeysArguments=g2;function n4($){return typeof $==="string"||$ instanceof Buffer}function R2($){return n4($[0])}function y2($,...J){let Q=new P2.BasicCommandParser;$.parseCommand(Q,...J);let z=Q.redisArgs;if(Q.preserve)z.preserve=Q.preserve;return z}a4.parseArgs=y2;function a7($,J){let[Q,z]=J;return{id:Q,message:t7(z,void 0,$)}}a4.transformStreamMessageReply=a7;function u2($,J){return n7(J)?J:a7($,J)}a4.transformStreamMessageNullReply=u2;function A$($,J){return $.map(a7.bind(void 0,J))}a4.transformStreamMessagesReply=A$;function _2($,J,Q){if($===null)return null;switch(Q?Q[i7.RESP_TYPES.MAP]:void 0){default:{let z=[];for(let q=0;q<$.length;q++){let Z=$[q];z.push({name:Z[0],messages:A$(Z[1])})}return z}}}a4.transformStreamsMessagesReplyResp2=_2;function c2($){if($===null)return null;if($ instanceof Map){let J=new Map;for(let[Q,z]of $){let q=Q;J.set(q.toString(),A$(z))}return J}else if($ instanceof Array){let J=[];for(let Q=0;Q<$.length;Q+=2){let z=$[Q],q=$[Q+1];J.push(z),J.push(A$(q))}return J}else{let J=Object.create(null);for(let[Q,z]of Object.entries($))J[Q]=A$(z);return J}}a4.transformStreamsMessagesReplyResp3=c2;function d2($){return JSON.stringify($)}a4.transformRedisJsonArgument=d2;function t4($){return JSON.parse($.toString())}a4.transformRedisJsonReply=t4;function l2($){return n7($)?$:t4($)}a4.transformRedisJsonNullReply=l2});var o7=w((r4)=>{Object.defineProperty(r4,"__esModule",{value:!0});var AC=X();r4.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("ACL","LOG"),J!=null)$.push(J.toString())},transformReply:{2:($,J,Q)=>{return $.map((z)=>{let q=z;return{count:q[1],reason:q[3],context:q[5],object:q[7],username:q[9],"age-seconds":AC.transformDoubleReply[2](q[11],J,Q),"client-info":q[13],"entry-id":q[15],"timestamp-created":q[17],"timestamp-last-updated":q[19]}})},3:void 0}}});var e4=w((x$)=>{var CC=x$&&x$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(x$,"__esModule",{value:!0});var TC=CC(o7());x$.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:TC.default.IS_READ_ONLY,parseCommand($){$.push("ACL","LOG","RESET")},transformReply:void 0}});var J1=w(($1)=>{Object.defineProperty($1,"__esModule",{value:!0});$1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("ACL","SAVE")},transformReply:void 0}});var z1=w((Q1)=>{Object.defineProperty(Q1,"__esModule",{value:!0});Q1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("ACL","SETUSER",J),$.pushVariadic(Q)},transformReply:void 0}});var w1=w((q1)=>{Object.defineProperty(q1,"__esModule",{value:!0});q1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("ACL","USERS")},transformReply:void 0}});var K1=w((Z1)=>{Object.defineProperty(Z1,"__esModule",{value:!0});Z1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("ACL","WHOAMI")},transformReply:void 0}});var V1=w((W1)=>{Object.defineProperty(W1,"__esModule",{value:!0});W1.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("APPEND",J,Q)},transformReply:void 0}});var s7=w((Y1)=>{Object.defineProperty(Y1,"__esModule",{value:!0});Y1.ASKING_CMD=void 0;Y1.ASKING_CMD="ASKING";Y1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push(Y1.ASKING_CMD)},transformReply:void 0}});var F1=w((X1)=>{Object.defineProperty(X1,"__esModule",{value:!0});X1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,{username:J,password:Q}){if($.push("AUTH"),J!==void 0)$.push(J);$.push(Q)},transformReply:void 0}});var B1=w((H1)=>{Object.defineProperty(H1,"__esModule",{value:!0});H1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("BGREWRITEAOF")},transformReply:void 0}});var v1=w((j1)=>{Object.defineProperty(j1,"__esModule",{value:!0});j1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("BGSAVE"),J?.SCHEDULE)$.push("SCHEDULE")},transformReply:void 0}});var P1=w((G1)=>{Object.defineProperty(G1,"__esModule",{value:!0});G1.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("BITCOUNT"),$.pushKey(J),Q){if($.push(Q.start.toString()),$.push(Q.end.toString()),Q.mode)$.push(Q.mode)}},transformReply:void 0}});var U1=w((b1)=>{Object.defineProperty(b1,"__esModule",{value:!0});b1.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("BITFIELD_RO"),$.pushKey(J);for(let z of Q)$.push("GET"),$.push(z.encoding),$.push(z.offset.toString())},transformReply:void 0}});var N1=w((h1)=>{Object.defineProperty(h1,"__esModule",{value:!0});h1.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("BITFIELD"),$.pushKey(J);for(let z of Q)switch(z.operation){case"GET":$.push("GET",z.encoding,z.offset.toString());break;case"SET":$.push("SET",z.encoding,z.offset.toString(),z.value.toString());break;case"INCRBY":$.push("INCRBY",z.encoding,z.offset.toString(),z.increment.toString());break;case"OVERFLOW":$.push("OVERFLOW",z.behavior);break}},transformReply:void 0}});var O1=w((I1)=>{Object.defineProperty(I1,"__esModule",{value:!0});I1.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("BITOP",J),$.pushKey(Q),$.pushKeys(z)},transformReply:void 0}});var A1=w((D1)=>{Object.defineProperty(D1,"__esModule",{value:!0});D1.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z,q,Z){if($.push("BITPOS"),$.pushKey(J),$.push(Q.toString()),z!==void 0)$.push(z.toString());if(q!==void 0)$.push(q.toString());if(Z)$.push(Z)},transformReply:void 0}});var C1=w((x1)=>{Object.defineProperty(x1,"__esModule",{value:!0});x1.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,Z){$.push("BLMOVE"),$.pushKeys([J,Q]),$.push(z,q,Z.toString())},transformReply:void 0}});var r7=w((L1)=>{Object.defineProperty(L1,"__esModule",{value:!0});L1.parseLMPopArguments=void 0;function T1($,J,Q,z){if($.pushKeysLength(J),$.push(Q),z?.COUNT!==void 0)$.push("COUNT",z.COUNT.toString())}L1.parseLMPopArguments=T1;L1.default={IS_READ_ONLY:!1,parseCommand($,...J){$.push("LMPOP"),T1($,...J)},transformReply:void 0}});var S1=w((J0)=>{var nC=J0&&J0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),tC=J0&&J0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),aC=J0&&J0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))nC(J,$,Q)}return tC(J,$),J};Object.defineProperty(J0,"__esModule",{value:!0});var M1=aC(r7());J0.default={IS_READ_ONLY:!1,parseCommand($,J,...Q){$.push("BLMPOP",J.toString()),(0,M1.parseLMPopArguments)($,...Q)},transformReply:M1.default.transformReply}});var e7=w((E1)=>{Object.defineProperty(E1,"__esModule",{value:!0});E1.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("BLPOP"),$.pushKeys(J),$.push(Q.toString())},transformReply($){if($===null)return null;return{key:$[0],element:$[1]}}}});var k1=w((C$)=>{var pC=C$&&C$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(C$,"__esModule",{value:!0});var sC=pC(e7());C$.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("BRPOP"),$.pushKeys(J),$.push(Q.toString())},transformReply:sC.default.transformReply}});var R1=w((g1)=>{Object.defineProperty(g1,"__esModule",{value:!0});g1.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("BRPOPLPUSH"),$.pushKeys([J,Q]),$.push(z.toString())},transformReply:void 0}});var $5=w((_1)=>{Object.defineProperty(_1,"__esModule",{value:!0});_1.parseZMPopArguments=void 0;var y1=X();function u1($,J,Q,z){if($.pushKeysLength(J),$.push(Q),z?.COUNT)$.push("COUNT",z.COUNT.toString())}_1.parseZMPopArguments=u1;_1.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("ZMPOP"),u1($,J,Q,z)},transformReply:{2($,J,Q){return $===null?null:{key:$[0],members:$[1].map((z)=>{let[q,Z]=z;return{value:q,score:y1.transformDoubleReply[2](Z,J,Q)}})}},3($){return $===null?null:{key:$[0],members:y1.transformSortedSetReply[3]($[1])}}}}});var l1=w((Q0)=>{var $T=Q0&&Q0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),JT=Q0&&Q0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),QT=Q0&&Q0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))$T(J,$,Q)}return JT(J,$),J};Object.defineProperty(Q0,"__esModule",{value:!0});var d1=QT($5());Q0.default={IS_READ_ONLY:!1,parseCommand($,J,...Q){$.push("BZMPOP",J.toString()),(0,d1.parseZMPopArguments)($,...Q)},transformReply:d1.default.transformReply}});var J5=w((m1)=>{Object.defineProperty(m1,"__esModule",{value:!0});var zT=X();m1.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("BZPOPMAX"),$.pushKeys(J),$.push(Q.toString())},transformReply:{2($,J,Q){return $===null?null:{key:$[0],value:$[1],score:zT.transformDoubleReply[2]($[2],J,Q)}},3($){return $===null?null:{key:$[0],value:$[1],score:$[2]}}}}});var n1=w((T$)=>{var wT=T$&&T$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(T$,"__esModule",{value:!0});var i1=wT(J5());T$.default={IS_READ_ONLY:i1.default.IS_READ_ONLY,parseCommand($,J,Q){$.push("BZPOPMIN"),$.pushKeys(J),$.push(Q.toString())},transformReply:i1.default.transformReply}});var a1=w((t1)=>{Object.defineProperty(t1,"__esModule",{value:!0});t1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLIENT","CACHING",J?"YES":"NO")},transformReply:void 0}});var p1=w((o1)=>{Object.defineProperty(o1,"__esModule",{value:!0});o1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLIENT","GETNAME")},transformReply:void 0}});var r1=w((s1)=>{Object.defineProperty(s1,"__esModule",{value:!0});s1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLIENT","GETREDIR")},transformReply:void 0}});var $9=w((e1)=>{Object.defineProperty(e1,"__esModule",{value:!0});e1.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLIENT","ID")},transformReply:void 0}});var Q5=w((J9)=>{Object.defineProperty(J9,"__esModule",{value:!0});var YT=/([^\s=]+)=([^\s]*)/g;J9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLIENT","INFO")},transformReply($){let J={};for(let z of $.toString().matchAll(YT))J[z[1]]=z[2];let Q={id:Number(J.id),addr:J.addr,fd:Number(J.fd),name:J.name,age:Number(J.age),idle:Number(J.idle),flags:J.flags,db:Number(J.db),sub:Number(J.sub),psub:Number(J.psub),multi:Number(J.multi),qbuf:Number(J.qbuf),qbufFree:Number(J["qbuf-free"]),argvMem:Number(J["argv-mem"]),obl:Number(J.obl),oll:Number(J.oll),omem:Number(J.omem),totMem:Number(J["tot-mem"]),events:J.events,cmd:J.cmd,user:J.user,libName:J["lib-name"],libVer:J["lib-ver"]};if(J.laddr!==void 0)Q.laddr=J.laddr;if(J.redir!==void 0)Q.redir=Number(J.redir);if(J.ssub!==void 0)Q.ssub=Number(J.ssub);if(J["multi-mem"]!==void 0)Q.multiMem=Number(J["multi-mem"]);if(J.resp!==void 0)Q.resp=Number(J.resp);return Q}}});var q9=w((z9)=>{Object.defineProperty(z9,"__esModule",{value:!0});z9.CLIENT_KILL_FILTERS=void 0;z9.CLIENT_KILL_FILTERS={ADDRESS:"ADDR",LOCAL_ADDRESS:"LADDR",ID:"ID",TYPE:"TYPE",USER:"USER",SKIP_ME:"SKIPME",MAXAGE:"MAXAGE"};z9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("CLIENT","KILL"),Array.isArray(J))for(let Q of J)Q9($,Q);else Q9($,J)},transformReply:void 0};function Q9($,J){if(J===z9.CLIENT_KILL_FILTERS.SKIP_ME){$.push("SKIPME");return}switch($.push(J.filter),J.filter){case z9.CLIENT_KILL_FILTERS.ADDRESS:$.push(J.address);break;case z9.CLIENT_KILL_FILTERS.LOCAL_ADDRESS:$.push(J.localAddress);break;case z9.CLIENT_KILL_FILTERS.ID:$.push(typeof J.id==="number"?J.id.toString():J.id);break;case z9.CLIENT_KILL_FILTERS.TYPE:$.push(J.type);break;case z9.CLIENT_KILL_FILTERS.USER:$.push(J.username);break;case z9.CLIENT_KILL_FILTERS.SKIP_ME:$.push(J.skipMe?"yes":"no");break;case z9.CLIENT_KILL_FILTERS.MAXAGE:$.push(J.maxAge.toString());break}}});var w9=w((L$)=>{var HT=L$&&L$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(L$,"__esModule",{value:!0});var BT=HT(Q5());L$.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("CLIENT","LIST"),J)if(J.TYPE!==void 0)$.push("TYPE",J.TYPE);else $.push("ID"),$.pushVariadic(J.ID)},transformReply($){let J=$.toString().split(`
`),Q=J.length-1,z=[];for(let q=0;q<Q;q++)z.push(BT.default.transformReply(J[q]));return z}}});var K9=w((Z9)=>{Object.defineProperty(Z9,"__esModule",{value:!0});Z9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLIENT","NO-EVICT",J?"ON":"OFF")},transformReply:void 0}});var V9=w((W9)=>{Object.defineProperty(W9,"__esModule",{value:!0});W9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLIENT","NO-TOUCH",J?"ON":"OFF")},transformReply:void 0}});var X9=w((Y9)=>{Object.defineProperty(Y9,"__esModule",{value:!0});Y9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("CLIENT","PAUSE",J.toString()),Q)$.push(Q)},transformReply:void 0}});var H9=w((F9)=>{Object.defineProperty(F9,"__esModule",{value:!0});F9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLIENT","SETNAME",J)},transformReply:void 0}});var j9=w((B9)=>{Object.defineProperty(B9,"__esModule",{value:!0});B9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("CLIENT","TRACKING",J?"ON":"OFF"),J){if(Q?.REDIRECT)$.push("REDIRECT",Q.REDIRECT.toString());if(bT(Q)){if($.push("BCAST"),Q?.PREFIX)if(Array.isArray(Q.PREFIX))for(let z of Q.PREFIX)$.push("PREFIX",z);else $.push("PREFIX",Q.PREFIX)}else if(UT(Q))$.push("OPTIN");else if(hT(Q))$.push("OPTOUT");if(Q?.NOLOOP)$.push("NOLOOP")}},transformReply:void 0};function bT($){return $?.BCAST===!0}function UT($){return $?.OPTIN===!0}function hT($){return $?.OPTOUT===!0}});var G9=w((v9)=>{Object.defineProperty(v9,"__esModule",{value:!0});v9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLIENT","TRACKINGINFO")},transformReply:{2:($)=>({flags:$[1],redirect:$[3],prefixes:$[5]}),3:void 0}}});var b9=w((P9)=>{Object.defineProperty(P9,"__esModule",{value:!0});P9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLIENT","UNPAUSE")},transformReply:void 0}});var h9=w((U9)=>{Object.defineProperty(U9,"__esModule",{value:!0});U9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","ADDSLOTS"),$.pushVariadicNumber(J)},transformReply:void 0}});var I9=w((N9)=>{Object.defineProperty(N9,"__esModule",{value:!0});var AT=X();N9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","ADDSLOTSRANGE"),(0,AT.parseSlotRangesArguments)($,J)},transformReply:void 0}});var D9=w((O9)=>{Object.defineProperty(O9,"__esModule",{value:!0});O9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","BUMPEPOCH")},transformReply:void 0}});var x9=w((A9)=>{Object.defineProperty(A9,"__esModule",{value:!0});A9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","COUNT-FAILURE-REPORTS",J)},transformReply:void 0}});var T9=w((C9)=>{Object.defineProperty(C9,"__esModule",{value:!0});C9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","COUNTKEYSINSLOT",J.toString())},transformReply:void 0}});var f9=w((L9)=>{Object.defineProperty(L9,"__esModule",{value:!0});L9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","DELSLOTS"),$.pushVariadicNumber(J)},transformReply:void 0}});var S9=w((M9)=>{Object.defineProperty(M9,"__esModule",{value:!0});var MT=X();M9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","DELSLOTSRANGE"),(0,MT.parseSlotRangesArguments)($,J)},transformReply:void 0}});var g9=w((E9)=>{Object.defineProperty(E9,"__esModule",{value:!0});E9.FAILOVER_MODES=void 0;E9.FAILOVER_MODES={FORCE:"FORCE",TAKEOVER:"TAKEOVER"};E9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("CLUSTER","FAILOVER"),J?.mode)$.push(J.mode)},transformReply:void 0}});var y9=w((R9)=>{Object.defineProperty(R9,"__esModule",{value:!0});R9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","FLUSHSLOTS")},transformReply:void 0}});var _9=w((u9)=>{Object.defineProperty(u9,"__esModule",{value:!0});u9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","FORGET",J)},transformReply:void 0}});var d9=w((c9)=>{Object.defineProperty(c9,"__esModule",{value:!0});c9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("CLUSTER","GETKEYSINSLOT",J.toString(),Q.toString())},transformReply:void 0}});var m9=w((l9)=>{Object.defineProperty(l9,"__esModule",{value:!0});l9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","INFO")},transformReply:void 0}});var n9=w((i9)=>{Object.defineProperty(i9,"__esModule",{value:!0});i9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","KEYSLOT",J)},transformReply:void 0}});var a9=w((t9)=>{Object.defineProperty(t9,"__esModule",{value:!0});t9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","LINKS")},transformReply:{2:($)=>$.map((J)=>{let Q=J;return{direction:Q[1],node:Q[3],"create-time":Q[5],events:Q[7],"send-buffer-allocated":Q[9],"send-buffer-used":Q[11]}}),3:void 0}}});var p9=w((o9)=>{Object.defineProperty(o9,"__esModule",{value:!0});o9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("CLUSTER","MEET",J,Q.toString())},transformReply:void 0}});var r9=w((s9)=>{Object.defineProperty(s9,"__esModule",{value:!0});s9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","MYID")},transformReply:void 0}});var $J=w((e9)=>{Object.defineProperty(e9,"__esModule",{value:!0});e9.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","MYSHARDID")},transformReply:void 0}});var QJ=w((JJ)=>{Object.defineProperty(JJ,"__esModule",{value:!0});JJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","NODES")},transformReply:void 0}});var qJ=w((zJ)=>{Object.defineProperty(zJ,"__esModule",{value:!0});zJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","REPLICAS",J)},transformReply:void 0}});var ZJ=w((wJ)=>{Object.defineProperty(wJ,"__esModule",{value:!0});wJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","REPLICATE",J)},transformReply:void 0}});var WJ=w((KJ)=>{Object.defineProperty(KJ,"__esModule",{value:!0});KJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("CLUSTER","RESET"),J?.mode)$.push(J.mode)},transformReply:void 0}});var YJ=w((VJ)=>{Object.defineProperty(VJ,"__esModule",{value:!0});VJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","SAVECONFIG")},transformReply:void 0}});var FJ=w((XJ)=>{Object.defineProperty(XJ,"__esModule",{value:!0});XJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CLUSTER","SET-CONFIG-EPOCH",J.toString())},transformReply:void 0}});var jJ=w((HJ)=>{Object.defineProperty(HJ,"__esModule",{value:!0});HJ.CLUSTER_SLOT_STATES=void 0;HJ.CLUSTER_SLOT_STATES={IMPORTING:"IMPORTING",MIGRATING:"MIGRATING",STABLE:"STABLE",NODE:"NODE"};HJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("CLUSTER","SETSLOT",J.toString(),Q),z)$.push(z)},transformReply:void 0}});var PJ=w((GJ)=>{Object.defineProperty(GJ,"__esModule",{value:!0});GJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CLUSTER","SLOTS")},transformReply($){return $.map(([J,Q,z,...q])=>({from:J,to:Q,master:vJ(z),replicas:q.map(vJ)}))}};function vJ($){let[J,Q,z]=$;return{host:J,port:Q,id:z}}});var UJ=w((bJ)=>{Object.defineProperty(bJ,"__esModule",{value:!0});bJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("COMMAND","COUNT")},transformReply:void 0}});var NJ=w((hJ)=>{Object.defineProperty(hJ,"__esModule",{value:!0});hJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("COMMAND","GETKEYS"),$.push(...J)},transformReply:void 0}});var OJ=w((IJ)=>{Object.defineProperty(IJ,"__esModule",{value:!0});IJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("COMMAND","GETKEYSANDFLAGS"),$.push(...J)},transformReply($){return $.map((J)=>{let[Q,z]=J;return{key:Q,flags:z}})}}});var AJ=w((DJ)=>{Object.defineProperty(DJ,"__esModule",{value:!0});var JL=X();DJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("COMMAND","INFO",...J)},transformReply($){return $.map((J)=>J?(0,JL.transformCommandReply)(J):null)}}});var TJ=w((xJ)=>{Object.defineProperty(xJ,"__esModule",{value:!0});xJ.COMMAND_LIST_FILTER_BY=void 0;xJ.COMMAND_LIST_FILTER_BY={MODULE:"MODULE",ACLCAT:"ACLCAT",PATTERN:"PATTERN"};xJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("COMMAND","LIST"),J?.FILTERBY)$.push("FILTERBY",J.FILTERBY.type,J.FILTERBY.value)},transformReply:void 0}});var fJ=w((LJ)=>{Object.defineProperty(LJ,"__esModule",{value:!0});var qL=X();LJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("COMMAND")},transformReply($){return $.map(qL.transformCommandReply)}}});var SJ=w((MJ)=>{Object.defineProperty(MJ,"__esModule",{value:!0});var ZL=X();MJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("CONFIG","GET"),$.pushVariadic(J)},transformReply:{2:ZL.transformTuplesReply,3:void 0}}});var kJ=w((EJ)=>{Object.defineProperty(EJ,"__esModule",{value:!0});EJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CONFIG","RESETSTAT")},transformReply:void 0}});var RJ=w((gJ)=>{Object.defineProperty(gJ,"__esModule",{value:!0});gJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("CONFIG","REWRITE")},transformReply:void 0}});var uJ=w((yJ)=>{Object.defineProperty(yJ,"__esModule",{value:!0});yJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,...[J,Q]){if($.push("CONFIG","SET"),typeof J==="string"||J instanceof Buffer)$.push(J,Q);else for(let[z,q]of Object.entries(J))$.push(z,q)},transformReply:void 0}});var cJ=w((_J)=>{Object.defineProperty(_J,"__esModule",{value:!0});_J.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("COPY"),$.pushKeys([J,Q]),z?.DB)$.push("DB",z.DB.toString());if(z?.REPLACE)$.push("REPLACE")},transformReply:void 0}});var lJ=w((dJ)=>{Object.defineProperty(dJ,"__esModule",{value:!0});dJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("DBSIZE")},transformReply:void 0}});var iJ=w((mJ)=>{Object.defineProperty(mJ,"__esModule",{value:!0});mJ.default={parseCommand($,J){$.push("DECR"),$.pushKey(J)},transformReply:void 0}});var tJ=w((nJ)=>{Object.defineProperty(nJ,"__esModule",{value:!0});nJ.default={parseCommand($,J,Q){$.push("DECRBY"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var oJ=w((aJ)=>{Object.defineProperty(aJ,"__esModule",{value:!0});aJ.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("DEL"),$.pushKeys(J)},transformReply:void 0}});var sJ=w((pJ)=>{Object.defineProperty(pJ,"__esModule",{value:!0});pJ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("DUMP"),$.pushKey(J)},transformReply:void 0}});var eJ=w((rJ)=>{Object.defineProperty(rJ,"__esModule",{value:!0});rJ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("ECHO",J)},transformReply:void 0}});var g0=w((JQ)=>{Object.defineProperty(JQ,"__esModule",{value:!0});JQ.parseEvalArguments=void 0;function $Q($,J,Q){if($.push(J),Q?.keys)$.pushKeysLength(Q.keys);else $.push("0");if(Q?.arguments)$.push(...Q.arguments)}JQ.parseEvalArguments=$Q;JQ.default={IS_READ_ONLY:!1,parseCommand(...$){$[0].push("EVAL"),$Q(...$)},transformReply:void 0}});var qQ=w((z0)=>{var bL=z0&&z0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),UL=z0&&z0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),hL=z0&&z0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))bL(J,$,Q)}return UL(J,$),J};Object.defineProperty(z0,"__esModule",{value:!0});var zQ=hL(g0());z0.default={IS_READ_ONLY:!0,parseCommand(...$){$[0].push("EVAL_RO"),(0,zQ.parseEvalArguments)(...$)},transformReply:zQ.default.transformReply}});var ZQ=w((q0)=>{var NL=q0&&q0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),IL=q0&&q0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),OL=q0&&q0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))NL(J,$,Q)}return IL(J,$),J};Object.defineProperty(q0,"__esModule",{value:!0});var wQ=OL(g0());q0.default={IS_READ_ONLY:!0,parseCommand(...$){$[0].push("EVALSHA_RO"),(0,wQ.parseEvalArguments)(...$)},transformReply:wQ.default.transformReply}});var WQ=w((w0)=>{var DL=w0&&w0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),AL=w0&&w0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),xL=w0&&w0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))DL(J,$,Q)}return AL(J,$),J};Object.defineProperty(w0,"__esModule",{value:!0});var KQ=xL(g0());w0.default={IS_READ_ONLY:!1,parseCommand(...$){$[0].push("EVALSHA"),(0,KQ.parseEvalArguments)(...$)},transformReply:KQ.default.transformReply}});var XQ=w((YQ)=>{Object.defineProperty(YQ,"__esModule",{value:!0});YQ.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("GEOADD"),$.pushKey(J),z?.condition)$.push(z.condition);else if(z?.NX)$.push("NX");else if(z?.XX)$.push("XX");if(z?.CH)$.push("CH");if(Array.isArray(Q))for(let q of Q)VQ($,q);else VQ($,Q)},transformReply:void 0};function VQ($,{longitude:J,latitude:Q,member:z}){$.push(J.toString(),Q.toString(),z)}});var HQ=w((FQ)=>{Object.defineProperty(FQ,"__esModule",{value:!0});FQ.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("GEODIST"),$.pushKey(J),$.push(Q,z),q)$.push(q)},transformReply($){return $===null?null:Number($)}}});var jQ=w((BQ)=>{Object.defineProperty(BQ,"__esModule",{value:!0});BQ.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("GEOHASH"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var GQ=w((vQ)=>{Object.defineProperty(vQ,"__esModule",{value:!0});vQ.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("GEOPOS"),$.pushKey(J),$.pushVariadic(Q)},transformReply($){return $.map((J)=>{let Q=J;return Q===null?null:{longitude:Q[0],latitude:Q[1]}})}}});var R0=w((UQ)=>{Object.defineProperty(UQ,"__esModule",{value:!0});UQ.parseGeoSearchOptions=UQ.parseGeoSearchArguments=void 0;function PQ($,J,Q,z,q){if($.pushKey(J),typeof Q==="string"||Q instanceof Buffer)$.push("FROMMEMBER",Q);else $.push("FROMLONLAT",Q.longitude.toString(),Q.latitude.toString());if("radius"in z)$.push("BYRADIUS",z.radius.toString(),z.unit);else $.push("BYBOX",z.width.toString(),z.height.toString(),z.unit);bQ($,q)}UQ.parseGeoSearchArguments=PQ;function bQ($,J){if(J?.SORT)$.push(J.SORT);if(J?.COUNT){if(typeof J.COUNT==="number")$.push("COUNT",J.COUNT.toString());else if($.push("COUNT",J.COUNT.value.toString()),J.COUNT.ANY)$.push("ANY")}}UQ.parseGeoSearchOptions=bQ;UQ.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){$.push("GEOSEARCH"),PQ($,J,Q,z,q)},transformReply:void 0}});var f$=w((IQ)=>{Object.defineProperty(IQ,"__esModule",{value:!0});IQ.parseGeoRadiusArguments=void 0;var EL=R0();function NQ($,J,Q,z,q,Z){$.pushKey(J),$.push(Q.longitude.toString(),Q.latitude.toString(),z.toString(),q),(0,EL.parseGeoSearchOptions)($,Z)}IQ.parseGeoRadiusArguments=NQ;IQ.default={IS_READ_ONLY:!1,parseCommand(...$){return $[0].push("GEORADIUS"),NQ(...$)},transformReply:void 0}});var M$=w((m)=>{var gL=m&&m.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(m,"__esModule",{value:!0});m.GEO_REPLY_WITH=void 0;var DQ=gL(R0());m.GEO_REPLY_WITH={DISTANCE:"WITHDIST",HASH:"WITHHASH",COORDINATES:"WITHCOORD"};m.default={IS_READ_ONLY:DQ.default.IS_READ_ONLY,parseCommand($,J,Q,z,q,Z){DQ.default.parseCommand($,J,Q,z,Z),$.push(...q),$.preserve=q},transformReply($,J){let Q=new Set(J),z=0,q=Q.has(m.GEO_REPLY_WITH.DISTANCE)&&++z,Z=Q.has(m.GEO_REPLY_WITH.HASH)&&++z,W=Q.has(m.GEO_REPLY_WITH.COORDINATES)&&++z;return $.map((V)=>{let Y=V,F={member:Y[0]};if(q)F.distance=Y[q];if(Z)F.hash=Y[Z];if(W){let[H,B]=Y[W];F.coordinates={longitude:H,latitude:B}}return F})}}});var z7=w((k)=>{var RL=k&&k.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),yL=k&&k.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),uL=k&&k.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))RL(J,$,Q)}return yL(J,$),J},_L=k&&k.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(k,"__esModule",{value:!0});k.parseGeoRadiusWithArguments=void 0;var AQ=uL(f$()),cL=_L(M$());function xQ($,J,Q,z,q,Z,W){(0,AQ.parseGeoRadiusArguments)($,J,Q,z,q,W),$.pushVariadic(Z),$.preserve=Z}k.parseGeoRadiusWithArguments=xQ;k.default={IS_READ_ONLY:AQ.default.IS_READ_ONLY,parseCommand($,J,Q,z,q,Z,W){$.push("GEORADIUS"),xQ($,J,Q,z,q,Z,W)},transformReply:cL.default.transformReply}});var CQ=w((S$)=>{var dL=S$&&S$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(S$,"__esModule",{value:!0});var lL=z7(),mL=dL(z7());S$.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand(...$){$[0].push("GEORADIUS_RO"),(0,lL.parseGeoRadiusWithArguments)(...$)},transformReply:mL.default.transformReply}});var LQ=w((Z0)=>{var iL=Z0&&Z0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),nL=Z0&&Z0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),tL=Z0&&Z0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))iL(J,$,Q)}return nL(J,$),J};Object.defineProperty(Z0,"__esModule",{value:!0});var TQ=tL(f$());Z0.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand(...$){$[0].push("GEORADIUS_RO"),(0,TQ.parseGeoRadiusArguments)(...$)},transformReply:TQ.default.transformReply}});var MQ=w((K0)=>{var aL=K0&&K0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),oL=K0&&K0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),pL=K0&&K0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))aL(J,$,Q)}return oL(J,$),J};Object.defineProperty(K0,"__esModule",{value:!0});var fQ=pL(f$());K0.default={IS_READ_ONLY:fQ.default.IS_READ_ONLY,parseCommand($,J,Q,z,q,Z,W){if($.push("GEORADIUS"),(0,fQ.parseGeoRadiusArguments)($,J,Q,z,q,W),W?.STOREDIST)$.push("STOREDIST"),$.pushKey(Z);else $.push("STORE"),$.pushKey(Z)},transformReply:void 0}});var E$=w((EQ)=>{Object.defineProperty(EQ,"__esModule",{value:!0});EQ.parseGeoRadiusByMemberArguments=void 0;var sL=R0();function SQ($,J,Q,z,q,Z){$.pushKey(J),$.push(Q,z.toString(),q),(0,sL.parseGeoSearchOptions)($,Z)}EQ.parseGeoRadiusByMemberArguments=SQ;EQ.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,Z){$.push("GEORADIUSBYMEMBER"),SQ($,J,Q,z,q,Z)},transformReply:void 0}});var z5=w((y0)=>{var gQ=y0&&y0.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(y0,"__esModule",{value:!0});y0.parseGeoRadiusByMemberWithArguments=void 0;var eL=gQ(E$()),$f=R0(),Jf=gQ(M$());function RQ($,J,Q,z,q,Z,W){$.pushKey(J),$.push(Q,z.toString(),q),(0,$f.parseGeoSearchOptions)($,W),$.push(...Z),$.preserve=Z}y0.parseGeoRadiusByMemberWithArguments=RQ;y0.default={IS_READ_ONLY:eL.default.IS_READ_ONLY,parseCommand($,J,Q,z,q,Z,W){$.push("GEORADIUSBYMEMBER"),RQ($,J,Q,z,q,Z,W)},transformReply:Jf.default.transformReply}});var uQ=w((W0)=>{var Qf=W0&&W0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),zf=W0&&W0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),qf=W0&&W0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Qf(J,$,Q)}return zf(J,$),J};Object.defineProperty(W0,"__esModule",{value:!0});var yQ=qf(z5());W0.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand(...$){$[0].push("GEORADIUSBYMEMBER_RO"),(0,yQ.parseGeoRadiusByMemberWithArguments)(...$)},transformReply:yQ.default.transformReply}});var cQ=w((V0)=>{var wf=V0&&V0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Zf=V0&&V0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Kf=V0&&V0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))wf(J,$,Q)}return Zf(J,$),J};Object.defineProperty(V0,"__esModule",{value:!0});var _Q=Kf(E$());V0.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand(...$){$[0].push("GEORADIUSBYMEMBER_RO"),(0,_Q.parseGeoRadiusByMemberArguments)(...$)},transformReply:_Q.default.transformReply}});var lQ=w((Y0)=>{var Wf=Y0&&Y0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Vf=Y0&&Y0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Yf=Y0&&Y0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Wf(J,$,Q)}return Vf(J,$),J};Object.defineProperty(Y0,"__esModule",{value:!0});var dQ=Yf(E$());Y0.default={IS_READ_ONLY:dQ.default.IS_READ_ONLY,parseCommand($,J,Q,z,q,Z,W){if($.push("GEORADIUSBYMEMBER"),(0,dQ.parseGeoRadiusByMemberArguments)($,J,Q,z,q,W),W?.STOREDIST)$.push("STOREDIST"),$.pushKey(Z);else $.push("STORE"),$.pushKey(Z)},transformReply:void 0}});var iQ=w((mQ)=>{Object.defineProperty(mQ,"__esModule",{value:!0});var Xf=R0();mQ.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,Z){if($.push("GEOSEARCHSTORE"),J!==void 0)$.pushKey(J);if((0,Xf.parseGeoSearchArguments)($,Q,z,q,Z),Z?.STOREDIST)$.push("STOREDIST")},transformReply:void 0}});var tQ=w((nQ)=>{Object.defineProperty(nQ,"__esModule",{value:!0});nQ.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("GET"),$.pushKey(J)},transformReply:void 0}});var oQ=w((aQ)=>{Object.defineProperty(aQ,"__esModule",{value:!0});aQ.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("GETBIT"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var sQ=w((pQ)=>{Object.defineProperty(pQ,"__esModule",{value:!0});pQ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("GETDEL"),$.pushKey(J)},transformReply:void 0}});var eQ=w((rQ)=>{Object.defineProperty(rQ,"__esModule",{value:!0});var q5=X();rQ.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("GETEX"),$.pushKey(J),"type"in Q)switch(Q.type){case"EX":case"PX":$.push(Q.type,Q.value.toString());break;case"EXAT":case"PXAT":$.push(Q.type,(0,q5.transformEXAT)(Q.value));break;case"PERSIST":$.push("PERSIST");break}else if("EX"in Q)$.push("EX",Q.EX.toString());else if("PX"in Q)$.push("PX",Q.PX.toString());else if("EXAT"in Q)$.push("EXAT",(0,q5.transformEXAT)(Q.EXAT));else if("PXAT"in Q)$.push("PXAT",(0,q5.transformPXAT)(Q.PXAT));else $.push("PERSIST")},transformReply:void 0}});var Jz=w(($z)=>{Object.defineProperty($z,"__esModule",{value:!0});$z.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("GETRANGE"),$.pushKey(J),$.push(Q.toString(),z.toString())},transformReply:void 0}});var zz=w((Qz)=>{Object.defineProperty(Qz,"__esModule",{value:!0});Qz.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("GETSET"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var wz=w((qz)=>{Object.defineProperty(qz,"__esModule",{value:!0});qz.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("EXISTS"),$.pushKeys(J)},transformReply:void 0}});var Kz=w((Zz)=>{Object.defineProperty(Zz,"__esModule",{value:!0});Zz.default={parseCommand($,J,Q,z){if($.push("EXPIRE"),$.pushKey(J),$.push(Q.toString()),z)$.push(z)},transformReply:void 0}});var Vz=w((Wz)=>{Object.defineProperty(Wz,"__esModule",{value:!0});var hf=X();Wz.default={parseCommand($,J,Q,z){if($.push("EXPIREAT"),$.pushKey(J),$.push((0,hf.transformEXAT)(Q)),z)$.push(z)},transformReply:void 0}});var Xz=w((Yz)=>{Object.defineProperty(Yz,"__esModule",{value:!0});Yz.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("EXPIRETIME"),$.pushKey(J)},transformReply:void 0}});var Bz=w((Fz)=>{Object.defineProperty(Fz,"__esModule",{value:!0});Fz.REDIS_FLUSH_MODES=void 0;Fz.REDIS_FLUSH_MODES={ASYNC:"ASYNC",SYNC:"SYNC"};Fz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J){if($.push("FLUSHALL"),J)$.push(J)},transformReply:void 0}});var vz=w((jz)=>{Object.defineProperty(jz,"__esModule",{value:!0});jz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J){if($.push("FLUSHDB"),J)$.push(J)},transformReply:void 0}});var Pz=w((X0)=>{var Af=X0&&X0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),xf=X0&&X0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Cf=X0&&X0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Af(J,$,Q)}return xf(J,$),J};Object.defineProperty(X0,"__esModule",{value:!0});var Gz=Cf(g0());X0.default={IS_READ_ONLY:!1,parseCommand(...$){$[0].push("FCALL"),(0,Gz.parseEvalArguments)(...$)},transformReply:Gz.default.transformReply}});var Uz=w((F0)=>{var Tf=F0&&F0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Lf=F0&&F0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),ff=F0&&F0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Tf(J,$,Q)}return Lf(J,$),J};Object.defineProperty(F0,"__esModule",{value:!0});var bz=ff(g0());F0.default={IS_READ_ONLY:!1,parseCommand(...$){$[0].push("FCALL_RO"),(0,bz.parseEvalArguments)(...$)},transformReply:bz.default.transformReply}});var Nz=w((hz)=>{Object.defineProperty(hz,"__esModule",{value:!0});hz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J){$.push("FUNCTION","DELETE",J)},transformReply:void 0}});var Oz=w((Iz)=>{Object.defineProperty(Iz,"__esModule",{value:!0});Iz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("FUNCTION","DUMP")},transformReply:void 0}});var Az=w((Dz)=>{Object.defineProperty(Dz,"__esModule",{value:!0});Dz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J){if($.push("FUNCTION","FLUSH"),J)$.push(J)},transformReply:void 0}});var Cz=w((xz)=>{Object.defineProperty(xz,"__esModule",{value:!0});xz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("FUNCTION","KILL")},transformReply:void 0}});var w5=w((Tz)=>{Object.defineProperty(Tz,"__esModule",{value:!0});Tz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J){if($.push("FUNCTION","LIST"),J?.LIBRARYNAME)$.push("LIBRARYNAME",J.LIBRARYNAME)},transformReply:{2:($)=>{return $.map((J)=>{let Q=J;return{library_name:Q[1],engine:Q[3],functions:Q[5].map((z)=>{let q=z;return{name:q[1],description:q[3],flags:q[5]}})}})},3:void 0}}});var Lz=w((k$)=>{var Rf=k$&&k$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(k$,"__esModule",{value:!0});var Z5=Rf(w5());k$.default={NOT_KEYED_COMMAND:Z5.default.NOT_KEYED_COMMAND,IS_READ_ONLY:Z5.default.IS_READ_ONLY,parseCommand(...$){Z5.default.parseCommand(...$),$[0].push("WITHCODE")},transformReply:{2:($)=>{return $.map((J)=>{let Q=J;return{library_name:Q[1],engine:Q[3],functions:Q[5].map((z)=>{let q=z;return{name:q[1],description:q[3],flags:q[5]}}),library_code:Q[7]}})},3:void 0}}});var Mz=w((fz)=>{Object.defineProperty(fz,"__esModule",{value:!0});fz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("FUNCTION","LOAD"),Q?.REPLACE)$.push("REPLACE");$.push(J)},transformReply:void 0}});var Ez=w((Sz)=>{Object.defineProperty(Sz,"__esModule",{value:!0});Sz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("FUNCTION","RESTORE",J),Q?.mode)$.push(Q.mode)},transformReply:void 0}});var gz=w((kz)=>{Object.defineProperty(kz,"__esModule",{value:!0});var _f=X();kz.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("FUNCTION","STATS")},transformReply:{2:($)=>{return{running_script:cf($[1]),engines:df($[3])}},3:void 0}};function cf($){if((0,_f.isNullReply)($))return null;let J=$;return{name:J[1],command:J[3],duration_ms:J[5]}}function df($){let J=$,Q=Object.create(null);for(let z=0;z<J.length;z++){let q=J[z],Z=J[++z],W=Z;Q[q.toString()]={libraries_count:W[1],functions_count:W[3]}}return Q}});var yz=w((Rz)=>{Object.defineProperty(Rz,"__esModule",{value:!0});Rz.default={parseCommand($,J,Q){$.push("HDEL"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var K5=w((uz)=>{Object.defineProperty(uz,"__esModule",{value:!0});uz.default={parseCommand($,J,Q){if($.push("HELLO"),J){if($.push(J.toString()),Q?.AUTH)$.push("AUTH",Q.AUTH.username,Q.AUTH.password);if(Q?.SETNAME)$.push("SETNAME",Q.SETNAME)}},transformReply:{2:($)=>({server:$[1],version:$[3],proto:$[5],id:$[7],mode:$[9],role:$[11],modules:$[13]}),3:void 0}}});var cz=w((_z)=>{Object.defineProperty(_z,"__esModule",{value:!0});_z.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HEXISTS"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var mz=w((dz)=>{Object.defineProperty(dz,"__esModule",{value:!0});dz.HASH_EXPIRATION=void 0;dz.HASH_EXPIRATION={FIELD_NOT_EXISTS:-2,CONDITION_NOT_MET:0,UPDATED:1,DELETED:2};dz.default={parseCommand($,J,Q,z,q){if($.push("HEXPIRE"),$.pushKey(J),$.push(z.toString()),q)$.push(q);$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var nz=w((iz)=>{Object.defineProperty(iz,"__esModule",{value:!0});var of=X();iz.default={parseCommand($,J,Q,z,q){if($.push("HEXPIREAT"),$.pushKey(J),$.push((0,of.transformEXAT)(z)),q)$.push(q);$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var oz=w((tz)=>{Object.defineProperty(tz,"__esModule",{value:!0});tz.HASH_EXPIRATION_TIME=void 0;tz.HASH_EXPIRATION_TIME={FIELD_NOT_EXISTS:-2,NO_EXPIRATION:-1};tz.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HEXPIRETIME"),$.pushKey(J),$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var sz=w((pz)=>{Object.defineProperty(pz,"__esModule",{value:!0});pz.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HGET"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var ez=w((rz)=>{Object.defineProperty(rz,"__esModule",{value:!0});var ef=X();rz.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("HGETALL"),$.pushKey(J)},TRANSFORM_LEGACY_REPLY:!0,transformReply:{2:ef.transformTuplesReply,3:void 0}}});var Jq=w(($q)=>{Object.defineProperty($q,"__esModule",{value:!0});$q.default={parseCommand($,J,Q){$.push("HGETDEL"),$.pushKey(J),$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var zq=w((Qq)=>{Object.defineProperty(Qq,"__esModule",{value:!0});Qq.default={parseCommand($,J,Q,z){if($.push("HGETEX"),$.pushKey(J),z?.expiration)if(typeof z.expiration==="string")$.push(z.expiration);else if(z.expiration.type==="PERSIST")$.push("PERSIST");else $.push(z.expiration.type,z.expiration.value.toString());$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var wq=w((qq)=>{Object.defineProperty(qq,"__esModule",{value:!0});qq.default={parseCommand($,J,Q,z){$.push("HINCRBY"),$.pushKey(J),$.push(Q,z.toString())},transformReply:void 0}});var Kq=w((Zq)=>{Object.defineProperty(Zq,"__esModule",{value:!0});Zq.default={parseCommand($,J,Q,z){$.push("HINCRBYFLOAT"),$.pushKey(J),$.push(Q,z.toString())},transformReply:void 0}});var Vq=w((Wq)=>{Object.defineProperty(Wq,"__esModule",{value:!0});Wq.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("HKEYS"),$.pushKey(J)},transformReply:void 0}});var Xq=w((Yq)=>{Object.defineProperty(Yq,"__esModule",{value:!0});Yq.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("HLEN"),$.pushKey(J)},transformReply:void 0}});var Hq=w((Fq)=>{Object.defineProperty(Fq,"__esModule",{value:!0});Fq.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HMGET"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var jq=w((Bq)=>{Object.defineProperty(Bq,"__esModule",{value:!0});Bq.default={parseCommand($,J,Q){$.push("HPERSIST"),$.pushKey(J),$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var Gq=w((vq)=>{Object.defineProperty(vq,"__esModule",{value:!0});vq.default={parseCommand($,J,Q,z,q){if($.push("HPEXPIRE"),$.pushKey(J),$.push(z.toString()),q)$.push(q);$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var bq=w((Pq)=>{Object.defineProperty(Pq,"__esModule",{value:!0});var YM=X();Pq.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("HPEXPIREAT"),$.pushKey(J),$.push((0,YM.transformPXAT)(z)),q)$.push(q);$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var hq=w((Uq)=>{Object.defineProperty(Uq,"__esModule",{value:!0});Uq.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HPEXPIRETIME"),$.pushKey(J),$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var Iq=w((Nq)=>{Object.defineProperty(Nq,"__esModule",{value:!0});Nq.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HPTTL"),$.pushKey(J),$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var Dq=w((Oq)=>{Object.defineProperty(Oq,"__esModule",{value:!0});Oq.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HRANDFIELD"),$.pushKey(J),$.push(Q.toString(),"WITHVALUES")},transformReply:{2:($)=>{let J=[],Q=0;while(Q<$.length)J.push({field:$[Q++],value:$[Q++]});return J},3:($)=>{return $.map((J)=>{let[Q,z]=J;return{field:Q,value:z}})}}}});var xq=w((Aq)=>{Object.defineProperty(Aq,"__esModule",{value:!0});Aq.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HRANDFIELD"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var Tq=w((Cq)=>{Object.defineProperty(Cq,"__esModule",{value:!0});Cq.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("HRANDFIELD"),$.pushKey(J)},transformReply:void 0}});var g$=w((fq)=>{Object.defineProperty(fq,"__esModule",{value:!0});fq.pushScanArguments=fq.parseScanArguments=void 0;function Lq($,J,Q){if($.push(J),Q?.MATCH)$.push("MATCH",Q.MATCH);if(Q?.COUNT)$.push("COUNT",Q.COUNT.toString())}fq.parseScanArguments=Lq;function GM($,J,Q){if($.push(J.toString()),Q?.MATCH)$.push("MATCH",Q.MATCH);if(Q?.COUNT)$.push("COUNT",Q.COUNT.toString());return $}fq.pushScanArguments=GM;fq.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("SCAN"),Lq($,J,Q),Q?.TYPE)$.push("TYPE",Q.TYPE)},transformReply([$,J]){return{cursor:$,keys:J}}}});var W5=w((Sq)=>{Object.defineProperty(Sq,"__esModule",{value:!0});var UM=g$();Sq.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("HSCAN"),$.pushKey(J),(0,UM.parseScanArguments)($,Q,z)},transformReply([$,J]){let Q=[],z=0;while(z<J.length)Q.push({field:J[z++],value:J[z++]});return{cursor:$,entries:Q}}}});var Eq=w((R$)=>{var NM=R$&&R$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(R$,"__esModule",{value:!0});var IM=NM(W5());R$.default={IS_READ_ONLY:!0,parseCommand(...$){let J=$[0];IM.default.parseCommand(...$),J.push("NOVALUES")},transformReply([$,J]){return{cursor:$,fields:J}}}});var Rq=w((gq)=>{Object.defineProperty(gq,"__esModule",{value:!0});gq.default={parseCommand($,...[J,Q,z]){if($.push("HSET"),$.pushKey(J),typeof Q==="string"||typeof Q==="number"||Q instanceof Buffer)$.push(u0(Q),u0(z));else if(Q instanceof Map)OM($,Q);else if(Array.isArray(Q))kq($,Q);else DM($,Q)},transformReply:void 0};function OM($,J){for(let[Q,z]of J.entries())$.push(u0(Q),u0(z))}function kq($,J){for(let Q of J){if(Array.isArray(Q)){kq($,Q);continue}$.push(u0(Q))}}function DM($,J){for(let Q of Object.keys(J))$.push(u0(Q),u0(J[Q]))}function u0($){return typeof $==="number"?$.toString():$}});var _q=w((uq)=>{Object.defineProperty(uq,"__esModule",{value:!0});var xM=d();uq.default={parseCommand($,J,Q,z){if($.push("HSETEX"),$.pushKey(J),z?.mode)$.push(z.mode);if(z?.expiration)if(typeof z.expiration==="string")$.push(z.expiration);else if(z.expiration.type==="KEEPTTL")$.push("KEEPTTL");else $.push(z.expiration.type,z.expiration.value.toString());if($.push("FIELDS"),Q instanceof Map)CM($,Q);else if(Array.isArray(Q))TM($,Q);else LM($,Q)},transformReply:void 0};function CM($,J){$.push(J.size.toString());for(let[Q,z]of J.entries())$.push(y$(Q),y$(z))}function TM($,J){let Q=new xM.BasicCommandParser;if(yq(Q,J),Q.redisArgs.length%2!=0)throw Error("invalid number of arguments, expected key value ....[key value] pairs, got key without value");$.push((Q.redisArgs.length/2).toString()),$.push(...Q.redisArgs)}function yq($,J){for(let Q of J){if(Array.isArray(Q)){yq($,Q);continue}$.push(y$(Q))}}function LM($,J){let Q=Object.keys(J).length;if(Q==0)throw Error("object without keys");$.push(Q.toString());for(let z of Object.keys(J))$.push(y$(z),y$(J[z]))}function y$($){return typeof $==="number"?$.toString():$}});var dq=w((cq)=>{Object.defineProperty(cq,"__esModule",{value:!0});cq.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("HSETNX"),$.pushKey(J),$.push(Q,z)},transformReply:void 0}});var mq=w((lq)=>{Object.defineProperty(lq,"__esModule",{value:!0});lq.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HSTRLEN"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var nq=w((iq)=>{Object.defineProperty(iq,"__esModule",{value:!0});iq.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("HTTL"),$.pushKey(J),$.push("FIELDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var aq=w((tq)=>{Object.defineProperty(tq,"__esModule",{value:!0});tq.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("HVALS"),$.pushKey(J)},transformReply:void 0}});var pq=w((oq)=>{Object.defineProperty(oq,"__esModule",{value:!0});oq.default={parseCommand($,J){$.push("INCR"),$.pushKey(J)},transformReply:void 0}});var rq=w((sq)=>{Object.defineProperty(sq,"__esModule",{value:!0});sq.default={parseCommand($,J,Q){$.push("INCRBY"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var $w=w((eq)=>{Object.defineProperty(eq,"__esModule",{value:!0});eq.default={parseCommand($,J,Q){$.push("INCRBYFLOAT"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var Qw=w((Jw)=>{Object.defineProperty(Jw,"__esModule",{value:!0});Jw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("INFO"),J)$.push(J)},transformReply:void 0}});var qw=w((zw)=>{Object.defineProperty(zw,"__esModule",{value:!0});zw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("KEYS",J)},transformReply:void 0}});var Zw=w((ww)=>{Object.defineProperty(ww,"__esModule",{value:!0});ww.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("LASTSAVE")},transformReply:void 0}});var Ww=w((Kw)=>{Object.defineProperty(Kw,"__esModule",{value:!0});Kw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("LATENCY","DOCTOR")},transformReply:void 0}});var V5=w((Vw)=>{Object.defineProperty(Vw,"__esModule",{value:!0});Vw.LATENCY_EVENTS=void 0;Vw.LATENCY_EVENTS={ACTIVE_DEFRAG_CYCLE:"active-defrag-cycle",AOF_FSYNC_ALWAYS:"aof-fsync-always",AOF_STAT:"aof-stat",AOF_REWRITE_DIFF_WRITE:"aof-rewrite-diff-write",AOF_RENAME:"aof-rename",AOF_WRITE:"aof-write",AOF_WRITE_ACTIVE_CHILD:"aof-write-active-child",AOF_WRITE_ALONE:"aof-write-alone",AOF_WRITE_PENDING_FSYNC:"aof-write-pending-fsync",COMMAND:"command",EXPIRE_CYCLE:"expire-cycle",EVICTION_CYCLE:"eviction-cycle",EVICTION_DEL:"eviction-del",FAST_COMMAND:"fast-command",FORK:"fork",RDB_UNLINK_TEMP_FILE:"rdb-unlink-temp-file"};Vw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("LATENCY","GRAPH",J)},transformReply:void 0}});var Fw=w((Xw)=>{Object.defineProperty(Xw,"__esModule",{value:!0});Xw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("LATENCY","HISTORY",J)},transformReply:void 0}});var Bw=w((Hw)=>{Object.defineProperty(Hw,"__esModule",{value:!0});Hw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("LATENCY","LATEST")},transformReply:void 0}});var jw=w((Y5)=>{Object.defineProperty(Y5,"__esModule",{value:!0});Y5.LATENCY_EVENTS=void 0;var nM=V5();Object.defineProperty(Y5,"LATENCY_EVENTS",{enumerable:!0,get:function(){return nM.LATENCY_EVENTS}});Y5.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,...J){let Q=["LATENCY","RESET"];if(J.length>0)Q.push(...J);$.push(...Q)},transformReply:void 0}});var q7=w((vw)=>{Object.defineProperty(vw,"__esModule",{value:!0});vw.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("LCS"),$.pushKeys([J,Q])},transformReply:void 0}});var X5=w((u$)=>{var pM=u$&&u$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(u$,"__esModule",{value:!0});var Gw=pM(q7());u$.default={IS_READ_ONLY:Gw.default.IS_READ_ONLY,parseCommand($,J,Q,z){if(Gw.default.parseCommand($,J,Q),$.push("IDX"),z?.MINMATCHLEN)$.push("MINMATCHLEN",z.MINMATCHLEN.toString())},transformReply:{2:($)=>({matches:$[1],len:$[3]}),3:void 0}}});var bw=w((_$)=>{var sM=_$&&_$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(_$,"__esModule",{value:!0});var Pw=sM(X5());_$.default={IS_READ_ONLY:Pw.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];Pw.default.parseCommand(...$),J.push("WITHMATCHLEN")},transformReply:{2:($)=>({matches:$[1],len:$[3]}),3:void 0}}});var hw=w((c$)=>{var rM=c$&&c$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(c$,"__esModule",{value:!0});var Uw=rM(q7());c$.default={IS_READ_ONLY:Uw.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];Uw.default.parseCommand(...$),J.push("LEN")},transformReply:void 0}});var Iw=w((Nw)=>{Object.defineProperty(Nw,"__esModule",{value:!0});Nw.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("LINDEX"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var Dw=w((Ow)=>{Object.defineProperty(Ow,"__esModule",{value:!0});Ow.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){$.push("LINSERT"),$.pushKey(J),$.push(Q,z,q)},transformReply:void 0}});var xw=w((Aw)=>{Object.defineProperty(Aw,"__esModule",{value:!0});Aw.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("LLEN"),$.pushKey(J)},transformReply:void 0}});var Tw=w((Cw)=>{Object.defineProperty(Cw,"__esModule",{value:!0});Cw.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){$.push("LMOVE"),$.pushKeys([J,Q]),$.push(z,q)},transformReply:void 0}});var fw=w((Lw)=>{Object.defineProperty(Lw,"__esModule",{value:!0});Lw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,...Q){if($.push("LOLWUT"),J)$.push("VERSION",J.toString()),$.pushVariadic(Q.map(String))},transformReply:void 0}});var F5=w((Mw)=>{Object.defineProperty(Mw,"__esModule",{value:!0});Mw.default={parseCommand($,J){$.push("LPOP"),$.pushKey(J)},transformReply:void 0}});var Sw=w((d$)=>{var wS=d$&&d$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(d$,"__esModule",{value:!0});var ZS=wS(F5());d$.default={IS_READ_ONLY:!1,parseCommand($,J,Q){ZS.default.parseCommand($,J),$.push(Q.toString())},transformReply:void 0}});var H5=w((Ew)=>{Object.defineProperty(Ew,"__esModule",{value:!0});Ew.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("LPOS"),$.pushKey(J),$.push(Q),z?.RANK!==void 0)$.push("RANK",z.RANK.toString());if(z?.MAXLEN!==void 0)$.push("MAXLEN",z.MAXLEN.toString())},transformReply:void 0}});var kw=w((l$)=>{var WS=l$&&l$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(l$,"__esModule",{value:!0});var B5=WS(H5());l$.default={CACHEABLE:B5.default.CACHEABLE,IS_READ_ONLY:B5.default.IS_READ_ONLY,parseCommand($,J,Q,z,q){B5.default.parseCommand($,J,Q,q),$.push("COUNT",z.toString())},transformReply:void 0}});var Rw=w((gw)=>{Object.defineProperty(gw,"__esModule",{value:!0});gw.default={parseCommand($,J,Q){$.push("LPUSH"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var uw=w((yw)=>{Object.defineProperty(yw,"__esModule",{value:!0});yw.default={parseCommand($,J,Q){$.push("LPUSHX"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var cw=w((_w)=>{Object.defineProperty(_w,"__esModule",{value:!0});_w.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("LRANGE"),$.pushKey(J),$.push(Q.toString(),z.toString())},transformReply:void 0}});var lw=w((dw)=>{Object.defineProperty(dw,"__esModule",{value:!0});dw.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("LREM"),$.pushKey(J),$.push(Q.toString()),$.push(z)},transformReply:void 0}});var iw=w((mw)=>{Object.defineProperty(mw,"__esModule",{value:!0});mw.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("LSET"),$.pushKey(J),$.push(Q.toString(),z)},transformReply:void 0}});var tw=w((nw)=>{Object.defineProperty(nw,"__esModule",{value:!0});nw.default={parseCommand($,J,Q,z){$.push("LTRIM"),$.pushKey(J),$.push(Q.toString(),z.toString())},transformReply:void 0}});var ow=w((aw)=>{Object.defineProperty(aw,"__esModule",{value:!0});aw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("MEMORY","DOCTOR")},transformReply:void 0}});var sw=w((pw)=>{Object.defineProperty(pw,"__esModule",{value:!0});pw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("MEMORY","MALLOC-STATS")},transformReply:void 0}});var ew=w((rw)=>{Object.defineProperty(rw,"__esModule",{value:!0});rw.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($){$.push("MEMORY","PURGE")},transformReply:void 0}});var JZ=w(($Z)=>{Object.defineProperty($Z,"__esModule",{value:!0});var PS=X();$Z.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("MEMORY","STATS")},transformReply:{2:($,J,Q)=>{let z={},q=0;while(q<$.length)switch($[q].toString()){case"dataset.percentage":case"peak.percentage":case"allocator-fragmentation.ratio":case"allocator-rss.ratio":case"rss-overhead.ratio":case"fragmentation":z[$[q++]]=PS.transformDoubleReply[2]($[q++],J,Q);break;default:z[$[q++]]=$[q++]}return z},3:void 0}}});var zZ=w((QZ)=>{Object.defineProperty(QZ,"__esModule",{value:!0});QZ.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("MEMORY","USAGE"),$.pushKey(J),Q?.SAMPLES)$.push("SAMPLES",Q.SAMPLES.toString())},transformReply:void 0}});var wZ=w((qZ)=>{Object.defineProperty(qZ,"__esModule",{value:!0});qZ.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("MGET"),$.pushKeys(J)},transformReply:void 0}});var KZ=w((ZZ)=>{Object.defineProperty(ZZ,"__esModule",{value:!0});ZZ.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,Z,W){$.push("MIGRATE",J,Q.toString());let V=Array.isArray(z);if(V)$.push("");else $.push(z);if($.push(q.toString(),Z.toString()),W?.COPY)$.push("COPY");if(W?.REPLACE)$.push("REPLACE");if(W?.AUTH)if(W.AUTH.username)$.push("AUTH2",W.AUTH.username,W.AUTH.password);else $.push("AUTH",W.AUTH.password);if(V)$.push("KEYS"),$.pushVariadic(z)},transformReply:void 0}});var VZ=w((WZ)=>{Object.defineProperty(WZ,"__esModule",{value:!0});WZ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("MODULE","LIST")},transformReply:{2:($)=>{return $.map((J)=>{let Q=J;return{name:Q[1],ver:Q[3]}})},3:void 0}}});var XZ=w((YZ)=>{Object.defineProperty(YZ,"__esModule",{value:!0});YZ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("MODULE","LOAD",J),Q)$.push(...Q)},transformReply:void 0}});var HZ=w((FZ)=>{Object.defineProperty(FZ,"__esModule",{value:!0});FZ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("MODULE","UNLOAD",J)},transformReply:void 0}});var jZ=w((BZ)=>{Object.defineProperty(BZ,"__esModule",{value:!0});BZ.default={parseCommand($,J,Q){$.push("MOVE"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var j5=w((GZ)=>{Object.defineProperty(GZ,"__esModule",{value:!0});GZ.parseMSetArguments=void 0;function vZ($,J){if(Array.isArray(J)){if(J.length==0)throw Error("empty toSet Argument");if(Array.isArray(J[0]))for(let Q of J)$.pushKey(Q[0]),$.push(Q[1]);else{let Q=J;for(let z=0;z<Q.length;z+=2)$.pushKey(Q[z]),$.push(Q[z+1])}}else for(let Q of Object.entries(J))$.pushKey(Q[0]),$.push(Q[1])}GZ.parseMSetArguments=vZ;GZ.default={IS_READ_ONLY:!0,parseCommand($,J){return $.push("MSET"),vZ($,J)},transformReply:void 0}});var UZ=w((bZ)=>{Object.defineProperty(bZ,"__esModule",{value:!0});var CS=j5();bZ.default={IS_READ_ONLY:!0,parseCommand($,J){return $.push("MSETNX"),(0,CS.parseMSetArguments)($,J)},transformReply:void 0}});var NZ=w((hZ)=>{Object.defineProperty(hZ,"__esModule",{value:!0});hZ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("OBJECT","ENCODING"),$.pushKey(J)},transformReply:void 0}});var OZ=w((IZ)=>{Object.defineProperty(IZ,"__esModule",{value:!0});IZ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("OBJECT","FREQ"),$.pushKey(J)},transformReply:void 0}});var AZ=w((DZ)=>{Object.defineProperty(DZ,"__esModule",{value:!0});DZ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("OBJECT","IDLETIME"),$.pushKey(J)},transformReply:void 0}});var CZ=w((xZ)=>{Object.defineProperty(xZ,"__esModule",{value:!0});xZ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("OBJECT","REFCOUNT"),$.pushKey(J)},transformReply:void 0}});var LZ=w((TZ)=>{Object.defineProperty(TZ,"__esModule",{value:!0});TZ.default={parseCommand($,J){$.push("PERSIST"),$.pushKey(J)},transformReply:void 0}});var MZ=w((fZ)=>{Object.defineProperty(fZ,"__esModule",{value:!0});fZ.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("PEXPIRE"),$.pushKey(J),$.push(Q.toString()),z)$.push(z)},transformReply:void 0}});var EZ=w((SZ)=>{Object.defineProperty(SZ,"__esModule",{value:!0});var gS=X();SZ.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("PEXPIREAT"),$.pushKey(J),$.push((0,gS.transformPXAT)(Q)),z)$.push(z)},transformReply:void 0}});var gZ=w((kZ)=>{Object.defineProperty(kZ,"__esModule",{value:!0});kZ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("PEXPIRETIME"),$.pushKey(J)},transformReply:void 0}});var yZ=w((RZ)=>{Object.defineProperty(RZ,"__esModule",{value:!0});RZ.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("PFADD"),$.pushKey(J),Q)$.pushVariadic(Q)},transformReply:void 0}});var _Z=w((uZ)=>{Object.defineProperty(uZ,"__esModule",{value:!0});uZ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("PFCOUNT"),$.pushKeys(J)},transformReply:void 0}});var dZ=w((cZ)=>{Object.defineProperty(cZ,"__esModule",{value:!0});cZ.default={parseCommand($,J,Q){if($.push("PFMERGE"),$.pushKey(J),Q)$.pushKeys(Q)},transformReply:void 0}});var mZ=w((lZ)=>{Object.defineProperty(lZ,"__esModule",{value:!0});lZ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("PING"),J)$.push(J)},transformReply:void 0}});var nZ=w((iZ)=>{Object.defineProperty(iZ,"__esModule",{value:!0});iZ.default={parseCommand($,J,Q,z){$.push("PSETEX"),$.pushKey(J),$.push(Q.toString(),z)},transformReply:void 0}});var aZ=w((tZ)=>{Object.defineProperty(tZ,"__esModule",{value:!0});tZ.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("PTTL"),$.pushKey(J)},transformReply:void 0}});var pZ=w((oZ)=>{Object.defineProperty(oZ,"__esModule",{value:!0});oZ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,IS_FORWARD_COMMAND:!0,parseCommand($,J,Q){$.push("PUBLISH",J,Q)},transformReply:void 0}});var rZ=w((sZ)=>{Object.defineProperty(sZ,"__esModule",{value:!0});sZ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("PUBSUB","CHANNELS"),J)$.push(J)},transformReply:void 0}});var $K=w((eZ)=>{Object.defineProperty(eZ,"__esModule",{value:!0});eZ.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("PUBSUB","NUMPAT")},transformReply:void 0}});var QK=w((JK)=>{Object.defineProperty(JK,"__esModule",{value:!0});JK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("PUBSUB","NUMSUB"),J)$.pushVariadic(J)},transformReply($){let J=Object.create(null),Q=0;while(Q<$.length)J[$[Q++].toString()]=Number($[Q++]);return J}}});var qK=w((zK)=>{Object.defineProperty(zK,"__esModule",{value:!0});zK.default={IS_READ_ONLY:!0,parseCommand($,J){if($.push("PUBSUB","SHARDNUMSUB"),J)$.pushVariadic(J)},transformReply($){let J=Object.create(null);for(let Q=0;Q<$.length;Q+=2)J[$[Q].toString()]=$[Q+1];return J}}});var ZK=w((wK)=>{Object.defineProperty(wK,"__esModule",{value:!0});wK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("PUBSUB","SHARDCHANNELS"),J)$.push(J)},transformReply:void 0}});var WK=w((KK)=>{Object.defineProperty(KK,"__esModule",{value:!0});KK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("RANDOMKEY")},transformReply:void 0}});var YK=w((VK)=>{Object.defineProperty(VK,"__esModule",{value:!0});VK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("READONLY")},transformReply:void 0}});var FK=w((XK)=>{Object.defineProperty(XK,"__esModule",{value:!0});XK.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("RENAME"),$.pushKeys([J,Q])},transformReply:void 0}});var BK=w((HK)=>{Object.defineProperty(HK,"__esModule",{value:!0});HK.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("RENAMENX"),$.pushKeys([J,Q])},transformReply:void 0}});var vK=w((jK)=>{Object.defineProperty(jK,"__esModule",{value:!0});jK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("REPLICAOF",J,Q.toString())},transformReply:void 0}});var PK=w((GK)=>{Object.defineProperty(GK,"__esModule",{value:!0});GK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("RESTORE-ASKING")},transformReply:void 0}});var UK=w((bK)=>{Object.defineProperty(bK,"__esModule",{value:!0});bK.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){if($.push("RESTORE"),$.pushKey(J),$.push(Q.toString(),z),q?.REPLACE)$.push("REPLACE");if(q?.ABSTTL)$.push("ABSTTL");if(q?.IDLETIME)$.push("IDLETIME",q.IDLETIME.toString());if(q?.FREQ)$.push("FREQ",q.FREQ.toString())},transformReply:void 0}});var NK=w((hK)=>{Object.defineProperty(hK,"__esModule",{value:!0});hK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("ROLE")},transformReply($){switch($[0]){case"master":{let[J,Q,z]=$;return{role:J,replicationOffest:Q,replicas:z.map((q)=>{let[Z,W,V]=q;return{host:Z,port:Number(W),replicationOffest:Number(V)}})}}case"slave":{let[J,Q,z,q,Z]=$;return{role:J,master:{host:Q,port:z},state:q,dataReceived:Z}}case"sentinel":{let[J,Q]=$;return{role:J,masterNames:Q}}}}}});var OK=w((IK)=>{Object.defineProperty(IK,"__esModule",{value:!0});IK.default={parseCommand($,J,Q){$.push("RPOP"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var AK=w((DK)=>{Object.defineProperty(DK,"__esModule",{value:!0});DK.default={parseCommand($,J){$.push("RPOP"),$.pushKey(J)},transformReply:void 0}});var CK=w((xK)=>{Object.defineProperty(xK,"__esModule",{value:!0});xK.default={parseCommand($,J,Q){$.push("RPOPLPUSH"),$.pushKeys([J,Q])},transformReply:void 0}});var LK=w((TK)=>{Object.defineProperty(TK,"__esModule",{value:!0});TK.default={parseCommand($,J,Q){$.push("RPUSH"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var MK=w((fK)=>{Object.defineProperty(fK,"__esModule",{value:!0});fK.default={parseCommand($,J,Q){$.push("RPUSHX"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var EK=w((SK)=>{Object.defineProperty(SK,"__esModule",{value:!0});SK.default={parseCommand($,J,Q){$.push("SADD"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var gK=w((kK)=>{Object.defineProperty(kK,"__esModule",{value:!0});kK.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("SCARD"),$.pushKey(J)},transformReply:void 0}});var yK=w((RK)=>{Object.defineProperty(RK,"__esModule",{value:!0});RK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("SCRIPT","DEBUG",J)},transformReply:void 0}});var _K=w((uK)=>{Object.defineProperty(uK,"__esModule",{value:!0});uK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("SCRIPT","EXISTS"),$.pushVariadic(J)},transformReply:void 0}});var dK=w((cK)=>{Object.defineProperty(cK,"__esModule",{value:!0});cK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){if($.push("SCRIPT","FLUSH"),J)$.push(J)},transformReply:void 0}});var mK=w((lK)=>{Object.defineProperty(lK,"__esModule",{value:!0});lK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("SCRIPT","KILL")},transformReply:void 0}});var nK=w((iK)=>{Object.defineProperty(iK,"__esModule",{value:!0});iK.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("SCRIPT","LOAD",J)},transformReply:void 0}});var aK=w((tK)=>{Object.defineProperty(tK,"__esModule",{value:!0});tK.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("SDIFF"),$.pushKeys(J)},transformReply:void 0}});var pK=w((oK)=>{Object.defineProperty(oK,"__esModule",{value:!0});oK.default={parseCommand($,J,Q){$.push("SDIFFSTORE"),$.pushKey(J),$.pushKeys(Q)},transformReply:void 0}});var rK=w((sK)=>{Object.defineProperty(sK,"__esModule",{value:!0});sK.default={parseCommand($,J,Q,z){if($.push("SET"),$.pushKey(J),$.push(typeof Q==="number"?Q.toString():Q),z?.expiration)if(typeof z.expiration==="string")$.push(z.expiration);else if(z.expiration.type==="KEEPTTL")$.push("KEEPTTL");else $.push(z.expiration.type,z.expiration.value.toString());else if(z?.EX!==void 0)$.push("EX",z.EX.toString());else if(z?.PX!==void 0)$.push("PX",z.PX.toString());else if(z?.EXAT!==void 0)$.push("EXAT",z.EXAT.toString());else if(z?.PXAT!==void 0)$.push("PXAT",z.PXAT.toString());else if(z?.KEEPTTL)$.push("KEEPTTL");if(z?.condition)$.push(z.condition);else if(z?.NX)$.push("NX");else if(z?.XX)$.push("XX");if(z?.GET)$.push("GET")},transformReply:void 0}});var $W=w((eK)=>{Object.defineProperty(eK,"__esModule",{value:!0});eK.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("SETBIT"),$.pushKey(J),$.push(Q.toString(),z.toString())},transformReply:void 0}});var QW=w((JW)=>{Object.defineProperty(JW,"__esModule",{value:!0});JW.default={parseCommand($,J,Q,z){$.push("SETEX"),$.pushKey(J),$.push(Q.toString(),z)},transformReply:void 0}});var qW=w((zW)=>{Object.defineProperty(zW,"__esModule",{value:!0});zW.default={parseCommand($,J,Q){$.push("SETNX"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var ZW=w((wW)=>{Object.defineProperty(wW,"__esModule",{value:!0});wW.default={parseCommand($,J,Q,z){$.push("SETRANGE"),$.pushKey(J),$.push(Q.toString(),z)},transformReply:void 0}});var WW=w((KW)=>{Object.defineProperty(KW,"__esModule",{value:!0});KW.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("SINTER"),$.pushKeys(J)},transformReply:void 0}});var YW=w((VW)=>{Object.defineProperty(VW,"__esModule",{value:!0});VW.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("SINTERCARD"),$.pushKeysLength(J),typeof Q==="number")$.push("LIMIT",Q.toString());else if(Q?.LIMIT!==void 0)$.push("LIMIT",Q.LIMIT.toString())},transformReply:void 0}});var FW=w((XW)=>{Object.defineProperty(XW,"__esModule",{value:!0});XW.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("SINTERSTORE"),$.pushKey(J),$.pushKeys(Q)},transformReply:void 0}});var BW=w((HW)=>{Object.defineProperty(HW,"__esModule",{value:!0});HW.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("SISMEMBER"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var vW=w((jW)=>{Object.defineProperty(jW,"__esModule",{value:!0});jW.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("SMEMBERS"),$.pushKey(J)},transformReply:{2:void 0,3:void 0}}});var PW=w((GW)=>{Object.defineProperty(GW,"__esModule",{value:!0});GW.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("SMISMEMBER"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var UW=w((bW)=>{Object.defineProperty(bW,"__esModule",{value:!0});bW.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("SMOVE"),$.pushKeys([J,Q]),$.push(z)},transformReply:void 0}});var w7=w((NW)=>{Object.defineProperty(NW,"__esModule",{value:!0});NW.parseSortArguments=void 0;function hW($,J,Q){if($.pushKey(J),Q?.BY)$.push("BY",Q.BY);if(Q?.LIMIT)$.push("LIMIT",Q.LIMIT.offset.toString(),Q.LIMIT.count.toString());if(Q?.GET)if(Array.isArray(Q.GET))for(let z of Q.GET)$.push("GET",z);else $.push("GET",Q.GET);if(Q?.DIRECTION)$.push(Q.DIRECTION);if(Q?.ALPHA)$.push("ALPHA")}NW.parseSortArguments=hW;NW.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("SORT"),hW($,J,Q)},transformReply:void 0}});var DW=w((H0)=>{var ME=H0&&H0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),SE=H0&&H0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),EE=H0&&H0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))ME(J,$,Q)}return SE(J,$),J};Object.defineProperty(H0,"__esModule",{value:!0});var OW=EE(w7());H0.default={IS_READ_ONLY:!0,parseCommand(...$){$[0].push("SORT_RO"),(0,OW.parseSortArguments)(...$)},transformReply:OW.default.transformReply}});var AW=w((m$)=>{var kE=m$&&m$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(m$,"__esModule",{value:!0});var gE=kE(w7());m$.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){gE.default.parseCommand($,J,z),$.push("STORE",Q)},transformReply:void 0}});var CW=w((xW)=>{Object.defineProperty(xW,"__esModule",{value:!0});xW.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("SPOP"),$.pushKey(J),$.push(Q.toString())},transformReply:void 0}});var LW=w((TW)=>{Object.defineProperty(TW,"__esModule",{value:!0});TW.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("SPOP"),$.pushKey(J)},transformReply:void 0}});var MW=w((fW)=>{Object.defineProperty(fW,"__esModule",{value:!0});fW.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("SPUBLISH"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var v5=w((SW)=>{Object.defineProperty(SW,"__esModule",{value:!0});SW.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("SRANDMEMBER"),$.pushKey(J)},transformReply:void 0}});var kW=w((i$)=>{var cE=i$&&i$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(i$,"__esModule",{value:!0});var EW=cE(v5());i$.default={IS_READ_ONLY:EW.default.IS_READ_ONLY,parseCommand($,J,Q){EW.default.parseCommand($,J),$.push(Q.toString())},transformReply:void 0}});var RW=w((gW)=>{Object.defineProperty(gW,"__esModule",{value:!0});gW.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("SREM"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var uW=w((yW)=>{Object.defineProperty(yW,"__esModule",{value:!0});var lE=g$();yW.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("SSCAN"),$.pushKey(J),(0,lE.parseScanArguments)($,Q,z)},transformReply([$,J]){return{cursor:$,members:J}}}});var cW=w((_W)=>{Object.defineProperty(_W,"__esModule",{value:!0});_W.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("STRLEN"),$.pushKey(J)},transformReply:void 0}});var lW=w((dW)=>{Object.defineProperty(dW,"__esModule",{value:!0});dW.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("SUNION"),$.pushKeys(J)},transformReply:void 0}});var iW=w((mW)=>{Object.defineProperty(mW,"__esModule",{value:!0});mW.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("SUNIONSTORE"),$.pushKey(J),$.pushKeys(Q)},transformReply:void 0}});var tW=w((nW)=>{Object.defineProperty(nW,"__esModule",{value:!0});nW.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("SWAPDB",J.toString(),Q.toString())},transformReply:void 0}});var oW=w((aW)=>{Object.defineProperty(aW,"__esModule",{value:!0});aW.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("TIME")},transformReply:void 0}});var sW=w((pW)=>{Object.defineProperty(pW,"__esModule",{value:!0});pW.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("TOUCH"),$.pushKeys(J)},transformReply:void 0}});var eW=w((rW)=>{Object.defineProperty(rW,"__esModule",{value:!0});rW.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("TTL"),$.pushKey(J)},transformReply:void 0}});var JV=w(($V)=>{Object.defineProperty($V,"__esModule",{value:!0});$V.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("TYPE"),$.pushKey(J)},transformReply:void 0}});var zV=w((QV)=>{Object.defineProperty(QV,"__esModule",{value:!0});QV.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("UNLINK"),$.pushKeys(J)},transformReply:void 0}});var wV=w((qV)=>{Object.defineProperty(qV,"__esModule",{value:!0});qV.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("WAIT",J.toString(),Q.toString())},transformReply:void 0}});var KV=w((ZV)=>{Object.defineProperty(ZV,"__esModule",{value:!0});ZV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("XACK"),$.pushKey(J),$.push(Q),$.pushVariadic(z)},transformReply:void 0}});var VV=w((WV)=>{Object.defineProperty(WV,"__esModule",{value:!0});WV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){if($.push("XACKDEL"),$.pushKey(J),$.push(Q),q)$.push(q);$.push("IDS"),$.pushVariadicWithLength(z)},transformReply:void 0}});var G5=w((XV)=>{Object.defineProperty(XV,"__esModule",{value:!0});XV.parseXAddArguments=void 0;function YV($,J,Q,z,q,Z){if(J.push("XADD"),J.pushKey(Q),$)J.push($);if(Z?.TRIM){if(Z.TRIM.strategy)J.push(Z.TRIM.strategy);if(Z.TRIM.strategyModifier)J.push(Z.TRIM.strategyModifier);if(J.push(Z.TRIM.threshold.toString()),Z.TRIM.limit)J.push("LIMIT",Z.TRIM.limit.toString());if(Z.TRIM.policy)J.push(Z.TRIM.policy)}J.push(z);for(let[W,V]of Object.entries(q))J.push(W,V)}XV.parseXAddArguments=YV;XV.default={IS_READ_ONLY:!1,parseCommand(...$){return YV(void 0,...$)},transformReply:void 0}});var BV=w((HV)=>{Object.defineProperty(HV,"__esModule",{value:!0});var qk=G5();HV.default={IS_READ_ONLY:!1,parseCommand(...$){return(0,qk.parseXAddArguments)("NOMKSTREAM",...$)},transformReply:void 0}});var P5=w((jV)=>{Object.defineProperty(jV,"__esModule",{value:!0});var Zk=X();jV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,Z,W){if($.push("XAUTOCLAIM"),$.pushKey(J),$.push(Q,z,q.toString(),Z),W?.COUNT)$.push("COUNT",W.COUNT.toString())},transformReply($,J,Q){return{nextId:$[0],messages:$[1].map(Zk.transformStreamMessageNullReply.bind(void 0,Q)),deletedMessages:$[2]}}}});var GV=w((n$)=>{var Wk=n$&&n$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(n$,"__esModule",{value:!0});var vV=Wk(P5());n$.default={IS_READ_ONLY:vV.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];vV.default.parseCommand(...$),J.push("JUSTID")},transformReply($){return{nextId:$[0],messages:$[1],deletedMessages:$[2]}}}});var b5=w((PV)=>{Object.defineProperty(PV,"__esModule",{value:!0});var Vk=X();PV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,Z,W){if($.push("XCLAIM"),$.pushKey(J),$.push(Q,z,q.toString()),$.pushVariadic(Z),W?.IDLE!==void 0)$.push("IDLE",W.IDLE.toString());if(W?.TIME!==void 0)$.push("TIME",(W.TIME instanceof Date?W.TIME.getTime():W.TIME).toString());if(W?.RETRYCOUNT!==void 0)$.push("RETRYCOUNT",W.RETRYCOUNT.toString());if(W?.FORCE)$.push("FORCE");if(W?.LASTID!==void 0)$.push("LASTID",W.LASTID)},transformReply($,J,Q){return $.map(Vk.transformStreamMessageNullReply.bind(void 0,Q))}}});var UV=w((t$)=>{var Xk=t$&&t$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(t$,"__esModule",{value:!0});var bV=Xk(b5());t$.default={IS_READ_ONLY:bV.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];bV.default.parseCommand(...$),J.push("JUSTID")},transformReply:void 0}});var NV=w((hV)=>{Object.defineProperty(hV,"__esModule",{value:!0});hV.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("XDEL"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var OV=w((IV)=>{Object.defineProperty(IV,"__esModule",{value:!0});IV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("XDELEX"),$.pushKey(J),z)$.push(z);$.push("IDS"),$.pushVariadicWithLength(Q)},transformReply:void 0}});var AV=w((DV)=>{Object.defineProperty(DV,"__esModule",{value:!0});DV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){if($.push("XGROUP","CREATE"),$.pushKey(J),$.push(Q,z),q?.MKSTREAM)$.push("MKSTREAM");if(q?.ENTRIESREAD)$.push("ENTRIESREAD",q.ENTRIESREAD.toString())},transformReply:void 0}});var CV=w((xV)=>{Object.defineProperty(xV,"__esModule",{value:!0});xV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("XGROUP","CREATECONSUMER"),$.pushKey(J),$.push(Q,z)},transformReply:void 0}});var LV=w((TV)=>{Object.defineProperty(TV,"__esModule",{value:!0});TV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("XGROUP","DELCONSUMER"),$.pushKey(J),$.push(Q,z)},transformReply:void 0}});var MV=w((fV)=>{Object.defineProperty(fV,"__esModule",{value:!0});fV.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("XGROUP","DESTROY"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var EV=w((SV)=>{Object.defineProperty(SV,"__esModule",{value:!0});SV.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){if($.push("XGROUP","SETID"),$.pushKey(J),$.push(Q,z),q?.ENTRIESREAD)$.push("ENTRIESREAD",q.ENTRIESREAD.toString())},transformReply:void 0}});var gV=w((kV)=>{Object.defineProperty(kV,"__esModule",{value:!0});kV.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("XINFO","CONSUMERS"),$.pushKey(J),$.push(Q)},transformReply:{2:($)=>{return $.map((J)=>{let Q=J;return{name:Q[1],pending:Q[3],idle:Q[5],inactive:Q[7]}})},3:void 0}}});var yV=w((RV)=>{Object.defineProperty(RV,"__esModule",{value:!0});RV.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("XINFO","GROUPS"),$.pushKey(J)},transformReply:{2:($)=>{return $.map((J)=>{let Q=J;return{name:Q[1],consumers:Q[3],pending:Q[5],"last-delivered-id":Q[7],"entries-read":Q[9],lag:Q[11]}})},3:void 0}}});var cV=w((_V)=>{Object.defineProperty(_V,"__esModule",{value:!0});var uV=X();_V.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("XINFO","STREAM"),$.pushKey(J)},transformReply:{2($){let J={};for(let Q=0;Q<$.length;Q+=2)switch($[Q]){case"first-entry":case"last-entry":J[$[Q]]=_0($[Q+1]);break;default:J[$[Q]]=$[Q+1];break}return J},3($){if($ instanceof Map)$.set("first-entry",_0($.get("first-entry"))),$.set("last-entry",_0($.get("last-entry")));else if($ instanceof Array)$[17]=_0($[17]),$[19]=_0($[19]);else $["first-entry"]=_0($["first-entry"]),$["last-entry"]=_0($["last-entry"]);return $}}};function _0($){if((0,uV.isNullReply)($))return $;let[J,Q]=$;return{id:J,message:(0,uV.transformTuplesReply)(Q)}}});var lV=w((dV)=>{Object.defineProperty(dV,"__esModule",{value:!0});dV.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("XLEN"),$.pushKey(J)},transformReply:void 0}});var iV=w((mV)=>{Object.defineProperty(mV,"__esModule",{value:!0});mV.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z,q,Z,W){if($.push("XPENDING"),$.pushKey(J),$.push(Q),W?.IDLE!==void 0)$.push("IDLE",W.IDLE.toString());if($.push(z,q,Z.toString()),W?.consumer)$.push(W.consumer)},transformReply($){return $.map((J)=>{let Q=J;return{id:Q[0],consumer:Q[1],millisecondsSinceLastDelivery:Q[2],deliveriesCounter:Q[3]}})}}});var tV=w((nV)=>{Object.defineProperty(nV,"__esModule",{value:!0});nV.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("XPENDING"),$.pushKey(J),$.push(Q)},transformReply($){let J=$[3];return{pending:$[0],firstId:$[1],lastId:$[2],consumers:J===null?null:J.map((Q)=>{let[z,q]=Q;return{name:z,deliveriesCounter:Number(q)}})}}}});var U5=w((oV)=>{Object.defineProperty(oV,"__esModule",{value:!0});oV.xRangeArguments=void 0;var Dk=X();function aV($,J,Q){let z=[$,J];if(Q?.COUNT)z.push("COUNT",Q.COUNT.toString());return z}oV.xRangeArguments=aV;oV.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,...Q){$.push("XRANGE"),$.pushKey(J),$.pushVariadic(aV(Q[0],Q[1],Q[2]))},transformReply($,J,Q){return $.map(Dk.transformStreamMessageReply.bind(void 0,Q))}}});var h5=w((rV)=>{Object.defineProperty(rV,"__esModule",{value:!0});rV.pushXReadStreams=void 0;var xk=X();function sV($,J){if($.push("STREAMS"),Array.isArray(J)){for(let Q=0;Q<J.length;Q++)$.pushKey(J[Q].key);for(let Q=0;Q<J.length;Q++)$.push(J[Q].id)}else $.pushKey(J.key),$.push(J.id)}rV.pushXReadStreams=sV;rV.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("XREAD"),Q?.COUNT)$.push("COUNT",Q.COUNT.toString());if(Q?.BLOCK!==void 0)$.push("BLOCK",Q.BLOCK.toString());sV($,J)},transformReply:{2:xk.transformStreamsMessagesReplyResp2,3:void 0},unstableResp3:!0}});var JY=w(($Y)=>{Object.defineProperty($Y,"__esModule",{value:!0});var Tk=h5(),Lk=X();$Y.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("XREADGROUP","GROUP",J,Q),q?.COUNT!==void 0)$.push("COUNT",q.COUNT.toString());if(q?.BLOCK!==void 0)$.push("BLOCK",q.BLOCK.toString());if(q?.NOACK)$.push("NOACK");(0,Tk.pushXReadStreams)($,z)},transformReply:{2:Lk.transformStreamsMessagesReplyResp2,3:void 0},unstableResp3:!0}});var QY=w((B0)=>{var Mk=B0&&B0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Sk=B0&&B0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Ek=B0&&B0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Mk(J,$,Q)}return Sk(J,$),J};Object.defineProperty(B0,"__esModule",{value:!0});var Z7=Ek(U5());B0.default={CACHEABLE:Z7.default.CACHEABLE,IS_READ_ONLY:Z7.default.IS_READ_ONLY,parseCommand($,J,...Q){$.push("XREVRANGE"),$.pushKey(J),$.pushVariadic((0,Z7.xRangeArguments)(Q[0],Q[1],Q[2]))},transformReply:Z7.default.transformReply}});var qY=w((zY)=>{Object.defineProperty(zY,"__esModule",{value:!0});zY.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("XSETID"),$.pushKey(J),$.push(Q),z?.ENTRIESADDED)$.push("ENTRIESADDED",z.ENTRIESADDED.toString());if(z?.MAXDELETEDID)$.push("MAXDELETEDID",z.MAXDELETEDID)},transformReply:void 0}});var ZY=w((wY)=>{Object.defineProperty(wY,"__esModule",{value:!0});wY.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){if($.push("XTRIM"),$.pushKey(J),$.push(Q),q?.strategyModifier)$.push(q.strategyModifier);if($.push(z.toString()),q?.LIMIT)$.push("LIMIT",q.LIMIT.toString());if(q?.policy)$.push(q.policy)},transformReply:void 0}});var N5=w((YY)=>{Object.defineProperty(YY,"__esModule",{value:!0});YY.pushMembers=void 0;var WY=X();YY.default={parseCommand($,J,Q,z){if($.push("ZADD"),$.pushKey(J),z?.condition)$.push(z.condition);else if(z?.NX)$.push("NX");else if(z?.XX)$.push("XX");if(z?.comparison)$.push(z.comparison);else if(z?.LT)$.push("LT");else if(z?.GT)$.push("GT");if(z?.CH)$.push("CH");VY($,Q)},transformReply:WY.transformDoubleReply};function VY($,J){if(Array.isArray(J))for(let Q of J)KY($,Q);else KY($,J)}YY.pushMembers=VY;function KY($,J){$.push((0,WY.transformDoubleArgument)(J.score),J.value)}});var HY=w((FY)=>{Object.defineProperty(FY,"__esModule",{value:!0});var yk=N5(),uk=X();FY.default={parseCommand($,J,Q,z){if($.push("ZADD"),$.pushKey(J),z?.condition)$.push(z.condition);if(z?.comparison)$.push(z.comparison);if(z?.CH)$.push("CH");$.push("INCR"),(0,yk.pushMembers)($,Q)},transformReply:uk.transformNullableDoubleReply}});var jY=w((BY)=>{Object.defineProperty(BY,"__esModule",{value:!0});BY.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("ZCARD"),$.pushKey(J)},transformReply:void 0}});var PY=w((GY)=>{Object.defineProperty(GY,"__esModule",{value:!0});var vY=X();GY.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("ZCOUNT"),$.pushKey(J),$.push((0,vY.transformStringDoubleArgument)(Q),(0,vY.transformStringDoubleArgument)(z))},transformReply:void 0}});var I5=w((bY)=>{Object.defineProperty(bY,"__esModule",{value:!0});bY.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("ZDIFF"),$.pushKeysLength(J)},transformReply:void 0}});var hY=w((a$)=>{var mk=a$&&a$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(a$,"__esModule",{value:!0});var ik=X(),UY=mk(I5());a$.default={IS_READ_ONLY:UY.default.IS_READ_ONLY,parseCommand($,J){UY.default.parseCommand($,J),$.push("WITHSCORES")},transformReply:ik.transformSortedSetReply}});var IY=w((NY)=>{Object.defineProperty(NY,"__esModule",{value:!0});NY.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("ZDIFFSTORE"),$.pushKey(J),$.pushKeysLength(Q)},transformReply:void 0}});var AY=w((DY)=>{Object.defineProperty(DY,"__esModule",{value:!0});var OY=X();DY.default={parseCommand($,J,Q,z){$.push("ZINCRBY"),$.pushKey(J),$.push((0,OY.transformDoubleArgument)(Q),z)},transformReply:OY.transformDoubleReply}});var K7=w((CY)=>{Object.defineProperty(CY,"__esModule",{value:!0});CY.parseZInterArguments=void 0;var ak=X();function xY($,J,Q){if((0,ak.parseZKeysArguments)($,J),Q?.AGGREGATE)$.push("AGGREGATE",Q.AGGREGATE)}CY.parseZInterArguments=xY;CY.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("ZINTER"),xY($,J,Q)},transformReply:void 0}});var fY=w((o$)=>{var pk=o$&&o$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(o$,"__esModule",{value:!0});var sk=X(),LY=pk(K7());o$.default={IS_READ_ONLY:LY.default.IS_READ_ONLY,parseCommand(...$){LY.default.parseCommand(...$),$[0].push("WITHSCORES")},transformReply:sk.transformSortedSetReply}});var SY=w((MY)=>{Object.defineProperty(MY,"__esModule",{value:!0});MY.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("ZINTERCARD"),$.pushKeysLength(J),typeof Q==="number")$.push("LIMIT",Q.toString());else if(Q?.LIMIT)$.push("LIMIT",Q.LIMIT.toString())},transformReply:void 0}});var kY=w((EY)=>{Object.defineProperty(EY,"__esModule",{value:!0});var ek=K7();EY.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("ZINTERSTORE"),$.pushKey(J),(0,ek.parseZInterArguments)($,Q,z)},transformReply:void 0}});var RY=w((gY)=>{Object.defineProperty(gY,"__esModule",{value:!0});gY.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("ZLEXCOUNT"),$.pushKey(J),$.push(Q),$.push(z)},transformReply:void 0}});var uY=w((yY)=>{Object.defineProperty(yY,"__esModule",{value:!0});var Qg=X();yY.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("ZMSCORE"),$.pushKey(J),$.pushVariadic(Q)},transformReply:{2:($,J,Q)=>{return $.map((0,Qg.createTransformNullableDoubleReplyResp2Func)(J,Q))},3:void 0}}});var cY=w((_Y)=>{Object.defineProperty(_Y,"__esModule",{value:!0});var qg=X();_Y.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("ZPOPMAX"),$.pushKey(J),$.push(Q.toString())},transformReply:qg.transformSortedSetReply}});var O5=w((dY)=>{Object.defineProperty(dY,"__esModule",{value:!0});var Zg=X();dY.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("ZPOPMAX"),$.pushKey(J)},transformReply:{2:($,J,Q)=>{if($.length===0)return null;return{value:$[0],score:Zg.transformDoubleReply[2]($[1],J,Q)}},3:($)=>{if($.length===0)return null;return{value:$[0],score:$[1]}}}}});var mY=w((lY)=>{Object.defineProperty(lY,"__esModule",{value:!0});var Wg=X();lY.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("ZPOPMIN"),$.pushKey(J),$.push(Q.toString())},transformReply:Wg.transformSortedSetReply}});var iY=w((p$)=>{var Yg=p$&&p$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(p$,"__esModule",{value:!0});var Xg=Yg(O5());p$.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("ZPOPMIN"),$.pushKey(J)},transformReply:Xg.default.transformReply}});var D5=w((nY)=>{Object.defineProperty(nY,"__esModule",{value:!0});nY.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("ZRANDMEMBER"),$.pushKey(J)},transformReply:void 0}});var A5=w((s$)=>{var Hg=s$&&s$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(s$,"__esModule",{value:!0});var tY=Hg(D5());s$.default={IS_READ_ONLY:tY.default.IS_READ_ONLY,parseCommand($,J,Q){tY.default.parseCommand($,J),$.push(Q.toString())},transformReply:void 0}});var oY=w((r$)=>{var Bg=r$&&r$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(r$,"__esModule",{value:!0});var jg=X(),aY=Bg(A5());r$.default={IS_READ_ONLY:aY.default.IS_READ_ONLY,parseCommand($,J,Q){aY.default.parseCommand($,J,Q),$.push("WITHSCORES")},transformReply:jg.transformSortedSetReply}});var x5=w((rY)=>{Object.defineProperty(rY,"__esModule",{value:!0});rY.zRangeArgument=void 0;var pY=X();function sY($,J,Q){let z=[(0,pY.transformStringDoubleArgument)($),(0,pY.transformStringDoubleArgument)(J)];switch(Q?.BY){case"SCORE":z.push("BYSCORE");break;case"LEX":z.push("BYLEX");break}if(Q?.REV)z.push("REV");if(Q?.LIMIT)z.push("LIMIT",Q.LIMIT.offset.toString(),Q.LIMIT.count.toString());return z}rY.zRangeArgument=sY;rY.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){$.push("ZRANGE"),$.pushKey(J),$.pushVariadic(sY(Q,z,q))},transformReply:void 0}});var $X=w((e$)=>{var Gg=e$&&e$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(e$,"__esModule",{value:!0});var Pg=X(),C5=Gg(x5());e$.default={CACHEABLE:C5.default.CACHEABLE,IS_READ_ONLY:C5.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];C5.default.parseCommand(...$),J.push("WITHSCORES")},transformReply:Pg.transformSortedSetReply}});var zX=w((QX)=>{Object.defineProperty(QX,"__esModule",{value:!0});var JX=X();QX.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("ZRANGEBYLEX"),$.pushKey(J),$.push((0,JX.transformStringDoubleArgument)(Q),(0,JX.transformStringDoubleArgument)(z)),q?.LIMIT)$.push("LIMIT",q.LIMIT.offset.toString(),q.LIMIT.count.toString())},transformReply:void 0}});var T5=w((wX)=>{Object.defineProperty(wX,"__esModule",{value:!0});var qX=X();wX.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("ZRANGEBYSCORE"),$.pushKey(J),$.push((0,qX.transformStringDoubleArgument)(Q),(0,qX.transformStringDoubleArgument)(z)),q?.LIMIT)$.push("LIMIT",q.LIMIT.offset.toString(),q.LIMIT.count.toString())},transformReply:void 0}});var ZX=w(($6)=>{var hg=$6&&$6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty($6,"__esModule",{value:!0});var Ng=X(),L5=hg(T5());$6.default={CACHEABLE:L5.default.CACHEABLE,IS_READ_ONLY:L5.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];L5.default.parseCommand(...$),J.push("WITHSCORES")},transformReply:Ng.transformSortedSetReply}});var VX=w((WX)=>{Object.defineProperty(WX,"__esModule",{value:!0});var KX=X();WX.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,Z){switch($.push("ZRANGESTORE"),$.pushKey(J),$.pushKey(Q),$.push((0,KX.transformStringDoubleArgument)(z),(0,KX.transformStringDoubleArgument)(q)),Z?.BY){case"SCORE":$.push("BYSCORE");break;case"LEX":$.push("BYLEX");break}if(Z?.REV)$.push("REV");if(Z?.LIMIT)$.push("LIMIT",Z.LIMIT.offset.toString(),Z.LIMIT.count.toString())},transformReply:void 0}});var FX=w((XX)=>{Object.defineProperty(XX,"__esModule",{value:!0});var YX=X();XX.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("ZREMRANGEBYSCORE"),$.pushKey(J),$.push((0,YX.transformStringDoubleArgument)(Q),(0,YX.transformStringDoubleArgument)(z))},transformReply:void 0}});var f5=w((HX)=>{Object.defineProperty(HX,"__esModule",{value:!0});HX.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("ZRANK"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var BX=w((J6)=>{var Ag=J6&&J6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(J6,"__esModule",{value:!0});var M5=Ag(f5());J6.default={CACHEABLE:M5.default.CACHEABLE,IS_READ_ONLY:M5.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];M5.default.parseCommand(...$),J.push("WITHSCORE")},transformReply:{2:($)=>{if($===null)return null;return{rank:$[0],score:Number($[1])}},3:($)=>{if($===null)return null;return{rank:$[0],score:$[1]}}}}});var vX=w((jX)=>{Object.defineProperty(jX,"__esModule",{value:!0});jX.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("ZREM"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var bX=w((PX)=>{Object.defineProperty(PX,"__esModule",{value:!0});var GX=X();PX.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("ZREMRANGEBYLEX"),$.pushKey(J),$.push((0,GX.transformStringDoubleArgument)(Q),(0,GX.transformStringDoubleArgument)(z))},transformReply:void 0}});var hX=w((UX)=>{Object.defineProperty(UX,"__esModule",{value:!0});UX.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("ZREMRANGEBYRANK"),$.pushKey(J),$.push(Q.toString(),z.toString())},transformReply:void 0}});var IX=w((NX)=>{Object.defineProperty(NX,"__esModule",{value:!0});NX.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("ZREVRANK"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var DX=w((OX)=>{Object.defineProperty(OX,"__esModule",{value:!0});var fg=g$(),Mg=X();OX.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("ZSCAN"),$.pushKey(J),(0,fg.parseScanArguments)($,Q,z)},transformReply([$,J]){return{cursor:$,members:Mg.transformSortedSetReply[2](J)}}}});var xX=w((AX)=>{Object.defineProperty(AX,"__esModule",{value:!0});var Eg=X();AX.default={CACHEABLE:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("ZSCORE"),$.pushKey(J),$.push(Q)},transformReply:Eg.transformNullableDoubleReply}});var S5=w((CX)=>{Object.defineProperty(CX,"__esModule",{value:!0});var gg=X();CX.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("ZUNION"),(0,gg.parseZKeysArguments)($,J),Q?.AGGREGATE)$.push("AGGREGATE",Q.AGGREGATE)},transformReply:void 0}});var LX=w((Q6)=>{var yg=Q6&&Q6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(Q6,"__esModule",{value:!0});var ug=X(),TX=yg(S5());Q6.default={IS_READ_ONLY:TX.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];TX.default.parseCommand(...$),J.push("WITHSCORES")},transformReply:ug.transformSortedSetReply}});var MX=w((fX)=>{Object.defineProperty(fX,"__esModule",{value:!0});var _g=X();fX.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("ZUNIONSTORE"),$.pushKey(J),(0,_g.parseZKeysArguments)($,Q),z?.AGGREGATE)$.push("AGGREGATE",z.AGGREGATE)},transformReply:void 0}});var kX=w((EX)=>{Object.defineProperty(EX,"__esModule",{value:!0});var SX=X();EX.default={parseCommand($,J,Q,z,q){if($.push("VADD"),$.pushKey(J),q?.REDUCE!==void 0)$.push("REDUCE",q.REDUCE.toString());$.push("VALUES",Q.length.toString());for(let Z of Q)$.push((0,SX.transformDoubleArgument)(Z));if($.push(z),q?.CAS)$.push("CAS");if(q?.QUANT&&$.push(q.QUANT),q?.EF!==void 0)$.push("EF",q.EF.toString());if(q?.SETATTR)$.push("SETATTR",JSON.stringify(q.SETATTR));if(q?.M!==void 0)$.push("M",q.M.toString())},transformReply:SX.transformBooleanReply}});var RX=w((gX)=>{Object.defineProperty(gX,"__esModule",{value:!0});gX.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("VCARD"),$.pushKey(J)},transformReply:void 0}});var uX=w((yX)=>{Object.defineProperty(yX,"__esModule",{value:!0});yX.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("VDIM"),$.pushKey(J)},transformReply:void 0}});var E5=w((_X)=>{Object.defineProperty(_X,"__esModule",{value:!0});var ig=X();_X.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("VEMB"),$.pushKey(J),$.push(Q)},transformReply:ig.transformDoubleArrayReply}});var dX=w((z6)=>{var tg=z6&&z6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(z6,"__esModule",{value:!0});var cX=X(),ag=tg(E5()),og={2:($)=>{return{quantization:$[0],raw:$[1],l2Norm:cX.transformDoubleReply[2]($[2]),...$[3]!==void 0&&{quantizationRange:cX.transformDoubleReply[2]($[3])}}},3:($)=>{return{quantization:$[0],raw:$[1],l2Norm:$[2],quantizationRange:$[3]}}};z6.default={IS_READ_ONLY:!0,parseCommand($,J,Q){ag.default.parseCommand($,J,Q),$.push("RAW")},transformReply:og}});var mX=w((lX)=>{Object.defineProperty(lX,"__esModule",{value:!0});var pg=X();lX.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("VGETATTR"),$.pushKey(J),$.push(Q)},transformReply:pg.transformRedisJsonNullReply}});var nX=w((iX)=>{Object.defineProperty(iX,"__esModule",{value:!0});iX.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("VINFO"),$.pushKey(J)},transformReply:{2:($)=>{let J=Object.create(null);for(let Q=0;Q<$.length;Q+=2)J[$[Q].toString()]=$[Q+1];return J},3:void 0}}});var k5=w((tX)=>{Object.defineProperty(tX,"__esModule",{value:!0});tX.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("VLINKS"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var oX=w((q6)=>{var $R=q6&&q6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(q6,"__esModule",{value:!0});var JR=X(),aX=$R(k5());function QR($){let J=[];for(let Q of $){let z=Object.create(null);for(let q=0;q<Q.length;q+=2){let Z=Q[q],W=JR.transformDoubleReply[2](Q[q+1]);z[Z.toString()]=W}J.push(z)}return J}q6.default={IS_READ_ONLY:aX.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];aX.default.parseCommand(...$),J.push("WITHSCORES")},transformReply:{2:QR,3:void 0}}});var sX=w((pX)=>{Object.defineProperty(pX,"__esModule",{value:!0});pX.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("VRANDMEMBER"),$.pushKey(J),Q!==void 0)$.push(Q.toString())},transformReply:void 0}});var eX=w((rX)=>{Object.defineProperty(rX,"__esModule",{value:!0});var qR=X();rX.default={parseCommand($,J,Q){$.push("VREM"),$.pushKey(J),$.push(Q)},transformReply:qR.transformBooleanReply}});var JF=w(($F)=>{Object.defineProperty($F,"__esModule",{value:!0});var ZR=X();$F.default={parseCommand($,J,Q,z){if($.push("VSETATTR"),$.pushKey(J),$.push(Q),typeof z==="object"&&z!==null)$.push(JSON.stringify(z));else $.push(z)},transformReply:ZR.transformBooleanReply}});var g5=w((QF)=>{Object.defineProperty(QF,"__esModule",{value:!0});var WR=X();QF.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("VSIM"),$.pushKey(J),Array.isArray(Q)){$.push("VALUES",Q.length.toString());for(let q of Q)$.push((0,WR.transformDoubleArgument)(q))}else $.push("ELE",Q);if(z?.COUNT!==void 0)$.push("COUNT",z.COUNT.toString());if(z?.EPSILON!==void 0)$.push("EPSILON",z.EPSILON.toString());if(z?.EF!==void 0)$.push("EF",z.EF.toString());if(z?.FILTER)$.push("FILTER",z.FILTER);if(z?.["FILTER-EF"]!==void 0)$.push("FILTER-EF",z["FILTER-EF"].toString());if(z?.TRUTH)$.push("TRUTH");if(z?.NOTHREAD)$.push("NOTHREAD")},transformReply:void 0}});var qF=w((w6)=>{var YR=w6&&w6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(w6,"__esModule",{value:!0});var XR=X(),zF=YR(g5());w6.default={IS_READ_ONLY:zF.default.IS_READ_ONLY,parseCommand(...$){let J=$[0];zF.default.parseCommand(...$),J.push("WITHSCORES")},transformReply:{2:($)=>{let J=$,Q={};for(let z=0;z<J.length;z+=2)Q[J[z].toString()]=XR.transformDoubleReply[2](J[z+1]);return Q},3:void 0}}});var i=w((O)=>{var FR=O&&O.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),HR=O&&O.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Z6=O&&O.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))FR(J,$,Q)}return HR(J,$),J},K=O&&O.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(O,"__esModule",{value:!0});O.REDIS_FLUSH_MODES=O.COMMAND_LIST_FILTER_BY=O.CLUSTER_SLOT_STATES=O.FAILOVER_MODES=O.CLIENT_KILL_FILTERS=void 0;var wF=K(D4()),ZF=K(x4()),KF=K(T4()),WF=K(f4()),VF=K(S4()),YF=K(k4()),XF=K(R4()),FF=K(e4()),HF=K(o7()),BF=K(J1()),jF=K(z1()),vF=K(w1()),GF=K(K1()),PF=K(V1()),bF=K(s7()),UF=K(F1()),hF=K(B1()),NF=K(v1()),IF=K(P1()),OF=K(U1()),DF=K(N1()),AF=K(O1()),xF=K(A1()),CF=K(C1()),TF=K(S1()),LF=K(e7()),fF=K(k1()),MF=K(R1()),SF=K(l1()),EF=K(J5()),kF=K(n1()),gF=K(a1()),RF=K(p1()),yF=K(r1()),uF=K($9()),_F=K(Q5()),R5=Z6(q9());Object.defineProperty(O,"CLIENT_KILL_FILTERS",{enumerable:!0,get:function(){return R5.CLIENT_KILL_FILTERS}});var cF=K(w9()),dF=K(K9()),lF=K(V9()),mF=K(X9()),iF=K(H9()),nF=K(j9()),tF=K(G9()),aF=K(b9()),oF=K(h9()),pF=K(I9()),sF=K(D9()),rF=K(x9()),eF=K(T9()),$3=K(f9()),J3=K(S9()),y5=Z6(g9());Object.defineProperty(O,"FAILOVER_MODES",{enumerable:!0,get:function(){return y5.FAILOVER_MODES}});var Q3=K(y9()),z3=K(_9()),q3=K(d9()),w3=K(m9()),Z3=K(n9()),K3=K(a9()),W3=K(p9()),V3=K(r9()),Y3=K($J()),X3=K(QJ()),F3=K(qJ()),H3=K(ZJ()),B3=K(WJ()),j3=K(YJ()),v3=K(FJ()),u5=Z6(jJ());Object.defineProperty(O,"CLUSTER_SLOT_STATES",{enumerable:!0,get:function(){return u5.CLUSTER_SLOT_STATES}});var G3=K(PJ()),P3=K(UJ()),b3=K(NJ()),U3=K(OJ()),h3=K(AJ()),_5=Z6(TJ());Object.defineProperty(O,"COMMAND_LIST_FILTER_BY",{enumerable:!0,get:function(){return _5.COMMAND_LIST_FILTER_BY}});var N3=K(fJ()),I3=K(SJ()),O3=K(kJ()),D3=K(RJ()),A3=K(uJ()),x3=K(cJ()),C3=K(lJ()),T3=K(iJ()),L3=K(tJ()),f3=K(oJ()),M3=K(sJ()),S3=K(eJ()),E3=K(qQ()),k3=K(g0()),g3=K(ZQ()),R3=K(WQ()),y3=K(XQ()),u3=K(HQ()),_3=K(jQ()),c3=K(GQ()),d3=K(CQ()),l3=K(LQ()),m3=K(MQ()),i3=K(z7()),n3=K(f$()),t3=K(uQ()),a3=K(cQ()),o3=K(lQ()),p3=K(z5()),s3=K(E$()),r3=K(M$()),e3=K(R0()),$H=K(iQ()),JH=K(tQ()),QH=K(oQ()),zH=K(sQ()),qH=K(eQ()),wH=K(Jz()),ZH=K(zz()),KH=K(wz()),WH=K(Kz()),VH=K(Vz()),YH=K(Xz()),c5=Z6(Bz());Object.defineProperty(O,"REDIS_FLUSH_MODES",{enumerable:!0,get:function(){return c5.REDIS_FLUSH_MODES}});var XH=K(vz()),FH=K(Pz()),HH=K(Uz()),BH=K(Nz()),jH=K(Oz()),vH=K(Az()),GH=K(Cz()),PH=K(Lz()),bH=K(w5()),UH=K(Mz()),hH=K(Ez()),NH=K(gz()),IH=K(yz()),OH=K(K5()),DH=K(cz()),AH=K(mz()),xH=K(nz()),CH=K(oz()),TH=K(sz()),LH=K(ez()),fH=K(Jq()),MH=K(zq()),SH=K(wq()),EH=K(Kq()),kH=K(Vq()),gH=K(Xq()),RH=K(Hq()),yH=K(jq()),uH=K(Gq()),_H=K(bq()),cH=K(hq()),dH=K(Iq()),lH=K(Dq()),mH=K(xq()),iH=K(Tq()),nH=K(W5()),tH=K(Eq()),aH=K(Rq()),oH=K(_q()),pH=K(dq()),sH=K(mq()),rH=K(nq()),eH=K(aq()),$B=K(pq()),JB=K(rq()),QB=K($w()),zB=K(Qw()),qB=K(qw()),wB=K(Zw()),ZB=K(Ww()),KB=K(V5()),WB=K(Fw()),VB=K(Bw()),YB=K(jw()),XB=K(bw()),FB=K(X5()),HB=K(hw()),BB=K(q7()),jB=K(Iw()),vB=K(Dw()),GB=K(xw()),PB=K(Tw()),bB=K(r7()),BR=K(fw()),UB=K(Sw()),hB=K(F5()),NB=K(kw()),IB=K(H5()),OB=K(Rw()),DB=K(uw()),AB=K(cw()),xB=K(lw()),CB=K(iw()),TB=K(tw()),LB=K(ow()),fB=K(sw()),MB=K(ew()),SB=K(JZ()),EB=K(zZ()),kB=K(wZ()),gB=K(KZ()),RB=K(VZ()),yB=K(XZ()),uB=K(HZ()),_B=K(jZ()),cB=K(j5()),dB=K(UZ()),lB=K(NZ()),mB=K(OZ()),iB=K(AZ()),nB=K(CZ()),tB=K(LZ()),aB=K(MZ()),oB=K(EZ()),pB=K(gZ()),sB=K(yZ()),rB=K(_Z()),eB=K(dZ()),$j=K(mZ()),Jj=K(nZ()),Qj=K(aZ()),zj=K(pZ()),qj=K(rZ()),wj=K($K()),Zj=K(QK()),Kj=K(qK()),Wj=K(ZK()),Vj=K(WK()),Yj=K(YK()),Xj=K(FK()),Fj=K(BK()),Hj=K(vK()),Bj=K(PK()),jj=K(UK()),vj=K(NK()),Gj=K(OK()),Pj=K(AK()),bj=K(CK()),Uj=K(LK()),hj=K(MK()),Nj=K(EK()),Ij=K(g$()),Oj=K(gK()),Dj=K(yK()),Aj=K(_K()),xj=K(dK()),Cj=K(mK()),Tj=K(nK()),Lj=K(aK()),fj=K(pK()),Mj=K(rK()),Sj=K($W()),Ej=K(QW()),kj=K(qW()),gj=K(ZW()),Rj=K(WW()),yj=K(YW()),uj=K(FW()),_j=K(BW()),cj=K(vW()),dj=K(PW()),lj=K(UW()),mj=K(DW()),ij=K(AW()),nj=K(w7()),tj=K(CW()),aj=K(LW()),oj=K(MW()),pj=K(kW()),sj=K(v5()),rj=K(RW()),ej=K(uW()),$v=K(cW()),Jv=K(lW()),Qv=K(iW()),zv=K(tW()),qv=K(oW()),wv=K(sW()),Zv=K(eW()),Kv=K(JV()),Wv=K(zV()),Vv=K(wV()),Yv=K(KV()),Xv=K(VV()),Fv=K(BV()),Hv=K(G5()),Bv=K(GV()),jv=K(P5()),vv=K(UV()),Gv=K(b5()),Pv=K(NV()),bv=K(OV()),Uv=K(AV()),hv=K(CV()),Nv=K(LV()),Iv=K(MV()),Ov=K(EV()),Dv=K(gV()),Av=K(yV()),xv=K(cV()),Cv=K(lV()),Tv=K(iV()),Lv=K(tV()),fv=K(U5()),Mv=K(h5()),Sv=K(JY()),Ev=K(QY()),kv=K(qY()),gv=K(ZY()),Rv=K(HY()),yv=K(N5()),uv=K(jY()),_v=K(PY()),cv=K(hY()),dv=K(I5()),lv=K(IY()),mv=K(AY()),iv=K(fY()),nv=K(K7()),tv=K(SY()),av=K(kY()),ov=K(RY()),pv=K($5()),sv=K(uY()),rv=K(cY()),ev=K(O5()),$G=K(mY()),JG=K(iY()),QG=K(oY()),zG=K(A5()),qG=K(D5()),wG=K($X()),ZG=K(x5()),KG=K(zX()),WG=K(ZX()),VG=K(T5()),YG=K(VX()),XG=K(FX()),FG=K(BX()),HG=K(f5()),BG=K(vX()),jG=K(bX()),vG=K(hX()),GG=K(IX()),PG=K(DX()),bG=K(xX()),UG=K(LX()),hG=K(S5()),NG=K(MX()),IG=K(kX()),OG=K(RX()),DG=K(uX()),AG=K(E5()),xG=K(dX()),CG=K(mX()),TG=K(nX()),LG=K(k5()),fG=K(oX()),MG=K(sX()),SG=K(eX()),EG=K(JF()),kG=K(g5()),gG=K(qF());O.default={ACL_CAT:wF.default,aclCat:wF.default,ACL_DELUSER:ZF.default,aclDelUser:ZF.default,ACL_DRYRUN:KF.default,aclDryRun:KF.default,ACL_GENPASS:WF.default,aclGenPass:WF.default,ACL_GETUSER:VF.default,aclGetUser:VF.default,ACL_LIST:YF.default,aclList:YF.default,ACL_LOAD:XF.default,aclLoad:XF.default,ACL_LOG_RESET:FF.default,aclLogReset:FF.default,ACL_LOG:HF.default,aclLog:HF.default,ACL_SAVE:BF.default,aclSave:BF.default,ACL_SETUSER:jF.default,aclSetUser:jF.default,ACL_USERS:vF.default,aclUsers:vF.default,ACL_WHOAMI:GF.default,aclWhoAmI:GF.default,APPEND:PF.default,append:PF.default,ASKING:bF.default,asking:bF.default,AUTH:UF.default,auth:UF.default,BGREWRITEAOF:hF.default,bgRewriteAof:hF.default,BGSAVE:NF.default,bgSave:NF.default,BITCOUNT:IF.default,bitCount:IF.default,BITFIELD_RO:OF.default,bitFieldRo:OF.default,BITFIELD:DF.default,bitField:DF.default,BITOP:AF.default,bitOp:AF.default,BITPOS:xF.default,bitPos:xF.default,BLMOVE:CF.default,blMove:CF.default,BLMPOP:TF.default,blmPop:TF.default,BLPOP:LF.default,blPop:LF.default,BRPOP:fF.default,brPop:fF.default,BRPOPLPUSH:MF.default,brPopLPush:MF.default,BZMPOP:SF.default,bzmPop:SF.default,BZPOPMAX:EF.default,bzPopMax:EF.default,BZPOPMIN:kF.default,bzPopMin:kF.default,CLIENT_CACHING:gF.default,clientCaching:gF.default,CLIENT_GETNAME:RF.default,clientGetName:RF.default,CLIENT_GETREDIR:yF.default,clientGetRedir:yF.default,CLIENT_ID:uF.default,clientId:uF.default,CLIENT_INFO:_F.default,clientInfo:_F.default,CLIENT_KILL:R5.default,clientKill:R5.default,CLIENT_LIST:cF.default,clientList:cF.default,"CLIENT_NO-EVICT":dF.default,clientNoEvict:dF.default,"CLIENT_NO-TOUCH":lF.default,clientNoTouch:lF.default,CLIENT_PAUSE:mF.default,clientPause:mF.default,CLIENT_SETNAME:iF.default,clientSetName:iF.default,CLIENT_TRACKING:nF.default,clientTracking:nF.default,CLIENT_TRACKINGINFO:tF.default,clientTrackingInfo:tF.default,CLIENT_UNPAUSE:aF.default,clientUnpause:aF.default,CLUSTER_ADDSLOTS:oF.default,clusterAddSlots:oF.default,CLUSTER_ADDSLOTSRANGE:pF.default,clusterAddSlotsRange:pF.default,CLUSTER_BUMPEPOCH:sF.default,clusterBumpEpoch:sF.default,"CLUSTER_COUNT-FAILURE-REPORTS":rF.default,clusterCountFailureReports:rF.default,CLUSTER_COUNTKEYSINSLOT:eF.default,clusterCountKeysInSlot:eF.default,CLUSTER_DELSLOTS:$3.default,clusterDelSlots:$3.default,CLUSTER_DELSLOTSRANGE:J3.default,clusterDelSlotsRange:J3.default,CLUSTER_FAILOVER:y5.default,clusterFailover:y5.default,CLUSTER_FLUSHSLOTS:Q3.default,clusterFlushSlots:Q3.default,CLUSTER_FORGET:z3.default,clusterForget:z3.default,CLUSTER_GETKEYSINSLOT:q3.default,clusterGetKeysInSlot:q3.default,CLUSTER_INFO:w3.default,clusterInfo:w3.default,CLUSTER_KEYSLOT:Z3.default,clusterKeySlot:Z3.default,CLUSTER_LINKS:K3.default,clusterLinks:K3.default,CLUSTER_MEET:W3.default,clusterMeet:W3.default,CLUSTER_MYID:V3.default,clusterMyId:V3.default,CLUSTER_MYSHARDID:Y3.default,clusterMyShardId:Y3.default,CLUSTER_NODES:X3.default,clusterNodes:X3.default,CLUSTER_REPLICAS:F3.default,clusterReplicas:F3.default,CLUSTER_REPLICATE:H3.default,clusterReplicate:H3.default,CLUSTER_RESET:B3.default,clusterReset:B3.default,CLUSTER_SAVECONFIG:j3.default,clusterSaveConfig:j3.default,"CLUSTER_SET-CONFIG-EPOCH":v3.default,clusterSetConfigEpoch:v3.default,CLUSTER_SETSLOT:u5.default,clusterSetSlot:u5.default,CLUSTER_SLOTS:G3.default,clusterSlots:G3.default,COMMAND_COUNT:P3.default,commandCount:P3.default,COMMAND_GETKEYS:b3.default,commandGetKeys:b3.default,COMMAND_GETKEYSANDFLAGS:U3.default,commandGetKeysAndFlags:U3.default,COMMAND_INFO:h3.default,commandInfo:h3.default,COMMAND_LIST:_5.default,commandList:_5.default,COMMAND:N3.default,command:N3.default,CONFIG_GET:I3.default,configGet:I3.default,CONFIG_RESETASTAT:O3.default,configResetStat:O3.default,CONFIG_REWRITE:D3.default,configRewrite:D3.default,CONFIG_SET:A3.default,configSet:A3.default,COPY:x3.default,copy:x3.default,DBSIZE:C3.default,dbSize:C3.default,DECR:T3.default,decr:T3.default,DECRBY:L3.default,decrBy:L3.default,DEL:f3.default,del:f3.default,DUMP:M3.default,dump:M3.default,ECHO:S3.default,echo:S3.default,EVAL_RO:E3.default,evalRo:E3.default,EVAL:k3.default,eval:k3.default,EVALSHA_RO:g3.default,evalShaRo:g3.default,EVALSHA:R3.default,evalSha:R3.default,EXISTS:KH.default,exists:KH.default,EXPIRE:WH.default,expire:WH.default,EXPIREAT:VH.default,expireAt:VH.default,EXPIRETIME:YH.default,expireTime:YH.default,FLUSHALL:c5.default,flushAll:c5.default,FLUSHDB:XH.default,flushDb:XH.default,FCALL:FH.default,fCall:FH.default,FCALL_RO:HH.default,fCallRo:HH.default,FUNCTION_DELETE:BH.default,functionDelete:BH.default,FUNCTION_DUMP:jH.default,functionDump:jH.default,FUNCTION_FLUSH:vH.default,functionFlush:vH.default,FUNCTION_KILL:GH.default,functionKill:GH.default,FUNCTION_LIST_WITHCODE:PH.default,functionListWithCode:PH.default,FUNCTION_LIST:bH.default,functionList:bH.default,FUNCTION_LOAD:UH.default,functionLoad:UH.default,FUNCTION_RESTORE:hH.default,functionRestore:hH.default,FUNCTION_STATS:NH.default,functionStats:NH.default,GEOADD:y3.default,geoAdd:y3.default,GEODIST:u3.default,geoDist:u3.default,GEOHASH:_3.default,geoHash:_3.default,GEOPOS:c3.default,geoPos:c3.default,GEORADIUS_RO_WITH:d3.default,geoRadiusRoWith:d3.default,GEORADIUS_RO:l3.default,geoRadiusRo:l3.default,GEORADIUS_STORE:m3.default,geoRadiusStore:m3.default,GEORADIUS_WITH:i3.default,geoRadiusWith:i3.default,GEORADIUS:n3.default,geoRadius:n3.default,GEORADIUSBYMEMBER_RO_WITH:t3.default,geoRadiusByMemberRoWith:t3.default,GEORADIUSBYMEMBER_RO:a3.default,geoRadiusByMemberRo:a3.default,GEORADIUSBYMEMBER_STORE:o3.default,geoRadiusByMemberStore:o3.default,GEORADIUSBYMEMBER_WITH:p3.default,geoRadiusByMemberWith:p3.default,GEORADIUSBYMEMBER:s3.default,geoRadiusByMember:s3.default,GEOSEARCH_WITH:r3.default,geoSearchWith:r3.default,GEOSEARCH:e3.default,geoSearch:e3.default,GEOSEARCHSTORE:$H.default,geoSearchStore:$H.default,GET:JH.default,get:JH.default,GETBIT:QH.default,getBit:QH.default,GETDEL:zH.default,getDel:zH.default,GETEX:qH.default,getEx:qH.default,GETRANGE:wH.default,getRange:wH.default,GETSET:ZH.default,getSet:ZH.default,HDEL:IH.default,hDel:IH.default,HELLO:OH.default,hello:OH.default,HEXISTS:DH.default,hExists:DH.default,HEXPIRE:AH.default,hExpire:AH.default,HEXPIREAT:xH.default,hExpireAt:xH.default,HEXPIRETIME:CH.default,hExpireTime:CH.default,HGET:TH.default,hGet:TH.default,HGETALL:LH.default,hGetAll:LH.default,HGETDEL:fH.default,hGetDel:fH.default,HGETEX:MH.default,hGetEx:MH.default,HINCRBY:SH.default,hIncrBy:SH.default,HINCRBYFLOAT:EH.default,hIncrByFloat:EH.default,HKEYS:kH.default,hKeys:kH.default,HLEN:gH.default,hLen:gH.default,HMGET:RH.default,hmGet:RH.default,HPERSIST:yH.default,hPersist:yH.default,HPEXPIRE:uH.default,hpExpire:uH.default,HPEXPIREAT:_H.default,hpExpireAt:_H.default,HPEXPIRETIME:cH.default,hpExpireTime:cH.default,HPTTL:dH.default,hpTTL:dH.default,HRANDFIELD_COUNT_WITHVALUES:lH.default,hRandFieldCountWithValues:lH.default,HRANDFIELD_COUNT:mH.default,hRandFieldCount:mH.default,HRANDFIELD:iH.default,hRandField:iH.default,HSCAN:nH.default,hScan:nH.default,HSCAN_NOVALUES:tH.default,hScanNoValues:tH.default,HSET:aH.default,hSet:aH.default,HSETEX:oH.default,hSetEx:oH.default,HSETNX:pH.default,hSetNX:pH.default,HSTRLEN:sH.default,hStrLen:sH.default,HTTL:rH.default,hTTL:rH.default,HVALS:eH.default,hVals:eH.default,INCR:$B.default,incr:$B.default,INCRBY:JB.default,incrBy:JB.default,INCRBYFLOAT:QB.default,incrByFloat:QB.default,INFO:zB.default,info:zB.default,KEYS:qB.default,keys:qB.default,LASTSAVE:wB.default,lastSave:wB.default,LATENCY_DOCTOR:ZB.default,latencyDoctor:ZB.default,LATENCY_GRAPH:KB.default,latencyGraph:KB.default,LATENCY_HISTORY:WB.default,latencyHistory:WB.default,LATENCY_LATEST:VB.default,latencyLatest:VB.default,LATENCY_RESET:YB.default,latencyReset:YB.default,LCS_IDX_WITHMATCHLEN:XB.default,lcsIdxWithMatchLen:XB.default,LCS_IDX:FB.default,lcsIdx:FB.default,LCS_LEN:HB.default,lcsLen:HB.default,LCS:BB.default,lcs:BB.default,LINDEX:jB.default,lIndex:jB.default,LINSERT:vB.default,lInsert:vB.default,LLEN:GB.default,lLen:GB.default,LMOVE:PB.default,lMove:PB.default,LMPOP:bB.default,lmPop:bB.default,LOLWUT:BR.default,LPOP_COUNT:UB.default,lPopCount:UB.default,LPOP:hB.default,lPop:hB.default,LPOS_COUNT:NB.default,lPosCount:NB.default,LPOS:IB.default,lPos:IB.default,LPUSH:OB.default,lPush:OB.default,LPUSHX:DB.default,lPushX:DB.default,LRANGE:AB.default,lRange:AB.default,LREM:xB.default,lRem:xB.default,LSET:CB.default,lSet:CB.default,LTRIM:TB.default,lTrim:TB.default,MEMORY_DOCTOR:LB.default,memoryDoctor:LB.default,"MEMORY_MALLOC-STATS":fB.default,memoryMallocStats:fB.default,MEMORY_PURGE:MB.default,memoryPurge:MB.default,MEMORY_STATS:SB.default,memoryStats:SB.default,MEMORY_USAGE:EB.default,memoryUsage:EB.default,MGET:kB.default,mGet:kB.default,MIGRATE:gB.default,migrate:gB.default,MODULE_LIST:RB.default,moduleList:RB.default,MODULE_LOAD:yB.default,moduleLoad:yB.default,MODULE_UNLOAD:uB.default,moduleUnload:uB.default,MOVE:_B.default,move:_B.default,MSET:cB.default,mSet:cB.default,MSETNX:dB.default,mSetNX:dB.default,OBJECT_ENCODING:lB.default,objectEncoding:lB.default,OBJECT_FREQ:mB.default,objectFreq:mB.default,OBJECT_IDLETIME:iB.default,objectIdleTime:iB.default,OBJECT_REFCOUNT:nB.default,objectRefCount:nB.default,PERSIST:tB.default,persist:tB.default,PEXPIRE:aB.default,pExpire:aB.default,PEXPIREAT:oB.default,pExpireAt:oB.default,PEXPIRETIME:pB.default,pExpireTime:pB.default,PFADD:sB.default,pfAdd:sB.default,PFCOUNT:rB.default,pfCount:rB.default,PFMERGE:eB.default,pfMerge:eB.default,PING:$j.default,ping:$j.default,PSETEX:Jj.default,pSetEx:Jj.default,PTTL:Qj.default,pTTL:Qj.default,PUBLISH:zj.default,publish:zj.default,PUBSUB_CHANNELS:qj.default,pubSubChannels:qj.default,PUBSUB_NUMPAT:wj.default,pubSubNumPat:wj.default,PUBSUB_NUMSUB:Zj.default,pubSubNumSub:Zj.default,PUBSUB_SHARDNUMSUB:Kj.default,pubSubShardNumSub:Kj.default,PUBSUB_SHARDCHANNELS:Wj.default,pubSubShardChannels:Wj.default,RANDOMKEY:Vj.default,randomKey:Vj.default,READONLY:Yj.default,readonly:Yj.default,RENAME:Xj.default,rename:Xj.default,RENAMENX:Fj.default,renameNX:Fj.default,REPLICAOF:Hj.default,replicaOf:Hj.default,"RESTORE-ASKING":Bj.default,restoreAsking:Bj.default,RESTORE:jj.default,restore:jj.default,RPOP_COUNT:Gj.default,rPopCount:Gj.default,ROLE:vj.default,role:vj.default,RPOP:Pj.default,rPop:Pj.default,RPOPLPUSH:bj.default,rPopLPush:bj.default,RPUSH:Uj.default,rPush:Uj.default,RPUSHX:hj.default,rPushX:hj.default,SADD:Nj.default,sAdd:Nj.default,SCAN:Ij.default,scan:Ij.default,SCARD:Oj.default,sCard:Oj.default,SCRIPT_DEBUG:Dj.default,scriptDebug:Dj.default,SCRIPT_EXISTS:Aj.default,scriptExists:Aj.default,SCRIPT_FLUSH:xj.default,scriptFlush:xj.default,SCRIPT_KILL:Cj.default,scriptKill:Cj.default,SCRIPT_LOAD:Tj.default,scriptLoad:Tj.default,SDIFF:Lj.default,sDiff:Lj.default,SDIFFSTORE:fj.default,sDiffStore:fj.default,SET:Mj.default,set:Mj.default,SETBIT:Sj.default,setBit:Sj.default,SETEX:Ej.default,setEx:Ej.default,SETNX:kj.default,setNX:kj.default,SETRANGE:gj.default,setRange:gj.default,SINTER:Rj.default,sInter:Rj.default,SINTERCARD:yj.default,sInterCard:yj.default,SINTERSTORE:uj.default,sInterStore:uj.default,SISMEMBER:_j.default,sIsMember:_j.default,SMEMBERS:cj.default,sMembers:cj.default,SMISMEMBER:dj.default,smIsMember:dj.default,SMOVE:lj.default,sMove:lj.default,SORT_RO:mj.default,sortRo:mj.default,SORT_STORE:ij.default,sortStore:ij.default,SORT:nj.default,sort:nj.default,SPOP_COUNT:tj.default,sPopCount:tj.default,SPOP:aj.default,sPop:aj.default,SPUBLISH:oj.default,sPublish:oj.default,SRANDMEMBER_COUNT:pj.default,sRandMemberCount:pj.default,SRANDMEMBER:sj.default,sRandMember:sj.default,SREM:rj.default,sRem:rj.default,SSCAN:ej.default,sScan:ej.default,STRLEN:$v.default,strLen:$v.default,SUNION:Jv.default,sUnion:Jv.default,SUNIONSTORE:Qv.default,sUnionStore:Qv.default,SWAPDB:zv.default,swapDb:zv.default,TIME:qv.default,time:qv.default,TOUCH:wv.default,touch:wv.default,TTL:Zv.default,ttl:Zv.default,TYPE:Kv.default,type:Kv.default,UNLINK:Wv.default,unlink:Wv.default,WAIT:Vv.default,wait:Vv.default,XACK:Yv.default,xAck:Yv.default,XACKDEL:Xv.default,xAckDel:Xv.default,XADD_NOMKSTREAM:Fv.default,xAddNoMkStream:Fv.default,XADD:Hv.default,xAdd:Hv.default,XAUTOCLAIM_JUSTID:Bv.default,xAutoClaimJustId:Bv.default,XAUTOCLAIM:jv.default,xAutoClaim:jv.default,XCLAIM_JUSTID:vv.default,xClaimJustId:vv.default,XCLAIM:Gv.default,xClaim:Gv.default,XDEL:Pv.default,xDel:Pv.default,XDELEX:bv.default,xDelEx:bv.default,XGROUP_CREATE:Uv.default,xGroupCreate:Uv.default,XGROUP_CREATECONSUMER:hv.default,xGroupCreateConsumer:hv.default,XGROUP_DELCONSUMER:Nv.default,xGroupDelConsumer:Nv.default,XGROUP_DESTROY:Iv.default,xGroupDestroy:Iv.default,XGROUP_SETID:Ov.default,xGroupSetId:Ov.default,XINFO_CONSUMERS:Dv.default,xInfoConsumers:Dv.default,XINFO_GROUPS:Av.default,xInfoGroups:Av.default,XINFO_STREAM:xv.default,xInfoStream:xv.default,XLEN:Cv.default,xLen:Cv.default,XPENDING_RANGE:Tv.default,xPendingRange:Tv.default,XPENDING:Lv.default,xPending:Lv.default,XRANGE:fv.default,xRange:fv.default,XREAD:Mv.default,xRead:Mv.default,XREADGROUP:Sv.default,xReadGroup:Sv.default,XREVRANGE:Ev.default,xRevRange:Ev.default,XSETID:kv.default,xSetId:kv.default,XTRIM:gv.default,xTrim:gv.default,ZADD_INCR:Rv.default,zAddIncr:Rv.default,ZADD:yv.default,zAdd:yv.default,ZCARD:uv.default,zCard:uv.default,ZCOUNT:_v.default,zCount:_v.default,ZDIFF_WITHSCORES:cv.default,zDiffWithScores:cv.default,ZDIFF:dv.default,zDiff:dv.default,ZDIFFSTORE:lv.default,zDiffStore:lv.default,ZINCRBY:mv.default,zIncrBy:mv.default,ZINTER_WITHSCORES:iv.default,zInterWithScores:iv.default,ZINTER:nv.default,zInter:nv.default,ZINTERCARD:tv.default,zInterCard:tv.default,ZINTERSTORE:av.default,zInterStore:av.default,ZLEXCOUNT:ov.default,zLexCount:ov.default,ZMPOP:pv.default,zmPop:pv.default,ZMSCORE:sv.default,zmScore:sv.default,ZPOPMAX_COUNT:rv.default,zPopMaxCount:rv.default,ZPOPMAX:ev.default,zPopMax:ev.default,ZPOPMIN_COUNT:$G.default,zPopMinCount:$G.default,ZPOPMIN:JG.default,zPopMin:JG.default,ZRANDMEMBER_COUNT_WITHSCORES:QG.default,zRandMemberCountWithScores:QG.default,ZRANDMEMBER_COUNT:zG.default,zRandMemberCount:zG.default,ZRANDMEMBER:qG.default,zRandMember:qG.default,ZRANGE_WITHSCORES:wG.default,zRangeWithScores:wG.default,ZRANGE:ZG.default,zRange:ZG.default,ZRANGEBYLEX:KG.default,zRangeByLex:KG.default,ZRANGEBYSCORE_WITHSCORES:WG.default,zRangeByScoreWithScores:WG.default,ZRANGEBYSCORE:VG.default,zRangeByScore:VG.default,ZRANGESTORE:YG.default,zRangeStore:YG.default,ZRANK_WITHSCORE:FG.default,zRankWithScore:FG.default,ZRANK:HG.default,zRank:HG.default,ZREM:BG.default,zRem:BG.default,ZREMRANGEBYLEX:jG.default,zRemRangeByLex:jG.default,ZREMRANGEBYRANK:vG.default,zRemRangeByRank:vG.default,ZREMRANGEBYSCORE:XG.default,zRemRangeByScore:XG.default,ZREVRANK:GG.default,zRevRank:GG.default,ZSCAN:PG.default,zScan:PG.default,ZSCORE:bG.default,zScore:bG.default,ZUNION_WITHSCORES:UG.default,zUnionWithScores:UG.default,ZUNION:hG.default,zUnion:hG.default,ZUNIONSTORE:NG.default,zUnionStore:NG.default,VADD:IG.default,vAdd:IG.default,VCARD:OG.default,vCard:OG.default,VDIM:DG.default,vDim:DG.default,VEMB:AG.default,vEmb:AG.default,VEMB_RAW:xG.default,vEmbRaw:xG.default,VGETATTR:CG.default,vGetAttr:CG.default,VINFO:TG.default,vInfo:TG.default,VLINKS:LG.default,vLinks:LG.default,VLINKS_WITHSCORES:fG.default,vLinksWithScores:fG.default,VRANDMEMBER:MG.default,vRandMember:MG.default,VREM:SG.default,vRem:SG.default,VSETATTR:EG.default,vSetAttr:EG.default,VSIM:kG.default,vSim:kG.default,VSIM_WITHSCORES:gG.default,vSimWithScores:gG.default}});var W7=w((b)=>{var RG=b&&b.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(b,"__esModule",{value:!0});b.emitDiagnostics=b.dbgMaintenance=b.MAINTENANCE_EVENTS=void 0;var yG=C("net"),jR=C("dns/promises"),$$=RG(C("node:assert")),vR=C("node:timers/promises"),GR=RG(C("node:diagnostics_channel"));b.MAINTENANCE_EVENTS={PAUSE_WRITING:"pause-writing",RESUME_WRITING:"resume-writing",TIMEOUTS_UPDATE:"timeouts-update"};var K6={MOVING:"MOVING",MIGRATING:"MIGRATING",MIGRATED:"MIGRATED",FAILING_OVER:"FAILING_OVER",FAILED_OVER:"FAILED_OVER"},PR=(...$)=>{if(!process.env.REDIS_DEBUG_MAINTENANCE)return;return console.log("[MNT]",...$)};b.dbgMaintenance=PR;var bR=($)=>{if(!process.env.REDIS_EMIT_DIAGNOSTICS)return;GR.default.channel("redis.maintenance").publish($)};b.emitDiagnostics=bR;class uG{#$;#J;#Q=0;#z;static setupDefaultMaintOptions($){if($.maintNotifications===void 0)$.maintNotifications=$?.RESP===3?"auto":"disabled";if($.maintEndpointType===void 0)$.maintEndpointType="auto";if($.maintRelaxedSocketTimeout===void 0)$.maintRelaxedSocketTimeout=1e4;if($.maintRelaxedCommandTimeout===void 0)$.maintRelaxedCommandTimeout=1e4}static async getHandshakeCommand($){if($.maintNotifications==="disabled")return;let J=$.url?new URL($.url).hostname:$.socket?.host;if(!J)return;let Q=$.socket?.tls??!1;return{cmd:["CLIENT","MAINT_NOTIFICATIONS","ON","moving-endpoint-type",await hR(Q,J,$)],errorHandler:(q)=>{if((0,b.dbgMaintenance)("handshake failed:",q),$.maintNotifications==="enabled")throw q}}}constructor($,J,Q){this.#$=$,this.#J=Q,this.#z=J,this.#$.addPushHandler(this.#Z)}#Z=($)=>{if((0,b.dbgMaintenance)("ONPUSH:",$.map(String)),!Array.isArray($)||!["MOVING","MIGRATING","MIGRATED","FAILING_OVER","FAILED_OVER"].includes(String($[0])))return!1;let J=String($[0]);switch((0,b.emitDiagnostics)({type:J,timestamp:Date.now(),data:{push:$.map(String)}}),J){case K6.MOVING:{let Q=$[2],z=$[3]?String($[3]):null;return(0,b.dbgMaintenance)("Received MOVING:",Q,z),this.#K(Q,z),!0}case K6.MIGRATING:case K6.FAILING_OVER:return(0,b.dbgMaintenance)("Received MIGRATING|FAILING_OVER"),this.#q(),!0;case K6.MIGRATED:case K6.FAILED_OVER:return(0,b.dbgMaintenance)("Received MIGRATED|FAILED_OVER"),this.#w(),!0}return!1};#K=async($,J)=>{this.#q();let Q,z;if(J===null){(0,$$.default)(this.#J.maintEndpointType==="none"),(0,$$.default)(this.#J.socket!==void 0),(0,$$.default)("host"in this.#J.socket),(0,$$.default)(typeof this.#J.socket.host==="string"),Q=this.#J.socket.host,(0,$$.default)(typeof this.#J.socket.port==="number"),z=this.#J.socket.port;let Y=$*1000/2;(0,b.dbgMaintenance)(`Wait for ${Y}ms`),await(0,vR.setTimeout)(Y)}else{let Y=J.split(":");Q=Y[0],z=Number(Y[1])}(0,b.dbgMaintenance)("Pausing writing of new commands to old socket"),this.#z._pause(),(0,b.dbgMaintenance)("Creating new tmp client");let q=performance.now();if(this.#J.url){let Y=new URL(this.#J.url);Y.hostname=Q,Y.port=String(z),this.#J.url=Y.toString()}else this.#J.socket={...this.#J.socket,host:Q,port:z};let Z=this.#z.duplicate();Z.on("error",(Y)=>{(0,b.dbgMaintenance)("[ERR]",Y)}),(0,b.dbgMaintenance)(`Tmp client created in ${(performance.now()-q).toFixed(2)}ms`),(0,b.dbgMaintenance)(`Set timeout for tmp client to ${this.#J.maintRelaxedSocketTimeout}`),Z._maintenanceUpdate({relaxedCommandTimeout:this.#J.maintRelaxedCommandTimeout,relaxedSocketTimeout:this.#J.maintRelaxedSocketTimeout}),(0,b.dbgMaintenance)(`Connecting tmp client: ${Q}:${z}`),q=performance.now(),await Z.connect(),(0,b.dbgMaintenance)(`Connected to tmp client in ${(performance.now()-q).toFixed(2)}ms`),(0,b.dbgMaintenance)("Wait for all in-flight commands to complete"),await this.#$.waitForInflightCommandsToComplete(),(0,b.dbgMaintenance)("In-flight commands completed"),(0,b.dbgMaintenance)("Swap client sockets...");let W=this.#z._ejectSocket(),V=Z._ejectSocket();this.#z._insertSocket(V),Z._insertSocket(W),Z.destroy(),(0,b.dbgMaintenance)("Swap client sockets done."),(0,b.dbgMaintenance)("Resume writing"),this.#z._unpause(),this.#w()};#q=()=>{if(this.#Q++,this.#Q>1){(0,b.dbgMaintenance)("Timeout relaxation already done");return}let $={relaxedCommandTimeout:this.#J.maintRelaxedCommandTimeout,relaxedSocketTimeout:this.#J.maintRelaxedSocketTimeout};this.#z._maintenanceUpdate($)};#w=()=>{if(this.#Q=Math.max(this.#Q-1,0),this.#Q>0){(0,b.dbgMaintenance)("Not ready to unrelax timeouts yet");return}let $={relaxedCommandTimeout:void 0,relaxedSocketTimeout:void 0};this.#z._maintenanceUpdate($)}}b.default=uG;function UR($){let J=(0,yG.isIP)($);if(J===4){let Q=$.split(".").map(Number);return Q[0]===10||Q[0]===172&&Q[1]>=16&&Q[1]<=31||Q[0]===192&&Q[1]===168}if(J===6)return $.startsWith("fc")||$.startsWith("fd")||$==="::1"||$.startsWith("fe80");return!1}async function hR($,J,Q){if((0,$$.default)(Q.maintEndpointType!==void 0),Q.maintEndpointType!=="auto")return(0,b.dbgMaintenance)(`Determine endpoint type: ${Q.maintEndpointType}`),Q.maintEndpointType;let z=(0,yG.isIP)(J)?J:(await(0,jR.lookup)(J,{family:0})).address,q=UR(z),Z;if($)Z=q?"internal-fqdn":"external-fqdn";else Z=q?"internal-ip":"external-ip";return(0,b.dbgMaintenance)(`Determine endpoint type: ${Z}`),Z}});var iG=w((W6)=>{var lG=W6&&W6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(W6,"__esModule",{value:!0});var _G=C("node:events"),cG=lG(C("node:net")),NR=lG(C("node:tls")),j0=c(),IR=C("node:timers/promises"),dG=W7();class mG extends _G.EventEmitter{#$;#J;#Q;#z;#Z;#K;#q;#w=!1;get isOpen(){return this.#w}#W=!1;get isReady(){return this.#W}#X=!1;#B=0;get socketEpoch(){return this.#B}constructor($,J){super();this.#$=$,this.#J=J?.connectTimeout??5000,this.#Q=this.#Y(J),this.#z=this.#F(J),this.#Z=J?.socketTimeout}#Y($){let J=$?.reconnectStrategy;if(J===!1||typeof J==="number")return()=>J;if(J)return(Q,z)=>{try{let q=J(Q,z);if(q!==!1&&!(q instanceof Error)&&typeof q!=="number")throw TypeError(`Reconnect strategy should return \`false | Error | number\`, got ${q} instead`);return q}catch(q){return this.emit("error",q),this.defaultReconnectStrategy(Q,q)}};return this.defaultReconnectStrategy}#F($){if($?.tls===!0){let Q={...$,port:$?.port??6379,noDelay:$?.noDelay??!0,keepAlive:$?.keepAlive??!0,keepAliveInitialDelay:$?.keepAliveInitialDelay??5000,timeout:void 0,onread:void 0,readable:!0,writable:!0};return{create(){return NR.default.connect(Q)},event:"secureConnect"}}if($&&"path"in $){let Q={...$,timeout:void 0,onread:void 0,readable:!0,writable:!0};return{create(){return cG.default.createConnection(Q)},event:"connect"}}let J={...$,port:$?.port??6379,noDelay:$?.noDelay??!0,keepAlive:$?.keepAlive??!0,keepAliveInitialDelay:$?.keepAliveInitialDelay??5000,timeout:void 0,onread:void 0,readable:!0,writable:!0};return{create(){return cG.default.createConnection(J)},event:"connect"}}#H($,J){let Q=this.#Q($,J);if(Q===!1)return this.#w=!1,this.emit("error",J),J;else if(Q instanceof Error)return this.#w=!1,this.emit("error",J),new j0.ReconnectStrategyError(Q,J);return Q}async connect(){if(this.#w)throw Error("Socket already opened");return this.#w=!0,this.#G()}async#G(){let $=0;do try{this.#q=await this.#j(),this.emit("connect");try{await this.#$()}catch(J){throw this.#q.destroy(),this.#q=void 0,J}this.#W=!0,this.#B++,this.emit("ready")}catch(J){let Q=this.#H($++,J);if(typeof Q!=="number")throw Q;this.emit("error",J),await(0,IR.setTimeout)(Q),this.emit("reconnecting")}while(this.#w&&!this.#W)}setMaintenanceTimeout($){if((0,dG.dbgMaintenance)(`Set socket timeout to ${$}`),this.#K===$){(0,dG.dbgMaintenance)(`Socket already set maintenanceCommandTimeout to ${$}, skipping`);return}if(this.#K=$,$!==void 0)this.#q?.setTimeout($);else this.#q?.setTimeout(this.#Z??0)}async#j(){let $=this.#z.create(),J;if(this.#J!==void 0)J=()=>$.destroy(new j0.ConnectionTimeoutError),$.once("timeout",J),$.setTimeout(this.#J);if(this.#X)$.unref();if(await(0,_G.once)($,this.#z.event),J)$.removeListener("timeout",J);if(this.#Z)$.once("timeout",()=>{let Q=this.#K?new j0.SocketTimeoutDuringMaintenanceError(this.#K):new j0.SocketTimeoutError(this.#Z);$.destroy(Q)}),$.setTimeout(this.#Z);return $.once("error",(Q)=>this.#b(Q)).once("close",(Q)=>{if(Q||!this.#w||this.#q!==$)return;this.#b(new j0.SocketClosedUnexpectedlyError)}).on("drain",()=>this.emit("drain")).on("data",(Q)=>this.emit("data",Q)),$}#b($){let J=this.#W;if(this.#W=!1,this.emit("error",$),!J||!this.#w||typeof this.#H(0,$)!=="number")return;this.emit("reconnecting"),this.#G().catch(()=>{})}write($){if(!this.#q)return;this.#q.cork();for(let J of $){for(let Q of J)this.#q.write(Q);if(this.#q.writableNeedDrain)break}this.#q.uncork()}async quit($){if(!this.#w)throw new j0.ClientClosedError;this.#w=!1;let J=await $();return this.destroySocket(),J}close(){if(!this.#w)throw new j0.ClientClosedError;this.#w=!1}destroy(){if(!this.#w)throw new j0.ClientClosedError;this.#w=!1,this.destroySocket()}destroySocket(){if(this.#W=!1,this.#q)this.#q.destroy(),this.#q=void 0;this.emit("end")}ref(){this.#X=!1,this.#q?.ref()}unref(){this.#X=!0,this.#q?.unref()}defaultReconnectStrategy($,J){if(J instanceof j0.SocketTimeoutError)return!1;let Q=Math.floor(Math.random()*200);return Math.min(Math.pow(2,$)*50,2000)+Q}}W6.default=mG});var d5=w((tG)=>{Object.defineProperty(tG,"__esModule",{value:!0});tG.Token=void 0;class nG{value;expiresAtMs;receivedAtMs;constructor($,J,Q){this.value=$,this.expiresAtMs=J,this.receivedAtMs=Q}getTtlMs($){if(this.expiresAtMs<$)return 0;return this.expiresAtMs-$}}tG.Token=nG});var rG=w((pG)=>{Object.defineProperty(pG,"__esModule",{value:!0});pG.TokenManager=pG.IDPError=void 0;var OR=d5();class l5 extends Error{message;isRetryable;constructor($,J){super($);this.message=$,this.isRetryable=J,this.name="IDPError"}}pG.IDPError=l5;class oG{identityProvider;config;currentToken=null;refreshTimeout=null;listener=null;retryAttempt=0;constructor($,J){if(this.identityProvider=$,this.config=J,this.config.expirationRefreshRatio>1)throw Error("expirationRefreshRatio must be less than or equal to 1");if(this.config.expirationRefreshRatio<0)throw Error("expirationRefreshRatio must be greater or equal to 0")}start($,J=0){if(this.listener)this.stop();return this.listener=$,this.retryAttempt=0,this.scheduleNextRefresh(J),{dispose:()=>this.stop()}}calculateRetryDelay(){if(!this.config.retry)return 0;let{initialDelayMs:$,maxDelayMs:J,backoffMultiplier:Q,jitterPercentage:z}=this.config.retry,q=$*Math.pow(Q,this.retryAttempt-1);if(q=Math.min(q,J),z){let W=q*(z/100),V=Math.random()*W-W/2;q+=V}return Math.max(0,Math.floor(q))}shouldRetry($){if(!this.config.retry)return!1;let{maxAttempts:J,isRetryable:Q}=this.config.retry;if(this.retryAttempt>=J)return!1;if(Q)return Q($,this.retryAttempt);return!1}isRunning(){return this.listener!==null}async refresh(){if(!this.listener)throw Error("TokenManager is not running, but refresh was called");try{await this.identityProvider.requestToken().then(this.handleNewToken),this.retryAttempt=0}catch($){if(this.shouldRetry($)){this.retryAttempt++;let J=this.calculateRetryDelay();this.notifyError(`Token refresh failed (attempt ${this.retryAttempt}), retrying in ${J}ms: ${$}`,!0),this.scheduleNextRefresh(J)}else this.notifyError($,!1),this.stop()}}handleNewToken=async({token:$,ttlMs:J})=>{if(!this.listener)throw Error("TokenManager is not running, but a new token was received");let Q=this.wrapAndSetCurrentToken($,J);this.listener.onNext(Q),this.scheduleNextRefresh(this.calculateRefreshTime(Q))};wrapAndSetCurrentToken($,J){let Q=Date.now(),z=new OR.Token($,Q+J,Q);return this.currentToken=z,z}scheduleNextRefresh($){if(this.refreshTimeout)clearTimeout(this.refreshTimeout),this.refreshTimeout=null;if($===0)this.refresh();else this.refreshTimeout=setTimeout(()=>this.refresh(),$)}calculateRefreshTime($,J=Date.now()){let Q=$.getTtlMs(J);return Math.floor(Q*this.config.expirationRefreshRatio)}stop(){if(this.refreshTimeout)clearTimeout(this.refreshTimeout),this.refreshTimeout=null;this.listener=null,this.currentToken=null,this.retryAttempt=0}getCurrentToken(){return this.currentToken}notifyError($,J){let Q=$ instanceof Error?$.message:String($);if(!this.listener)throw Error(`TokenManager is not running but received an error: ${Q}`);this.listener.onError(new l5(Q,J))}}pG.TokenManager=oG});var zP=w((JP)=>{Object.defineProperty(JP,"__esModule",{value:!0});JP.UnableToObtainNewCredentialsError=JP.CredentialsError=void 0;class eG extends Error{constructor($){super(`Re-authentication with latest credentials failed: ${$}`);this.name="CredentialsError"}}JP.CredentialsError=eG;class $P extends Error{constructor($){super(`Unable to obtain new credentials : ${$}`);this.name="UnableToObtainNewCredentialsError"}}JP.UnableToObtainNewCredentialsError=$P});var ZP=w((c0)=>{Object.defineProperty(c0,"__esModule",{value:!0});c0.Token=c0.CredentialsError=c0.UnableToObtainNewCredentialsError=c0.IDPError=c0.TokenManager=void 0;var qP=rG();Object.defineProperty(c0,"TokenManager",{enumerable:!0,get:function(){return qP.TokenManager}});Object.defineProperty(c0,"IDPError",{enumerable:!0,get:function(){return qP.IDPError}});var wP=zP();Object.defineProperty(c0,"UnableToObtainNewCredentialsError",{enumerable:!0,get:function(){return wP.UnableToObtainNewCredentialsError}});Object.defineProperty(c0,"CredentialsError",{enumerable:!0,get:function(){return wP.CredentialsError}});var xR=d5();Object.defineProperty(c0,"Token",{enumerable:!0,get:function(){return xR.Token}})});var V7=w((n)=>{var TR=n&&n.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(n,"__esModule",{value:!0});n.EmptyAwareSinglyLinkedList=n.SinglyLinkedList=n.DoublyLinkedList=void 0;var LR=TR(C("events"));class KP{#$=0;get length(){return this.#$}#J;get head(){return this.#J}#Q;get tail(){return this.#Q}push($){if(++this.#$,this.#Q===void 0)return this.#J=this.#Q={previous:this.#J,next:void 0,value:$};return this.#Q=this.#Q.next={previous:this.#Q,next:void 0,value:$}}unshift($){if(++this.#$,this.#J===void 0)return this.#J=this.#Q={previous:void 0,next:void 0,value:$};return this.#J=this.#J.previous={previous:void 0,next:this.#J,value:$}}add($,J=!1){return J?this.unshift($):this.push($)}shift(){if(this.#J===void 0)return;--this.#$;let $=this.#J;if($.next)$.next.previous=void 0,this.#J=$.next,$.next=void 0;else this.#J=this.#Q=void 0;return $.value}remove($){if(this.#$===0)return;if(--this.#$,this.#Q===$)this.#Q=$.previous;if(this.#J===$)this.#J=$.next;else{if($.previous)$.previous.next=$.next;if($.next)$.next.previous=$.previous}$.previous=void 0,$.next=void 0}reset(){this.#$=0,this.#J=this.#Q=void 0}*[Symbol.iterator](){let $=this.#J;while($!==void 0)yield $.value,$=$.next}*nodes(){let $=this.#J;while($){let J=$.next;yield $,$=J}}}n.DoublyLinkedList=KP;class m5{#$=0;get length(){return this.#$}#J;get head(){return this.#J}#Q;get tail(){return this.#Q}push($){++this.#$;let J={value:$,next:void 0,removed:!1};if(this.#J===void 0)return this.#J=this.#Q=J;return this.#Q.next=this.#Q=J}remove($,J){if($.removed)throw Error("node already removed");if(--this.#$,this.#J===$)if(this.#Q===$)this.#J=this.#Q=void 0;else this.#J=$.next;else if(this.#Q===$)this.#Q=J,J.next=void 0;else J.next=$.next;$.removed=!0}shift(){if(this.#J===void 0)return;let $=this.#J;if(--this.#$===0)this.#J=this.#Q=void 0;else this.#J=$.next;return $.removed=!0,$.value}reset(){this.#$=0,this.#J=this.#Q=void 0}*[Symbol.iterator](){let $=this.#J;while($!==void 0)yield $.value,$=$.next}}n.SinglyLinkedList=m5;class WP extends m5{events=new LR.default;reset(){let $=this.length;if(super.reset(),$!==this.length&&this.length===0)this.events.emit("empty")}shift(){let $=this.length,J=super.shift();if($!==this.length&&this.length===0)this.events.emit("empty");return J}remove($,J){let Q=this.length;if(super.remove($,J),Q!==this.length&&this.length===0)this.events.emit("empty")}}n.EmptyAwareSinglyLinkedList=WP});var YP=w((VP)=>{Object.defineProperty(VP,"__esModule",{value:!0});var V6=`\r
`;function fR($){let J=[],Q="*"+$.length+V6;for(let z=0;z<$.length;z++){let q=$[z];if(typeof q==="string")Q+="$"+Buffer.byteLength(q)+V6+q+V6;else if(q instanceof Buffer)J.push(Q+"$"+q.length.toString()+V6,q),Q=V6;else throw TypeError(`"arguments[${z}]" must be of type "string | Buffer", got ${typeof q} instead.`)}return J.push(Q),J}VP.default=fR});var Y6=w((XP)=>{Object.defineProperty(XP,"__esModule",{value:!0});XP.PubSub=XP.PUBSUB_TYPE=void 0;XP.PUBSUB_TYPE={CHANNELS:"CHANNELS",PATTERNS:"PATTERNS",SHARDED:"SHARDED"};var f={[XP.PUBSUB_TYPE.CHANNELS]:{subscribe:Buffer.from("subscribe"),unsubscribe:Buffer.from("unsubscribe"),message:Buffer.from("message")},[XP.PUBSUB_TYPE.PATTERNS]:{subscribe:Buffer.from("psubscribe"),unsubscribe:Buffer.from("punsubscribe"),message:Buffer.from("pmessage")},[XP.PUBSUB_TYPE.SHARDED]:{subscribe:Buffer.from("ssubscribe"),unsubscribe:Buffer.from("sunsubscribe"),message:Buffer.from("smessage")}};class d0{static isStatusReply($){return f[XP.PUBSUB_TYPE.CHANNELS].subscribe.equals($[0])||f[XP.PUBSUB_TYPE.CHANNELS].unsubscribe.equals($[0])||f[XP.PUBSUB_TYPE.PATTERNS].subscribe.equals($[0])||f[XP.PUBSUB_TYPE.PATTERNS].unsubscribe.equals($[0])||f[XP.PUBSUB_TYPE.SHARDED].subscribe.equals($[0])}static isShardedUnsubscribe($){return f[XP.PUBSUB_TYPE.SHARDED].unsubscribe.equals($[0])}static#$($){return Array.isArray($)?$:[$]}static#J($,J){return J?$.buffers:$.strings}#Q=0;#z=!1;get isActive(){return this.#z}listeners={[XP.PUBSUB_TYPE.CHANNELS]:new Map,[XP.PUBSUB_TYPE.PATTERNS]:new Map,[XP.PUBSUB_TYPE.SHARDED]:new Map};subscribe($,J,Q,z){let q=[f[$].subscribe],Z=d0.#$(J);for(let W of Z){let V=this.listeners[$].get(W);if(!V||V.unsubscribing)q.push(W)}if(q.length===1){for(let W of Z)d0.#J(this.listeners[$].get(W),z).add(Q);return}return this.#z=!0,this.#Q++,{args:q,channelsCounter:q.length-1,resolve:()=>{this.#Q--;for(let W of Z){let V=this.listeners[$].get(W);if(!V)V={unsubscribing:!1,buffers:new Set,strings:new Set},this.listeners[$].set(W,V);d0.#J(V,z).add(Q)}},reject:()=>{this.#Q--,this.#q()}}}extendChannelListeners($,J,Q){if(!this.#Z($,J,Q))return;return this.#z=!0,this.#Q++,{args:[f[$].subscribe,J],channelsCounter:1,resolve:()=>this.#Q--,reject:()=>{this.#Q--,this.#q()}}}#Z($,J,Q){let z=this.listeners[$].get(J);if(!z)return this.listeners[$].set(J,Q),!0;for(let q of Q.buffers)z.buffers.add(q);for(let q of Q.strings)z.strings.add(q);return!1}extendTypeListeners($,J){let Q=[f[$].subscribe];for(let[z,q]of J)if(this.#Z($,z,q))Q.push(z);if(Q.length===1)return;return this.#z=!0,this.#Q++,{args:Q,channelsCounter:Q.length-1,resolve:()=>this.#Q--,reject:()=>{this.#Q--,this.#q()}}}unsubscribe($,J,Q,z){let q=this.listeners[$];if(!J)return this.#K([f[$].unsubscribe],NaN,()=>q.clear());let Z=d0.#$(J);if(!Q)return this.#K([f[$].unsubscribe,...Z],Z.length,()=>{for(let V of Z)q.delete(V)});let W=[f[$].unsubscribe];for(let V of Z){let Y=q.get(V);if(Y){let F,H;if(z)F=Y.buffers,H=Y.strings;else F=Y.strings,H=Y.buffers;if((F.has(Q)?F.size-1:F.size)!==0||H.size!==0)continue;Y.unsubscribing=!0}W.push(V)}if(W.length===1){for(let V of Z)d0.#J(q.get(V),z).delete(Q);return}return this.#K(W,W.length-1,()=>{for(let V of Z){let Y=q.get(V);if(!Y)continue;if((z?Y.buffers:Y.strings).delete(Q),Y.buffers.size===0&&Y.strings.size===0)q.delete(V)}})}#K($,J,Q){return{args:$,channelsCounter:J,resolve:()=>{Q(),this.#q()},reject:void 0}}#q(){this.#z=this.listeners[XP.PUBSUB_TYPE.CHANNELS].size!==0||this.listeners[XP.PUBSUB_TYPE.PATTERNS].size!==0||this.listeners[XP.PUBSUB_TYPE.SHARDED].size!==0||this.#Q!==0}reset(){this.#z=!1,this.#Q=0}resubscribe(){let $=[];for(let[J,Q]of Object.entries(this.listeners)){if(!Q.size)continue;if(this.#z=!0,J===XP.PUBSUB_TYPE.SHARDED)this.#W($,Q);else this.#w($,J,Q)}return $}#w($,J,Q){this.#Q++;let z=()=>this.#Q--;$.push({args:[f[J].subscribe,...Q.keys()],channelsCounter:Q.size,resolve:z,reject:z})}#W($,J){let Q=()=>this.#Q--;for(let z of J.keys())this.#Q++,$.push({args:[f[XP.PUBSUB_TYPE.SHARDED].subscribe,z],channelsCounter:1,resolve:Q,reject:Q})}handleMessageReply($){if(f[XP.PUBSUB_TYPE.CHANNELS].message.equals($[0]))return this.#X(XP.PUBSUB_TYPE.CHANNELS,$[2],$[1]),!0;else if(f[XP.PUBSUB_TYPE.PATTERNS].message.equals($[0]))return this.#X(XP.PUBSUB_TYPE.PATTERNS,$[3],$[2],$[1]),!0;else if(f[XP.PUBSUB_TYPE.SHARDED].message.equals($[0]))return this.#X(XP.PUBSUB_TYPE.SHARDED,$[2],$[1]),!0;return!1}removeShardedListeners($){let J=this.listeners[XP.PUBSUB_TYPE.SHARDED].get($);return this.listeners[XP.PUBSUB_TYPE.SHARDED].delete($),this.#q(),J}removeAllListeners(){let $={[XP.PUBSUB_TYPE.CHANNELS]:this.listeners[XP.PUBSUB_TYPE.CHANNELS],[XP.PUBSUB_TYPE.PATTERNS]:this.listeners[XP.PUBSUB_TYPE.PATTERNS],[XP.PUBSUB_TYPE.SHARDED]:this.listeners[XP.PUBSUB_TYPE.SHARDED]};return this.#q(),this.listeners[XP.PUBSUB_TYPE.CHANNELS]=new Map,this.listeners[XP.PUBSUB_TYPE.PATTERNS]=new Map,this.listeners[XP.PUBSUB_TYPE.SHARDED]=new Map,$}#X($,J,Q,z){let q=(z??Q).toString(),Z=this.listeners[$].get(q);if(!Z)return;for(let Y of Z.buffers)Y(J,Q);if(!Z.strings.size)return;let W=z?Q.toString():q,V=W==="__redis__:invalidate"?J===null?null:J.map((Y)=>Y.toString()):J.toString();for(let Y of Z.strings)Y(V,W)}}XP.PubSub=d0});var BP=w((H6)=>{var SR=H6&&H6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(H6,"__esModule",{value:!0});var HP=V7(),ER=SR(YP()),F6=$7(),i5=Y6(),X6=c(),Y7=W7(),kR=Buffer.from("pong"),gR=Buffer.from("RESET"),RR={...F6.PUSH_TYPE_MAPPING,[F6.RESP_TYPES.SIMPLE_STRING]:Buffer};class v0{#$;#J;#Q=new HP.DoublyLinkedList;#z=new HP.EmptyAwareSinglyLinkedList;#Z;#K;decoder;#q=new i5.PubSub;#w=[this.#Y.bind(this)];#W;setMaintenanceCommandTimeout($){if(this.#W===$){(0,Y7.dbgMaintenance)(`Queue already set maintenanceCommandTimeout to ${$}, skipping`);return}if((0,Y7.dbgMaintenance)(`Setting maintenance command timeout to ${$}`),this.#W=$,this.#W===void 0){(0,Y7.dbgMaintenance)("Queue will keep maintenanceCommandTimeout for exisitng commands, just to be on the safe side. New commands will receive normal timeouts");return}let J=0,Q=this.#Q.length;for(let z of this.#Q.nodes()){let q=z.value;v0.#h(q),J++;let Z=this.#W,W=AbortSignal.timeout(Z);q.timeout={signal:W,listener:()=>{this.#Q.remove(z),q.reject(new X6.CommandTimeoutDuringMaintenanceError(Z))},originalTimeout:q.timeout?.originalTimeout},W.addEventListener("abort",q.timeout.listener,{once:!0})}(0,Y7.dbgMaintenance)(`Total of ${J} of ${Q} timeouts reset to ${$}`)}get isPubSubActive(){return this.#q.isActive}constructor($,J,Q){this.#$=$,this.#J=J,this.#Z=Q,this.decoder=this.#H()}#X($){this.#z.shift().resolve($)}#B($){this.#z.shift().reject($)}#Y($){if(this.#q.handleMessageReply($))return!0;let J=i5.PubSub.isShardedUnsubscribe($);if(J&&!this.#z.length){let Q=$[1].toString();return this.#Z(Q,this.#q.removeShardedListeners(Q)),!0}else if(J||i5.PubSub.isStatusReply($)){let Q=this.#z.head.value;if(Number.isNaN(Q.channelsCounter)&&$[2]===0||--Q.channelsCounter===0)this.#z.shift().resolve();return!0}return!1}#F(){return this.#z.head.value.typeMapping??{}}#H(){return new F6.Decoder({onReply:($)=>this.#X($),onErrorReply:($)=>this.#B($),onPush:($)=>{for(let J of this.#w)if(J($))return},getTypeMapping:()=>this.#F()})}addPushHandler($){this.#w.push($)}async waitForInflightCommandsToComplete(){if(this.#z.length===0)return;return new Promise(($)=>{this.#z.events.on("empty",$)})}addCommand($,J){if(this.#J&&this.#Q.length+this.#z.length>=this.#J)return Promise.reject(Error("The queue is full"));else if(J?.abortSignal?.aborted)return Promise.reject(new X6.AbortError);return new Promise((Q,z)=>{let q,Z={args:$,chainId:J?.chainId,abort:void 0,timeout:void 0,resolve:Q,reject:z,channelsCounter:void 0,typeMapping:J?.typeMapping},W=this.#W??J?.timeout,V=this.#W!==void 0;if(W){let F=AbortSignal.timeout(W);Z.timeout={signal:F,listener:()=>{this.#Q.remove(q),Z.reject(V?new X6.CommandTimeoutDuringMaintenanceError(W):new X6.TimeoutError)},originalTimeout:J?.timeout},F.addEventListener("abort",Z.timeout.listener,{once:!0})}let Y=J?.abortSignal;if(Y)Z.abort={signal:Y,listener:()=>{this.#Q.remove(q),Z.reject(new X6.AbortError)}},Y.addEventListener("abort",Z.abort.listener,{once:!0});q=this.#Q.add(Z,J?.asap)})}#G($,J=!1,Q){return new Promise((z,q)=>{this.#Q.add({args:$.args,chainId:Q,abort:void 0,timeout:void 0,resolve(){$.resolve(),z()},reject(Z){$.reject?.(),q(Z)},channelsCounter:$.channelsCounter,typeMapping:F6.PUSH_TYPE_MAPPING},J)})}#j(){if(this.#$!==2)return;this.decoder.onReply=($)=>{if(Array.isArray($)){if(this.#Y($))return;if(kR.equals($[0])){let{resolve:J,typeMapping:Q}=this.#z.shift(),z=$[1].length===0?$[0]:$[1];J(Q?.[F6.RESP_TYPES.SIMPLE_STRING]===Buffer?z:z.toString());return}}return this.#X($)},this.decoder.getTypeMapping=()=>RR}subscribe($,J,Q,z){let q=this.#q.subscribe($,J,Q,z);if(!q)return;return this.#j(),this.#G(q)}#b(){this.decoder.onReply=($)=>this.#X($),this.decoder.getTypeMapping=()=>this.#F()}unsubscribe($,J,Q,z){let q=this.#q.unsubscribe($,J,Q,z);if(!q)return;if(q&&this.#$===2){let{resolve:Z}=q;q.resolve=()=>{if(!this.#q.isActive)this.#b();Z()}}return this.#G(q)}removeAllPubSubListeners(){return this.#q.removeAllListeners()}resubscribe($){let J=this.#q.resubscribe();if(!J.length)return;return this.#j(),Promise.all(J.map((Q)=>this.#G(Q,!0,$)))}extendPubSubChannelListeners($,J,Q){let z=this.#q.extendChannelListeners($,J,Q);if(!z)return;return this.#j(),this.#G(z)}extendPubSubListeners($,J){let Q=this.#q.extendTypeListeners($,J);if(!Q)return;return this.#j(),this.#G(Q)}getPubSubListeners($){return this.#q.listeners[$]}monitor($,J){return new Promise((Q,z)=>{let q=J?.typeMapping??{};this.#Q.add({args:["MONITOR"],chainId:J?.chainId,abort:void 0,timeout:void 0,resolve:()=>{if(this.#P)this.#P=$;else this.decoder.onReply=$;this.decoder.getTypeMapping=()=>q,Q()},reject:z,channelsCounter:void 0,typeMapping:q},J?.asap)})}resetDecoder(){this.#b(),this.decoder.reset()}#P;async reset($,J){return new Promise((Q,z)=>{this.#P=this.decoder.onReply,this.decoder.onReply=(q)=>{if(typeof q==="string"&&q==="RESET"||q instanceof Buffer&&gR.equals(q)){this.#b(),this.#P=void 0,this.#q.reset(),this.#z.shift().resolve(q);return}this.#P(q)},this.#Q.push({args:["RESET"],chainId:$,abort:void 0,timeout:void 0,resolve:Q,reject:z,channelsCounter:void 0,typeMapping:J})})}isWaitingToWrite(){return this.#Q.length>0}*commandsToWrite(){let $=this.#Q.shift();while($){let J;try{J=(0,ER.default)($.args)}catch(Q){$.reject(Q),$=this.#Q.shift();continue}if($.args=void 0,$.abort)v0.#I($),$.abort=void 0;if($.timeout)v0.#h($),$.timeout=void 0;this.#K=$.chainId,$.chainId=void 0,this.#z.push($),yield J,$=this.#Q.shift()}}#v($){for(let J of this.#z)J.reject($);this.#z.reset()}static#I($){$.abort.signal.removeEventListener("abort",$.abort.listener)}static#h($){$.timeout?.signal.removeEventListener("abort",$.timeout.listener)}static#U($,J){if($.abort)v0.#I($);if($.timeout)v0.#h($);$.reject(J)}flushWaitingForReply($){if(this.resetDecoder(),this.#q.reset(),this.#v($),!this.#K)return;while(this.#Q.head?.value.chainId===this.#K)v0.#U(this.#Q.shift(),$);this.#K=void 0}flushAll($){this.resetDecoder(),this.#q.reset(),this.#v($);for(let J of this.#Q)v0.#U(J,$);this.#Q.reset()}isEmpty(){return this.#Q.length===0&&this.#z.length===0}}H6.default=v0});var t=w((GP)=>{Object.defineProperty(GP,"__esModule",{value:!0});GP.scriptArgumentsPrefix=GP.functionArgumentsPrefix=GP.getTransformReply=GP.attachConfig=void 0;function jP(){throw Error("Some RESP3 results for Redis Query Engine responses may change. Refer to the readme for guidance")}function yR({BaseClass:$,commands:J,createCommand:Q,createModuleCommand:z,createFunctionCommand:q,createScriptCommand:Z,config:W}){let V=W?.RESP??2,Y=class extends ${};for(let[F,H]of Object.entries(J))if(W?.RESP==3&&H.unstableResp3&&!W.unstableResp3)Y.prototype[F]=jP;else Y.prototype[F]=Q(H,V);if(W?.modules)for(let[F,H]of Object.entries(W.modules)){let B=Object.create(null);for(let[v,x]of Object.entries(H))if(W.RESP==3&&x.unstableResp3&&!W.unstableResp3)B[v]=jP;else B[v]=z(x,V);vP(Y.prototype,F,B)}if(W?.functions)for(let[F,H]of Object.entries(W.functions)){let B=Object.create(null);for(let[v,x]of Object.entries(H))B[v]=q(v,x,V);vP(Y.prototype,F,B)}if(W?.scripts)for(let[F,H]of Object.entries(W.scripts))Y.prototype[F]=Z(H,V);return Y}GP.attachConfig=yR;function vP($,J,Q){Object.defineProperty($,J,{get(){let z=Object.create(Q);return z._self=this,Object.defineProperty(this,J,{value:z}),z}})}function uR($,J){switch(typeof $.transformReply){case"function":return $.transformReply;case"object":return $.transformReply[J]}}GP.getTransformReply=uR;function _R($,J){let Q=[J.IS_READ_ONLY?"FCALL_RO":"FCALL",$];if(J.NUMBER_OF_KEYS!==void 0)Q.push(J.NUMBER_OF_KEYS.toString());return Q}GP.functionArgumentsPrefix=_R;function cR($){let J=[$.IS_READ_ONLY?"EVALSHA_RO":"EVALSHA",$.SHA1];if($.NUMBER_OF_KEYS!==void 0)J.push($.NUMBER_OF_KEYS.toString());return J}GP.scriptArgumentsPrefix=cR});var B6=w((hP)=>{Object.defineProperty(hP,"__esModule",{value:!0});var bP=c();class UP{typeMapping;constructor($){this.typeMapping=$}queue=[];scriptsInUse=new Set;addCommand($,J){this.queue.push({args:$,transformReply:J})}addScript($,J,Q){let z=[];if(z.preserve=J.preserve,this.scriptsInUse.has($.SHA1))z.push("EVALSHA",$.SHA1);else this.scriptsInUse.add($.SHA1),z.push("EVAL",$.SCRIPT);if($.NUMBER_OF_KEYS!==void 0)z.push($.NUMBER_OF_KEYS.toString());z.push(...J),this.addCommand(z,Q)}transformReplies($){let J=[],Q=$.map((z,q)=>{if(z instanceof bP.ErrorReply)return J.push(q),z;let{transformReply:Z,args:W}=this.queue[q];return Z?Z(z,W.preserve,this.typeMapping):z});if(J.length)throw new bP.MultiErrorReply(Q,J);return Q}}hP.default=UP});var n5=w((j6)=>{var NP=j6&&j6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(j6,"__esModule",{value:!0});var nR=NP(i()),tR=NP(B6()),J$=t(),X7=d();class l0{static#$($,J){let Q=(0,J$.getTransformReply)($,J);return function(...z){let q=new X7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;return Z.preserve=q.preserve,this.addCommand(Z,Q)}}static#J($,J){let Q=(0,J$.getTransformReply)($,J);return function(...z){let q=new X7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;return Z.preserve=q.preserve,this._self.addCommand(Z,Q)}}static#Q($,J,Q){let z=(0,J$.functionArgumentsPrefix)($,J),q=(0,J$.getTransformReply)(J,Q);return function(...Z){let W=new X7.BasicCommandParser;W.push(...z),J.parseCommand(W,...Z);let V=W.redisArgs;return V.preserve=W.preserve,this._self.addCommand(V,q)}}static#z($,J){let Q=(0,J$.getTransformReply)($,J);return function(...z){let q=new X7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;return Z.preserve=q.preserve,this.#W($,Z,Q)}}static extend($){return(0,J$.attachConfig)({BaseClass:l0,commands:nR.default,createCommand:l0.#$,createModuleCommand:l0.#J,createFunctionCommand:l0.#Q,createScriptCommand:l0.#z,config:$})}#Z;#K;#q;#w;constructor($,J,Q){this.#Z=new tR.default(Q),this.#K=$,this.#q=J}SELECT($,J){return this.#w=$,this.#Z.addCommand(["SELECT",$.toString()],J),this}select=this.SELECT;addCommand($,J){return this.#Z.addCommand($,J),this}#W($,J,Q){return this.#Z.addScript($,J,Q),this}async exec($=!1){if($)return this.execAsPipeline();return this.#Z.transformReplies(await this.#K(this.#Z.queue,this.#w))}EXEC=this.exec;execTyped($=!1){return this.exec($)}async execAsPipeline(){if(this.#Z.queue.length===0)return[];return this.#Z.transformReplies(await this.#q(this.#Z.queue,this.#w))}execAsPipelineTyped(){return this.execAsPipeline()}}j6.default=l0});var DP=w((Q$)=>{var IP=Q$&&Q$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(Q$,"__esModule",{value:!0});Q$.RedisLegacyClient=void 0;var aR=t(),OP=IP(i()),oR=IP(B6());class R{static#$($,J){let Q;if(typeof J[J.length-1]==="function")Q=J.pop();return R.pushArguments($,J),Q}static pushArguments($,J){for(let Q=0;Q<J.length;++Q){let z=J[Q];if(Array.isArray(z))R.pushArguments($,z);else $.push(typeof z==="number"||z instanceof Date?z.toString():z)}}static getTransformReply($,J){return $.TRANSFORM_LEGACY_REPLY?(0,aR.getTransformReply)($,J):void 0}static#J($,J,Q){let z=R.getTransformReply(J,Q);return function(...q){let Z=[$],W=R.#$(Z,q),V=this.#Q.sendCommand(Z);if(!W){V.catch((Y)=>this.#Q.emit("error",Y));return}V.then((Y)=>W(null,z?z(Y):Y)).catch((Y)=>W(Y))}}#Q;#z;constructor($){this.#Q=$;let J=$.options?.RESP??2;for(let[Q,z]of Object.entries(OP.default))this[Q]=R.#J(Q,z,J);this.#z=F7.factory(J)}sendCommand(...$){let J=[],Q=R.#$(J,$),z=this.#Q.sendCommand(J);if(!Q){z.catch((q)=>this.#Q.emit("error",q));return}z.then((q)=>Q(null,q)).catch((q)=>Q(q))}multi(){return this.#z(this.#Q)}}Q$.RedisLegacyClient=R;class F7{static#$($,J,Q){let z=R.getTransformReply(J,Q);return function(...q){let Z=[$];return R.pushArguments(Z,q),this.#J.addCommand(Z,z),this}}static factory($){let J=class extends F7{};for(let[Q,z]of Object.entries(OP.default))J.prototype[Q]=F7.#$(Q,z,$);return(Q)=>{return new J(Q)}}#J=new oR.default;#Q;constructor($){this.#Q=$}sendCommand(...$){let J=[];return R.pushArguments(J,$),this.#J.addCommand(J),this}exec($){let J=this.#Q._executeMulti(this.#J.queue);if(!$){J.catch((Q)=>this.#Q.emit("error",Q));return}J.then((Q)=>$(null,this.#J.transformReplies(Q))).catch((Q)=>$?.(Q))}}});var z$=w((TP)=>{Object.defineProperty(TP,"__esModule",{value:!0});TP.PooledNoRedirectClientSideCache=TP.BasicPooledClientSideCache=TP.PooledClientSideCacheProvider=TP.BasicClientSideCache=TP.ClientSideCacheProvider=TP.CacheStats=void 0;var pR=C("stream");class G0{hitCount;missCount;loadSuccessCount;loadFailureCount;totalLoadTime;evictionCount;constructor($,J,Q,z,q,Z){if(this.hitCount=$,this.missCount=J,this.loadSuccessCount=Q,this.loadFailureCount=z,this.totalLoadTime=q,this.evictionCount=Z,$<0||J<0||Q<0||z<0||q<0||Z<0)throw Error("All statistics values must be non-negative")}static of($=0,J=0,Q=0,z=0,q=0,Z=0){return new G0($,J,Q,z,q,Z)}static empty(){return G0.EMPTY_STATS}static EMPTY_STATS=new G0(0,0,0,0,0,0);requestCount(){return this.hitCount+this.missCount}hitRate(){let $=this.requestCount();return $===0?1:this.hitCount/$}missRate(){let $=this.requestCount();return $===0?0:this.missCount/$}loadCount(){return this.loadSuccessCount+this.loadFailureCount}loadFailureRate(){let $=this.loadCount();return $===0?0:this.loadFailureCount/$}averageLoadPenalty(){let $=this.loadCount();return $===0?0:this.totalLoadTime/$}minus($){return G0.of(Math.max(0,this.hitCount-$.hitCount),Math.max(0,this.missCount-$.missCount),Math.max(0,this.loadSuccessCount-$.loadSuccessCount),Math.max(0,this.loadFailureCount-$.loadFailureCount),Math.max(0,this.totalLoadTime-$.totalLoadTime),Math.max(0,this.evictionCount-$.evictionCount))}plus($){return G0.of(this.hitCount+$.hitCount,this.missCount+$.missCount,this.loadSuccessCount+$.loadSuccessCount,this.loadFailureCount+$.loadFailureCount,this.totalLoadTime+$.totalLoadTime,this.evictionCount+$.evictionCount)}}TP.CacheStats=G0;class v7{static INSTANCE=new v7;constructor(){}recordHits($){}recordMisses($){}recordLoadSuccess($){}recordLoadFailure($){}recordEvictions($){}snapshot(){return G0.empty()}}function sR(){return v7.INSTANCE}class H7{#$=0;#J=0;#Q=0;#z=0;#Z=0;#K=0;recordHits($){this.#$+=$}recordMisses($){this.#J+=$}recordLoadSuccess($){this.#Q++,this.#Z+=$}recordLoadFailure($){this.#z++,this.#Z+=$}recordEvictions($){this.#K+=$}snapshot(){return G0.of(this.#$,this.#J,this.#Q,this.#z,this.#Z,this.#K)}static create(){return new H7}}function rR($){let J=Array($.length*2);for(let Q=0;Q<$.length;Q++)J[Q]=$[Q].length,J[Q+$.length]=$[Q];return J.join("_")}class t5{#$=!1;#J;constructor($){if($==0)this.#J=0;else this.#J=Date.now()+$}invalidate(){this.#$=!0}validate(){return!this.#$&&(this.#J==0||Date.now()<this.#J)}}class B7 extends t5{#$;get value(){return this.#$}constructor($,J){super($);this.#$=J}}class j7 extends t5{#$;get promise(){return this.#$}constructor($,J){super($);this.#$=J}}class a5 extends pR.EventEmitter{}TP.ClientSideCacheProvider=a5;class o5 extends a5{#$;#J;ttl;maxEntries;lru;#Q;recordEvictions($){this.#Q.recordEvictions($)}recordHits($){this.#Q.recordHits($)}recordMisses($){this.#Q.recordMisses($)}constructor($){super();this.#$=new Map,this.#J=new Map,this.ttl=$?.ttl??0,this.maxEntries=$?.maxEntries??0,this.lru=$?.evictPolicy!=="FIFO";let J=$?.recordStats!==!1;this.#Q=J?H7.create():sR()}async handleCache($,J,Q,z,q){let Z,W=rR(J.redisArgs),V=this.get(W);if(V)if(V instanceof B7)return this.#Q.recordHits(1),structuredClone(V.value);else if(V instanceof j7)this.#Q.recordMisses(1),Z=await V.promise;else throw Error("unknown cache entry type");else{this.#Q.recordMisses(1);let F=performance.now(),H=Q();V=this.createPromiseEntry($,H),this.set(W,V,J.keys);try{Z=await H;let B=performance.now()-F;this.#Q.recordLoadSuccess(B)}catch(B){let v=performance.now()-F;if(this.#Q.recordLoadFailure(v),V.validate())this.delete(W);throw B}}let Y;if(z)Y=z(Z,J.preserve,q);else Y=Z;if(V.validate())V=this.createValueEntry($,Y),this.set(W,V,J.keys),this.emit("cached-key",W);return structuredClone(Y)}trackingOn(){return["CLIENT","TRACKING","ON"]}invalidate($){if($===null){this.clear(!1),this.emit("invalidate",$);return}let J=this.#J.get($.toString());if(J){for(let Q of J){let z=this.#$.get(Q);if(z)z.invalidate();this.#$.delete(Q)}this.#J.delete($.toString())}this.emit("invalidate",$)}clear($=!0){let J=this.#$.size;if(this.#$.clear(),this.#J.clear(),$){if(!(this.#Q instanceof v7))this.#Q=H7.create()}else if(J>0)this.#Q.recordEvictions(J)}get($){let J=this.#$.get($);if(J&&!J.validate()){this.delete($),this.#Q.recordEvictions(1),this.emit("cache-evict",$);return}if(J!==void 0&&this.lru)this.#$.delete($),this.#$.set($,J);return J}delete($){let J=this.#$.get($);if(J)J.invalidate(),this.#$.delete($)}has($){return this.#$.has($)}set($,J,Q){let z=this.#$.size,q=this.#$.get($);if(q)z--,q.invalidate();if(this.maxEntries>0&&z>=this.maxEntries)this.deleteOldest(),this.#Q.recordEvictions(1);this.#$.set($,J);for(let Z of Q){if(!this.#J.has(Z.toString()))this.#J.set(Z.toString(),new Set);this.#J.get(Z.toString()).add($)}}size(){return this.#$.size}createValueEntry($,J){return new B7(this.ttl,J)}createPromiseEntry($,J){return new j7(this.ttl,J)}stats(){return this.#Q.snapshot()}onError(){this.clear()}onClose(){this.clear()}deleteOldest(){let J=this.#$[Symbol.iterator]().next();if(!J.done){let Q=J.value[0],z=this.#$.get(Q);if(z)z.invalidate();this.#$.delete(Q)}}entryEntries(){return this.#$.entries()}keySetEntries(){return this.#J.entries()}}TP.BasicClientSideCache=o5;class p5 extends o5{#$=!1;disable(){this.#$=!0}enable(){this.#$=!1}get($){if(this.#$)return;return super.get($)}has($){if(this.#$)return!1;return super.has($)}onPoolClose(){this.clear()}}TP.PooledClientSideCacheProvider=p5;class s5 extends p5{onError(){this.clear(!1)}onClose(){this.clear(!1)}}TP.BasicPooledClientSideCache=s5;class AP extends B7{#$;constructor($,J,Q){super($,Q);this.#$=J}validate(){let $=super.validate();if(this.#$)$=$&&this.#$.client.isReady&&this.#$.client.socketEpoch==this.#$.epoch;return $}}class xP extends j7{#$;constructor($,J,Q){super($,Q);this.#$=J}validate(){return super.validate()&&this.#$.client.isReady&&this.#$.client.socketEpoch==this.#$.epoch}}class CP extends s5{createValueEntry($,J){let Q={epoch:$.socketEpoch,client:$};return new AP(this.ttl,Q,J)}createPromiseEntry($,J){let Q={epoch:$.socketEpoch,client:$};return new xP(this.ttl,Q,J)}onError(){}onClose(){}}TP.PooledNoRedirectClientSideCache=CP});var G7=w((SP)=>{Object.defineProperty(SP,"__esModule",{value:!0});class MP{#$;#J;get($){return JSON.stringify($,fP())===this.#J?this.#$:void 0}set($,J){this.#$=J,this.#J=JSON.stringify($,fP())}}SP.default=MP;function fP(){let $=new WeakSet;return function(Q,z){if(z&&typeof z==="object"){if($.has(z))return"circular";return $.add(z),z}return z}}});var e5=w((q$)=>{var b7=q$&&q$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(q$,"__esModule",{value:!0});q$.RedisClientPool=void 0;var wy=b7(i()),Zy=b7(w$()),Ky=C("node:events"),r5=V7(),Wy=c(),m0=t(),Vy=b7(n5()),EP=z$(),P7=d(),Yy=b7(G7());class a extends Ky.EventEmitter{static#$($,J){let Q=(0,m0.getTransformReply)($,J);return async function(...z){let q=new P7.BasicCommandParser;return $.parseCommand(q,...z),this.execute((Z)=>Z._executeCommand($,q,this._commandOptions,Q))}}static#J($,J){let Q=(0,m0.getTransformReply)($,J);return async function(...z){let q=new P7.BasicCommandParser;return $.parseCommand(q,...z),this._self.execute((Z)=>Z._executeCommand($,q,this._self._commandOptions,Q))}}static#Q($,J,Q){let z=(0,m0.functionArgumentsPrefix)($,J),q=(0,m0.getTransformReply)(J,Q);return async function(...Z){let W=new P7.BasicCommandParser;return W.push(...z),J.parseCommand(W,...Z),this._self.execute((V)=>V._executeCommand(J,W,this._self._commandOptions,q))}}static#z($,J){let Q=(0,m0.scriptArgumentsPrefix)($),z=(0,m0.getTransformReply)($,J);return async function(...q){let Z=new P7.BasicCommandParser;return Z.pushVariadic(Q),$.parseCommand(Z,...q),this.execute((W)=>W._executeScript($,Z,this._commandOptions,z))}}static#Z=new Yy.default;static create($,J){let Q=a.#Z.get($);if(!Q)Q=(0,m0.attachConfig)({BaseClass:a,commands:wy.default,createCommand:a.#$,createModuleCommand:a.#J,createFunctionCommand:a.#Q,createScriptCommand:a.#z,config:$}),Q.prototype.Multi=Vy.default.extend($),a.#Z.set($,Q);return Object.create(new Q($,J))}static#K={minimum:1,maximum:100,acquireTimeout:3000,cleanupDelay:3000};#q;#w;#W=new r5.SinglyLinkedList;get idleClients(){return this._self.#W.length}#X=new r5.DoublyLinkedList;get clientsInUse(){return this._self.#X.length}get totalClients(){return this._self.#W.length+this._self.#X.length}#B=new r5.SinglyLinkedList;get tasksQueueLength(){return this._self.#B.length}#Y=!1;get isOpen(){return this._self.#Y}#F=!1;get isClosing(){return this._self.#F}#H;get clientSideCache(){return this._self.#H}constructor($,J){super();if(this.#w={...a.#K,...J},J?.clientSideCache){if($===void 0)$={};if(J.clientSideCache instanceof EP.PooledClientSideCacheProvider)this.#H=$.clientSideCache=J.clientSideCache;else{let Q=J.clientSideCache;this.#H=$.clientSideCache=new EP.BasicPooledClientSideCache(Q)}}this.#q=Zy.default.factory($).bind(void 0,$)}_self=this;_commandOptions;withCommandOptions($){let J=Object.create(this._self);return J._commandOptions=$,J}#G($,J){let Q=Object.create(this._self);return Q._commandOptions=Object.create(this._commandOptions??null),Q._commandOptions[$]=J,Q}withTypeMapping($){return this._self.#G("typeMapping",$)}withAbortSignal($){return this._self.#G("abortSignal",$)}asap(){return this._self.#G("asap",!0)}async connect(){if(this._self.#Y)return;this._self.#Y=!0;let $=[];while($.length<this._self.#w.minimum)$.push(this._self.#j());try{await Promise.all($)}catch(J){throw this.destroy(),J}return this}async#j(){let $=this._self.#X.push(this._self.#q().on("error",(J)=>this.emit("error",J)));try{await $.value.connect()}catch(J){throw this._self.#X.remove($),J}this._self.#P($)}execute($){return new Promise((J,Q)=>{let z=this._self.#W.shift(),{tail:q}=this._self.#B;if(!z){let W;if(this._self.#w.acquireTimeout>0)W=setTimeout(()=>{this._self.#B.remove(V,q),Q(new Wy.TimeoutError("Timeout waiting for a client"))},this._self.#w.acquireTimeout);let V=this._self.#B.push({timeout:W,resolve:J,reject:Q,fn:$});if(this.totalClients<this._self.#w.maximum)this._self.#j();return}let Z=this._self.#X.push(z);this._self.#b(Z,J,Q,$)})}#b($,J,Q,z){let q=z($.value);if(q instanceof Promise)q.then(J,Q).finally(()=>this.#P($));else J(q),this.#P($)}#P($){let J=this.#B.shift();if(J){clearTimeout(J.timeout),this.#b($,J.resolve,J.reject,J.fn);return}this.#X.remove($),this.#W.push($.value),this.#v()}cleanupTimeout;#v(){if(this.totalClients<=this.#w.minimum)return;clearTimeout(this.cleanupTimeout),this.cleanupTimeout=setTimeout(()=>this.#I(),this.#w.cleanupDelay)}#I(){let $=Math.min(this.#W.length,this.totalClients-this.#w.minimum);for(let J=0;J<$;J++)this.#W.shift().destroy()}sendCommand($,J){return this.execute((Q)=>Q.sendCommand($,J))}MULTI(){return new this.Multi(($,J)=>this.execute((Q)=>Q._executeMulti($,J)),($)=>this.execute((J)=>J._executePipeline($)),this._commandOptions?.typeMapping)}multi=this.MULTI;async close(){if(this._self.#F)return;if(!this._self.#Y)return;this._self.#F=!0;try{let $=[];for(let J of this._self.#W)$.push(J.close());for(let J of this._self.#X)$.push(J.close());await Promise.all($),this.#H?.onPoolClose(),this._self.#W.reset(),this._self.#X.reset()}catch($){}finally{this._self.#F=!1}}destroy(){for(let $ of this._self.#W)$.destroy();this._self.#W.reset();for(let $ of this._self.#X)$.destroy();this._self.#H?.onPoolClose(),this._self.#X.reset(),this._self.#Y=!1}}q$.RedisClientPool=a});var kP=w((qr,Xy)=>{Xy.exports={name:"@redis/client",version:"5.9.0-beta.3",license:"MIT",main:"./dist/index.js",types:"./dist/index.d.ts",files:["dist/","!dist/tsconfig.tsbuildinfo"],scripts:{test:"nyc -r text-summary -r lcov mocha -r tsx './lib/**/*.spec.ts'",release:"release-it"},dependencies:{"cluster-key-slot":"1.1.2"},devDependencies:{"@redis/test-utils":"*","@types/sinon":"^17.0.3",sinon:"^17.0.1"},engines:{node:">= 18"},repository:{type:"git",url:"git://github.com/redis/node-redis.git"},bugs:{url:"https://github.com/redis/node-redis/issues"},homepage:"https://github.com/redis/node-redis/tree/master/packages/client",keywords:["redis"]}});var w$=w((v6)=>{var t0=v6&&v6.__importDefault||function($){return $&&$.__esModule?$:{default:$}},y;Object.defineProperty(v6,"__esModule",{value:!0});var Z$=t0(i()),Fy=t0(iG()),gP=ZP(),Hy=t0(BP()),By=C("node:events"),i0=t(),S0=c(),jy=C("node:url"),K$=Y6(),vy=t0(n5()),Gy=t0(K5()),Py=DP(),by=e5(),n0=X(),RP=z$(),U7=d(),Uy=t0(G7()),hy=kP(),$8=t0(W7());class J8 extends By.EventEmitter{static#$($,J){let Q=(0,i0.getTransformReply)($,J);return async function(...z){let q=new U7.BasicCommandParser;return $.parseCommand(q,...z),this._self._executeCommand($,q,this._commandOptions,Q)}}static#J($,J){let Q=(0,i0.getTransformReply)($,J);return async function(...z){let q=new U7.BasicCommandParser;return $.parseCommand(q,...z),this._self._executeCommand($,q,this._self._commandOptions,Q)}}static#Q($,J,Q){let z=(0,i0.functionArgumentsPrefix)($,J),q=(0,i0.getTransformReply)(J,Q);return async function(...Z){let W=new U7.BasicCommandParser;return W.push(...z),J.parseCommand(W,...Z),this._self._executeCommand(J,W,this._self._commandOptions,q)}}static#z($,J){let Q=(0,i0.scriptArgumentsPrefix)($),z=(0,i0.getTransformReply)($,J);return async function(...q){let Z=new U7.BasicCommandParser;return Z.push(...Q),$.parseCommand(Z,...q),this._executeScript($,Z,this._commandOptions,z)}}static#Z=new Uy.default;static factory($){let J=y.#Z.get($);if(!J)J=(0,i0.attachConfig)({BaseClass:y,commands:Z$.default,createCommand:y.#$,createModuleCommand:y.#J,createFunctionCommand:y.#Q,createScriptCommand:y.#z,config:$}),J.prototype.Multi=vy.default.extend($),y.#Z.set($,J);return(Q)=>{return Object.create(new J(Q))}}static create($){return y.factory($)($)}static parseOptions($){if($?.url){let J=y.parseURL($.url);if($.socket){if($.socket.tls!==void 0&&$.socket.tls!==J.socket.tls)throw TypeError(`tls socket option is set to ${$.socket.tls} which is mismatch with protocol or the URL ${$.url} passed`);J.socket=Object.assign($.socket,J.socket)}Object.assign($,J)}return $}static parseURL($){let{hostname:J,port:Q,protocol:z,username:q,password:Z,pathname:W}=new jy.URL($),V={socket:{host:J,tls:!1}};if(z!=="redis:"&&z!=="rediss:")throw TypeError("Invalid protocol");if(V.socket.tls=z==="rediss:",Q)V.socket.port=Number(Q);if(q)V.username=decodeURIComponent(q);if(Z)V.password=decodeURIComponent(Z);if(q||Z)V.credentialsProvider={type:"async-credentials-provider",credentials:async()=>({username:q?decodeURIComponent(q):void 0,password:Z?decodeURIComponent(Z):void 0})};if(W.length>1){let Y=Number(W.substring(1));if(isNaN(Y))throw TypeError("Invalid pathname");V.database=Y}return V}#K;#q;#w;#W=0;#X;_self=this;_commandOptions;#B;#Y;#F;#H=null;#G=!1;get clientSideCache(){return this._self.#F}get options(){return this._self.#K}get isOpen(){return this._self.#q.isOpen}get isReady(){return this._self.#q.isReady}get isPubSubActive(){return this._self.#w.isPubSubActive}get socketEpoch(){return this._self.#q.socketEpoch}get isWatching(){return this._self.#Y!==void 0}get isDirtyWatch(){return this._self.#B!==void 0}setDirtyWatch($){this._self.#B=$}constructor($){super();if(this.#j($),this.#K=this.#b($),this.#w=this.#P(),this.#q=this.#O(),this.#K.maintNotifications!=="disabled")new $8.default(this.#w,this,this.#K);if(this.#K.clientSideCache){if(this.#K.clientSideCache instanceof RP.ClientSideCacheProvider)this.#F=this.#K.clientSideCache;else{let J=this.#K.clientSideCache;this.#F=new RP.BasicClientSideCache(J)}this.#w.addPushHandler((J)=>{if(J[0].toString()!=="invalidate")return!1;if(J[1]!==null)for(let Q of J[1])this.#F?.invalidate(Q);else this.#F?.invalidate(null);return!0})}else if($?.emitInvalidate)this.#w.addPushHandler((J)=>{if(J[0].toString()!=="invalidate")return!1;if(J[1]!==null)for(let Q of J[1])this.emit("invalidate",Q);else this.emit("invalidate",null);return!0})}#j($){if($?.clientSideCache&&$?.RESP!==3)throw Error("Client Side Caching is only supported with RESP3");if($?.emitInvalidate&&$?.RESP!==3)throw Error("emitInvalidate is only supported with RESP3");if($?.clientSideCache&&$?.emitInvalidate)throw Error("emitInvalidate is not supported (or necessary) when clientSideCache is enabled");if($?.maintNotifications&&$?.maintNotifications!=="disabled"&&$?.RESP!==3)throw Error("Graceful Maintenance is only supported with RESP3")}#b($={}){if(!$.credentialsProvider&&($.username||$.password))$.credentialsProvider={type:"async-credentials-provider",credentials:async()=>({username:$.username,password:$.password})};if($.database)this._self.#W=$.database;if($.commandOptions)this._commandOptions=$.commandOptions;if($.maintNotifications!=="disabled")$8.default.setupDefaultMaintOptions($);if($.url){let J=y.parseOptions($);if(J?.database)this._self.#W=J.database;return J}return $}#P(){return new Hy.default(this.#K.RESP??2,this.#K.commandsQueueMaxLength,($,J)=>this.emit("sharded-channel-moved",$,J))}reAuthenticate=async($)=>{if(!(this.isPubSubActive&&!this.#K.RESP))await this.sendCommand((0,n0.parseArgs)(Z$.default.AUTH,{username:$.username,password:$.password??""}))};#v($){return $.subscribe({onNext:(J)=>{this.reAuthenticate(J).catch((Q)=>{let z=Q instanceof Error?Q.message:String(Q);$.onReAuthenticationError(new gP.CredentialsError(z))})},onError:(J)=>{let Q=`Error from streaming credentials provider: ${J.message}`;$.onReAuthenticationError(new gP.UnableToObtainNewCredentialsError(Q))}})}async#I($,J){let Q=[],z=await this.#h();if(J)z.reverse();for(let{cmd:q,errorHandler:Z}of z)Q.push(this.#w.addCommand(q,{chainId:$,asap:J}).catch(Z));return Q}async#h(){let $=[],J=this.#K.credentialsProvider;if(this.#K.RESP){let z={};if(J&&J.type==="async-credentials-provider"){let q=await J.credentials();if(q.password)z.AUTH={username:q.username??"default",password:q.password}}if(J&&J.type==="streaming-credentials-provider"){let[q,Z]=await this.#v(J);if(this.#H=Z,q.password)z.AUTH={username:q.username??"default",password:q.password}}if(this.#K.name)z.SETNAME=this.#K.name;$.push({cmd:(0,n0.parseArgs)(Gy.default,this.#K.RESP,z)})}else{if(J&&J.type==="async-credentials-provider"){let z=await J.credentials();if(z.username||z.password)$.push({cmd:(0,n0.parseArgs)(Z$.default.AUTH,{username:z.username,password:z.password??""})})}if(J&&J.type==="streaming-credentials-provider"){let[z,q]=await this.#v(J);if(this.#H=q,z.username||z.password)$.push({cmd:(0,n0.parseArgs)(Z$.default.AUTH,{username:z.username,password:z.password??""})})}if(this.#K.name)$.push({cmd:(0,n0.parseArgs)(Z$.default.CLIENT_SETNAME,this.#K.name)})}if(this.#W!==0)$.push({cmd:["SELECT",this.#W.toString()]});if(this.#K.readonly)$.push({cmd:(0,n0.parseArgs)(Z$.default.READONLY)});if(!this.#K.disableClientInfo)$.push({cmd:["CLIENT","SETINFO","LIB-VER",hy.version],errorHandler:()=>{}}),$.push({cmd:["CLIENT","SETINFO","LIB-NAME",this.#K.clientInfoTag?`node-redis(${this.#K.clientInfoTag})`:"node-redis"],errorHandler:()=>{}});if(this.#F)$.push({cmd:this.#F.trackingOn()});if(this.#K?.emitInvalidate)$.push({cmd:["CLIENT","TRACKING","ON"]});let Q=await $8.default.getHandshakeCommand(this.#K);if(Q)$.push(Q);return $}#U($){$.on("data",(J)=>{try{this.#w.decoder.write(J)}catch(Q){this.#w.resetDecoder(),this.emit("error",Q)}}).on("error",(J)=>{if(this.emit("error",J),this.#F?.onError(),this.#q.isOpen&&!this.#K.disableOfflineQueue)this.#w.flushWaitingForReply(J);else this.#w.flushAll(J)}).on("connect",()=>this.emit("connect")).on("ready",()=>{this.emit("ready"),this.#x(),this.#f()}).on("reconnecting",()=>this.emit("reconnecting")).on("drain",()=>this.#f()).on("end",()=>this.emit("end"))}#O(){let $=async()=>{let Q=[],z=Symbol("Socket Initiator"),q=this.#w.resubscribe(z);if(q?.catch((Z)=>{if(Z.message&&Z.message.startsWith("MOVED"))this.emit("__MOVED",this._self.#w.removeAllPubSubListeners())}),q)Q.push(q);if(this.#X)Q.push(this.#w.monitor(this.#X,{typeMapping:this._commandOptions?.typeMapping,chainId:z,asap:!0}));if(Q.push(...await this.#I(z,!0)),Q.length)return this.#T(),Promise.all(Q)},J=new Fy.default($,this.#K.socket);return this.#U(J),J}#V;#x(){if(!this.#K.pingInterval||!this.#q.isReady)return;clearTimeout(this.#V),this.#V=setTimeout(()=>{if(!this.#q.isReady)return;this.sendCommand(["PING"]).then(($)=>this.emit("ping-interval",$)).catch(($)=>this.emit("error",$)).finally(()=>this.#x())},this.#K.pingInterval)}withCommandOptions($){let J=Object.create(this._self);return J._commandOptions=$,J}_commandOptionsProxy($,J){let Q=Object.create(this._self);return Q._commandOptions=Object.create(this._commandOptions??null),Q._commandOptions[$]=J,Q}withTypeMapping($){return this._commandOptionsProxy("typeMapping",$)}withAbortSignal($){return this._commandOptionsProxy("abortSignal",$)}asap(){return this._commandOptionsProxy("asap",!0)}legacy(){return new Py.RedisLegacyClient(this)}createPool($){return by.RedisClientPool.create(this._self.#K,$)}duplicate($){return new(Object.getPrototypeOf(this)).constructor({...this._self.#K,commandOptions:this._commandOptions,...$})}async connect(){return await this._self.#q.connect(),this}_ejectSocket(){let $=this._self.#q;return this._self.#q=null,$.removeAllListeners(),$}_insertSocket($){if(this._self.#q)this._self._ejectSocket().destroy();this._self.#q=$,this._self.#U(this._self.#q)}_maintenanceUpdate($){this._self.#q.setMaintenanceTimeout($.relaxedSocketTimeout),this._self.#w.setMaintenanceCommandTimeout($.relaxedCommandTimeout)}_pause(){this._self.#G=!0}_unpause(){this._self.#G=!1,this._self.#f()}async _executeCommand($,J,Q,z){let q=this._self.#F,Z=this._self.#K.commandOptions===Q,W=()=>{return this.sendCommand(J.redisArgs,Q)};if(q&&$.CACHEABLE&&Z)return await q.handleCache(this._self,J,W,z,Q?.typeMapping);else{let V=await W();if(z)return z(V,J.preserve,Q?.typeMapping);return V}}async _executeScript($,J,Q,z){let q=J.redisArgs,Z;try{Z=await this.sendCommand(q,Q)}catch(W){if(!W?.message?.startsWith?.("NOSCRIPT"))throw W;q[0]="EVAL",q[1]=$.SCRIPT,Z=await this.sendCommand(q,Q)}return z?z(Z,J.preserve,Q?.typeMapping):Z}sendCommand($,J){if(!this._self.#q.isOpen)return Promise.reject(new S0.ClientClosedError);else if(!this._self.#q.isReady&&this._self.#K.disableOfflineQueue)return Promise.reject(new S0.ClientOfflineError);let Q={...this._self._commandOptions,...J},z=this._self.#w.addCommand($,Q);return this._self.#D(),z}async SELECT($){await this.sendCommand(["SELECT",$.toString()]),this._self.#W=$}select=this.SELECT;#N($){if($===void 0)return Promise.resolve();return this.#D(),$}SUBSCRIBE($,J,Q){return this._self.#N(this._self.#w.subscribe(K$.PUBSUB_TYPE.CHANNELS,$,J,Q))}subscribe=this.SUBSCRIBE;UNSUBSCRIBE($,J,Q){return this._self.#N(this._self.#w.unsubscribe(K$.PUBSUB_TYPE.CHANNELS,$,J,Q))}unsubscribe=this.UNSUBSCRIBE;PSUBSCRIBE($,J,Q){return this._self.#N(this._self.#w.subscribe(K$.PUBSUB_TYPE.PATTERNS,$,J,Q))}pSubscribe=this.PSUBSCRIBE;PUNSUBSCRIBE($,J,Q){return this._self.#N(this._self.#w.unsubscribe(K$.PUBSUB_TYPE.PATTERNS,$,J,Q))}pUnsubscribe=this.PUNSUBSCRIBE;SSUBSCRIBE($,J,Q){return this._self.#N(this._self.#w.subscribe(K$.PUBSUB_TYPE.SHARDED,$,J,Q))}sSubscribe=this.SSUBSCRIBE;SUNSUBSCRIBE($,J,Q){return this._self.#N(this._self.#w.unsubscribe(K$.PUBSUB_TYPE.SHARDED,$,J,Q))}sUnsubscribe=this.SUNSUBSCRIBE;async WATCH($){let J=await this._self.sendCommand((0,n0.pushVariadicArguments)(["WATCH"],$));return this._self.#Y??=this._self.socketEpoch,J}watch=this.WATCH;async UNWATCH(){let $=await this._self.sendCommand(["UNWATCH"]);return this._self.#Y=void 0,$}unwatch=this.UNWATCH;getPubSubListeners($){return this._self.#w.getPubSubListeners($)}extendPubSubChannelListeners($,J,Q){return this._self.#N(this._self.#w.extendPubSubChannelListeners($,J,Q))}extendPubSubListeners($,J){return this._self.#N(this._self.#w.extendPubSubListeners($,J))}#T(){if(this.#G)return;this.#q.write(this.#w.commandsToWrite())}#C;#D(){if(!this.#q.isReady||this.#C)return;this.#C=setImmediate(()=>{this.#T(),this.#C=void 0})}#f(){if(!this.#w.isWaitingToWrite())return;this.#D()}async _executePipeline($,J){if(!this._self.#q.isOpen)return Promise.reject(new S0.ClientClosedError);let Q=Symbol("Pipeline Chain"),z=Promise.all($.map(({args:Z})=>this._self.#w.addCommand(Z,{chainId:Q,typeMapping:this._commandOptions?.typeMapping})));this._self.#D();let q=await z;if(J!==void 0)this._self.#W=J;return q}async _executeMulti($,J){let Q=this._self.#B;this._self.#B=void 0;let z=this._self.#Y;if(this._self.#Y=void 0,!this._self.#q.isOpen)throw new S0.ClientClosedError;if(Q)throw new S0.WatchError(Q);if(z&&z!==this._self.socketEpoch)throw new S0.WatchError("Client reconnected after WATCH");let q=this._commandOptions?.typeMapping,Z=Symbol("MULTI Chain"),W=[this._self.#w.addCommand(["MULTI"],{chainId:Z})];for(let{args:F}of $)W.push(this._self.#w.addCommand(F,{chainId:Z,typeMapping:q}));W.push(this._self.#w.addCommand(["EXEC"],{chainId:Z})),this._self.#D();let V=await Promise.all(W),Y=V[V.length-1];if(Y===null)throw new S0.WatchError;if(J!==void 0)this._self.#W=J;return Y}MULTI(){return new this.Multi(this._executeMulti.bind(this),this._executePipeline.bind(this),this._commandOptions?.typeMapping)}multi=this.MULTI;async*scanIterator($){let J=$?.cursor??"0";do{let Q=await this.scan(J,$);J=Q.cursor,yield Q.keys}while(J!=="0")}async*hScanIterator($,J){let Q=J?.cursor??"0";do{let z=await this.hScan($,Q,J);Q=z.cursor,yield z.entries}while(Q!=="0")}async*hScanValuesIterator($,J){let Q=J?.cursor??"0";do{let z=await this.hScanNoValues($,Q,J);Q=z.cursor,yield z.fields}while(Q!=="0")}async*hScanNoValuesIterator($,J){let Q=J?.cursor??"0";do{let z=await this.hScanNoValues($,Q,J);Q=z.cursor,yield z.fields}while(Q!=="0")}async*sScanIterator($,J){let Q=J?.cursor??"0";do{let z=await this.sScan($,Q,J);Q=z.cursor,yield z.members}while(Q!=="0")}async*zScanIterator($,J){let Q=J?.cursor??"0";do{let z=await this.zScan($,Q,J);Q=z.cursor,yield z.members}while(Q!=="0")}async MONITOR($){let J=this._self.#w.monitor($,{typeMapping:this._commandOptions?.typeMapping});this._self.#D(),await J,this._self.#X=$}monitor=this.MONITOR;async reset(){let $=Symbol("Reset Chain"),J=[this._self.#w.reset($)],Q=this._self.#K?.database??0;this._self.#H?.dispose(),this._self.#H=null,J.push(...await this._self.#I($,!1)),this._self.#D(),await Promise.all(J),this._self.#W=Q,this._self.#X=void 0,this._self.#B=void 0,this._self.#Y=void 0}resetIfDirty(){let $=!1;if(this._self.#W!==(this._self.#K?.database??0))console.warn("Returning a client with a different selected DB"),$=!0;if(this._self.#X)console.warn("Returning a client with active MONITOR"),$=!0;if(this._self.#w.isPubSubActive)console.warn("Returning a client with active PubSub"),$=!0;if(this._self.#B||this._self.#Y)console.warn("Returning a client with active WATCH"),$=!0;if($)return this.reset()}QUIT(){return this._self.#H?.dispose(),this._self.#H=null,this._self.#q.quit(async()=>{clearTimeout(this._self.#V);let $=this._self.#w.addCommand(["QUIT"]);return this._self.#D(),$})}quit=this.QUIT;disconnect(){return Promise.resolve(this.destroy())}close(){return new Promise(($)=>{if(clearTimeout(this._self.#V),this._self.#q.close(),this._self.#F?.onClose(),this._self.#w.isEmpty())return this._self.#q.destroySocket(),$();let J=()=>{if(!this._self.#w.isEmpty())return;this._self.#q.off("data",J),this._self.#q.destroySocket(),$()};this._self.#q.on("data",J),this._self.#H?.dispose(),this._self.#H=null})}destroy(){clearTimeout(this._self.#V),this._self.#w.flushAll(new S0.DisconnectsClientError),this._self.#q.destroy(),this._self.#F?.onClose(),this._self.#H?.dispose(),this._self.#H=null}ref(){this._self.#q.ref()}unref(){this._self.#q.unref()}}y=J8;v6.default=J8});var _P=w((Zr,Q8)=>{var yP=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],Ny=function(J){var Q,z=0,q=0,Z=[],W=J.length;for(;z<W;z++)if(Q=J.charCodeAt(z),Q<128)Z[q++]=Q;else if(Q<2048)Z[q++]=Q>>6|192,Z[q++]=Q&63|128;else if((Q&64512)===55296&&z+1<J.length&&(J.charCodeAt(z+1)&64512)===56320)Q=65536+((Q&1023)<<10)+(J.charCodeAt(++z)&1023),Z[q++]=Q>>18|240,Z[q++]=Q>>12&63|128,Z[q++]=Q>>6&63|128,Z[q++]=Q&63|128;else Z[q++]=Q>>12|224,Z[q++]=Q>>6&63|128,Z[q++]=Q&63|128;return Z},uP=Q8.exports=function(J){var Q,z=0,q=-1,Z=0,W=0,V=typeof J==="string"?Ny(J):J,Y=V.length;while(z<Y){if(Q=V[z++],q===-1){if(Q===123)q=z}else if(Q!==125)W=yP[(Q^W>>8)&255]^W<<8;else if(z-1!==q)return W&16383;Z=yP[(Q^Z>>8)&255]^Z<<8}return Z&16383};Q8.exports.generateMulti=function(J){var Q=1,z=J.length,q=uP(J[0]);while(Q<z)if(uP(J[Q++])!==q)return-1;return q}});var lP=w((G6)=>{var dP=G6&&G6.__importDefault||function($){return $&&$.__esModule?$:{default:$}},q8;Object.defineProperty(G6,"__esModule",{value:!0});var Iy=c(),Oy=dP(w$()),P0=Y6(),z8=dP(_P()),cP=z$();class w8{static#$=16384;#J;#Q;#z;slots=Array(q8.#$);masters=[];replicas=[];nodeByAddress=new Map;pubSubNode;clientSideCache;#Z=!1;get isOpen(){return this.#Z}#K($){if($?.clientSideCache&&$?.RESP!==3)throw Error("Client Side Caching is only supported with RESP3")}constructor($,J){if(this.#K($),this.#J=$,$?.clientSideCache)if($.clientSideCache instanceof cP.PooledClientSideCacheProvider)this.clientSideCache=$.clientSideCache;else this.clientSideCache=new cP.BasicPooledClientSideCache($.clientSideCache);this.#Q=Oy.default.factory(this.#J),this.#z=J}async connect(){if(this.#Z)throw Error("Cluster already open");this.#Z=!0;try{await this.#q(),this.#z("connect")}catch($){throw this.#Z=!1,$}}async#q(){let $=Math.floor(Math.random()*this.#J.rootNodes.length);for(let J=$;J<this.#J.rootNodes.length;J++){if(!this.#Z)throw Error("Cluster closed");if(await this.#W(this.#J.rootNodes[J]))return}for(let J=0;J<$;J++){if(!this.#Z)throw Error("Cluster closed");if(await this.#W(this.#J.rootNodes[J]))return}throw new Iy.RootNodesUnavailableError}#w(){this.slots=Array(q8.#$),this.masters=[],this.replicas=[],this._randomNodeIterator=void 0}async#W($){this.clientSideCache?.clear(),this.clientSideCache?.disable();try{let J=new Set,Q=[],z=this.#J.minimizeConnections!==!0,q=await this.#X($);this.#w();for(let{from:Z,to:W,master:V,replicas:Y}of q){let F={master:this.#F(V,!1,z,J,Q)};if(this.#J.useReplicas)F.replicas=Y.map((H)=>this.#F(H,!0,z,J,Q));for(let H=Z;H<=W;H++)this.slots[H]=F}if(this.pubSubNode&&!J.has(this.pubSubNode.address)){let Z=this.pubSubNode.client.getPubSubListeners(P0.PUBSUB_TYPE.CHANNELS),W=this.pubSubNode.client.getPubSubListeners(P0.PUBSUB_TYPE.PATTERNS);if(this.pubSubNode.client.destroy(),Z.size||W.size)Q.push(this.#U({[P0.PUBSUB_TYPE.CHANNELS]:Z,[P0.PUBSUB_TYPE.PATTERNS]:W}))}for(let[Z,W]of this.nodeByAddress.entries()){if(J.has(Z))continue;if(W.client)W.client.destroy();let{pubSub:V}=W;if(V)V.client.destroy();this.nodeByAddress.delete(Z)}return await Promise.all(Q),this.clientSideCache?.enable(),!0}catch(J){return this.#z("error",J),!1}}async#X($){let J=this.#Y($);J.socket??={},J.socket.reconnectStrategy=!1,J.RESP=this.#J.RESP,J.commandOptions=void 0;let Q=await this.#Q(J).on("error",(z)=>this.#z("error",z)).connect();try{return await Q.clusterSlots()}finally{Q.destroy()}}#B($){switch(typeof this.#J.nodeAddressMap){case"object":return this.#J.nodeAddressMap[$];case"function":return this.#J.nodeAddressMap($)}}#Y($){if(!this.#J.defaults)return $;let J;if(this.#J.defaults.socket)J={...this.#J.defaults.socket,...$?.socket};else J=$?.socket;return{...this.#J.defaults,...$,socket:J}}#F($,J,Q,z,q){let Z=`${$.host}:${$.port}`,W=this.nodeByAddress.get(Z);if(!W){if(W={...$,address:Z,readonly:J,client:void 0,connectPromise:void 0},Q)q.push(this.#G(W));this.nodeByAddress.set(Z,W)}if(!z.has(Z))z.add(Z),(J?this.replicas:this.masters).push(W);return W}#H($,J=$.readonly){let Q=this.#B($.address)??{host:$.host,port:$.port},z=Object.freeze({host:Q.host,port:Q.port}),q=this.#z,Z=this.#Q(this.#Y({clientSideCache:this.clientSideCache,RESP:this.#J.RESP,socket:Q,readonly:J})).on("error",(W)=>q("node-error",W,z)).on("reconnecting",()=>q("node-reconnecting",z)).once("ready",()=>q("node-ready",z)).once("connect",()=>q("node-connect",z)).once("end",()=>q("node-disconnect",z)).on("__MOVED",async(W)=>{await this.rediscover(Z),this.#z("__resubscribeAllPubSubListeners",W)});return Z}#G($,J){let Q=$.client=this.#H($,J);return $.connectPromise=Q.connect().finally(()=>$.connectPromise=void 0)}nodeClient($){return $.connectPromise??$.client??this.#G($)}#j;async rediscover($){return this.#j??=this.#b($).finally(()=>{this.#j=void 0}),this.#j}async#b($){if(await this.#W($.options))return;return this.#q()}quit(){return this.#v(($)=>$.quit())}disconnect(){return this.#v(($)=>$.disconnect())}close(){return this.#v(($)=>$.close())}destroy(){this.#Z=!1;for(let $ of this.#P())$.destroy();if(this.pubSubNode)this.pubSubNode.client.destroy(),this.pubSubNode=void 0;this.#w(),this.nodeByAddress.clear(),this.#z("disconnect")}*#P(){for(let $ of this.masters){if($.client)yield $.client;if($.pubSub)yield $.pubSub.client}for(let $ of this.replicas)if($.client)yield $.client}async#v($){this.#Z=!1;let J=[];for(let Q of this.#P())J.push($(Q));if(this.pubSubNode)J.push($(this.pubSubNode.client)),this.pubSubNode=void 0;this.#w(),this.nodeByAddress.clear(),await Promise.allSettled(J),this.#z("disconnect")}getClient($,J){if(!$)return this.nodeClient(this.getRandomNode());let Q=(0,z8.default)($);if(!J)return this.nodeClient(this.slots[Q].master);return this.nodeClient(this.getSlotRandomNode(Q))}*#I(){if(this.masters.length+this.replicas.length===0)return;let $=Math.floor(Math.random()*(this.masters.length+this.replicas.length));if($<this.masters.length){do yield this.masters[$];while(++$<this.masters.length);for(let J of this.replicas)yield J}else{$-=this.masters.length;do yield this.replicas[$];while(++$<this.replicas.length)}while(!0){for(let J of this.masters)yield J;for(let J of this.replicas)yield J}}_randomNodeIterator;getRandomNode(){return this._randomNodeIterator??=this.#I(),this._randomNodeIterator.next().value}*#h($){let J=Math.floor(Math.random()*(1+$.replicas.length));if(J<$.replicas.length)do yield $.replicas[J];while(++J<$.replicas.length);while(!0){yield $.master;for(let Q of $.replicas)yield Q}}getSlotRandomNode($){let J=this.slots[$];if(!J.replicas?.length)return J.master;return J.nodesIterator??=this.#h(J),J.nodesIterator.next().value}getMasterByAddress($){let J=this.nodeByAddress.get($);if(!J)return;return this.nodeClient(J)}getPubSubClient(){if(!this.pubSubNode)return this.#U();return this.pubSubNode.connectPromise??this.pubSubNode.client}async#U($){let J=Math.floor(Math.random()*(this.masters.length+this.replicas.length)),Q=J<this.masters.length?this.masters[J]:this.replicas[J-this.masters.length],z=this.#H(Q,!1);return this.pubSubNode={address:Q.address,client:z,connectPromise:z.connect().then(async(q)=>{if($)await Promise.all([q.extendPubSubListeners(P0.PUBSUB_TYPE.CHANNELS,$[P0.PUBSUB_TYPE.CHANNELS]),q.extendPubSubListeners(P0.PUBSUB_TYPE.PATTERNS,$[P0.PUBSUB_TYPE.PATTERNS])]);return this.pubSubNode.connectPromise=void 0,q}).catch((q)=>{throw this.pubSubNode=void 0,q})},this.pubSubNode.connectPromise}async executeUnsubscribeCommand($){let J=await this.getPubSubClient();if(await $(J),!J.isPubSubActive)J.destroy(),this.pubSubNode=void 0}getShardedPubSubClient($){let{master:J}=this.slots[(0,z8.default)($)];if(!J.pubSub)return this.#O(J);return J.pubSub.connectPromise??J.pubSub.client}async#O($){let J=this.#H($,!1).on("server-sunsubscribe",async(Q,z)=>{try{await this.rediscover(J),await(await this.getShardedPubSubClient(Q)).extendPubSubChannelListeners(P0.PUBSUB_TYPE.SHARDED,Q,z)}catch(q){this.#z("sharded-shannel-moved-error",q,Q,z)}});return $.pubSub={client:J,connectPromise:J.connect().then((Q)=>{return $.pubSub.connectPromise=void 0,Q}).catch((Q)=>{throw $.pubSub=void 0,Q})},$.pubSub.connectPromise}async executeShardedUnsubscribeCommand($,J){let{master:Q}=this.slots[(0,z8.default)($)];if(!Q.pubSub)return;let z=Q.pubSub.connectPromise?await Q.pubSub.connectPromise:Q.pubSub.client;if(await J(z),!z.isPubSubActive)z.destroy(),Q.pubSub=void 0}}q8=w8;G6.default=w8});var iP=w((P6)=>{var mP=P6&&P6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(P6,"__esModule",{value:!0});var Dy=mP(i()),Ay=mP(B6()),W$=t(),h7=d();class a0{static#$($,J){let Q=(0,W$.getTransformReply)($,J);return function(...z){let q=new h7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;Z.preserve=q.preserve;let W=q.firstKey;return this.addCommand(W,$.IS_READ_ONLY,Z,Q)}}static#J($,J){let Q=(0,W$.getTransformReply)($,J);return function(...z){let q=new h7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;Z.preserve=q.preserve;let W=q.firstKey;return this._self.addCommand(W,$.IS_READ_ONLY,Z,Q)}}static#Q($,J,Q){let z=(0,W$.functionArgumentsPrefix)($,J),q=(0,W$.getTransformReply)(J,Q);return function(...Z){let W=new h7.BasicCommandParser;W.push(...z),J.parseCommand(W,...Z);let V=W.redisArgs;V.preserve=W.preserve;let Y=W.firstKey;return this._self.addCommand(Y,J.IS_READ_ONLY,V,q)}}static#z($,J){let Q=(0,W$.getTransformReply)($,J);return function(...z){let q=new h7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;Z.preserve=q.preserve;let W=q.firstKey;return this.#B(W,$.IS_READ_ONLY,$,Z,Q)}}static extend($){return(0,W$.attachConfig)({BaseClass:a0,commands:Dy.default,createCommand:a0.#$,createModuleCommand:a0.#J,createFunctionCommand:a0.#Q,createScriptCommand:a0.#z,config:$})}#Z;#K;#q;#w;#W=!0;constructor($,J,Q,z){this.#Z=new Ay.default(z),this.#K=$,this.#q=J,this.#w=Q}#X($,J){this.#w??=$,this.#W&&=J}addCommand($,J,Q,z){return this.#X($,J),this.#Z.addCommand(Q,z),this}#B($,J,Q,z,q){return this.#X($,J),this.#Z.addScript(Q,z,q),this}async exec($=!1){if($)return this.execAsPipeline();return this.#Z.transformReplies(await this.#K(this.#w,this.#W,this.#Z.queue))}EXEC=this.exec;execTyped($=!1){return this.exec($)}async execAsPipeline(){if(this.#Z.queue.length===0)return[];return this.#Z.transformReplies(await this.#q(this.#w,this.#W,this.#Z.queue))}execAsPipelineTyped(){return this.execAsPipeline()}}P6.default=a0});var nP=w((b6)=>{var I7=b6&&b6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(b6,"__esModule",{value:!0});var xy=I7(i()),Cy=C("node:events"),o0=t(),Ty=I7(lP()),Ly=I7(iP()),fy=c(),N7=d(),My=s7(),Sy=I7(G7());class o extends Cy.EventEmitter{static#$($,J){let Q=(0,o0.getTransformReply)($,J);return async function(...z){let q=new N7.BasicCommandParser;return $.parseCommand(q,...z),this._self._execute(q.firstKey,$.IS_READ_ONLY,this._commandOptions,(Z,W)=>Z._executeCommand($,q,W,Q))}}static#J($,J){let Q=(0,o0.getTransformReply)($,J);return async function(...z){let q=new N7.BasicCommandParser;return $.parseCommand(q,...z),this._self._execute(q.firstKey,$.IS_READ_ONLY,this._self._commandOptions,(Z,W)=>Z._executeCommand($,q,W,Q))}}static#Q($,J,Q){let z=(0,o0.functionArgumentsPrefix)($,J),q=(0,o0.getTransformReply)(J,Q);return async function(...Z){let W=new N7.BasicCommandParser;return W.push(...z),J.parseCommand(W,...Z),this._self._execute(W.firstKey,J.IS_READ_ONLY,this._self._commandOptions,(V,Y)=>V._executeCommand(J,W,Y,q))}}static#z($,J){let Q=(0,o0.scriptArgumentsPrefix)($),z=(0,o0.getTransformReply)($,J);return async function(...q){let Z=new N7.BasicCommandParser;return Z.push(...Q),$.parseCommand(Z,...q),this._self._execute(Z.firstKey,$.IS_READ_ONLY,this._commandOptions,(W,V)=>W._executeScript($,Z,V,z))}}static#Z=new Sy.default;static factory($){let J=o.#Z.get($);if(!J)J=(0,o0.attachConfig)({BaseClass:o,commands:xy.default,createCommand:o.#$,createModuleCommand:o.#J,createFunctionCommand:o.#Q,createScriptCommand:o.#z,config:$}),J.prototype.Multi=Ly.default.extend($),o.#Z.set($,J);return(Q)=>{return Object.create(new J(Q))}}static create($){return o.factory($)($)}_options;_slots;_self=this;_commandOptions;get slots(){return this._self._slots.slots}get clientSideCache(){return this._self._slots.clientSideCache}get masters(){return this._self._slots.masters}get replicas(){return this._self._slots.replicas}get nodeByAddress(){return this._self._slots.nodeByAddress}get pubSubNode(){return this._self._slots.pubSubNode}get isOpen(){return this._self._slots.isOpen}constructor($){super();if(this._options=$,this._slots=new Ty.default($,this.emit.bind(this)),this.on("__resubscribeAllPubSubListeners",this.resubscribeAllPubSubListeners.bind(this)),$?.commandOptions)this._commandOptions=$.commandOptions}duplicate($){return new(Object.getPrototypeOf(this)).constructor({...this._self._options,commandOptions:this._commandOptions,...$})}async connect(){return await this._self._slots.connect(),this}withCommandOptions($){let J=Object.create(this);return J._commandOptions=$,J}_commandOptionsProxy($,J){let Q=Object.create(this);return Q._commandOptions=Object.create(this._commandOptions??null),Q._commandOptions[$]=J,Q}withTypeMapping($){return this._commandOptionsProxy("typeMapping",$)}_handleAsk($){return async(J,Q)=>{let z=Symbol("asking chain"),q=Q?{...Q}:{};return q.chainId=z,(await Promise.all([J.sendCommand([My.ASKING_CMD],{chainId:z}),$(J,q)]))[1]}}async _execute($,J,Q,z){let q=this._options.maxCommandRedirections??16,Z=await this._slots.getClient($,J),W=0,V=z;while(!0)try{return await V(Z,Q)}catch(Y){if(V=z,++W>q||!(Y instanceof Error))throw Y;if(Y.message.startsWith("ASK")){let F=Y.message.substring(Y.message.lastIndexOf(" ")+1),H=await this._slots.getMasterByAddress(F);if(!H)await this._slots.rediscover(Z),H=await this._slots.getMasterByAddress(F);if(!H)throw Error(`Cannot find node ${F}`);Z=H,V=this._handleAsk(z);continue}if(Y.message.startsWith("MOVED")){await this._slots.rediscover(Z),Z=await this._slots.getClient($,J);continue}throw Y}}async sendCommand($,J,Q,z){let q={...this._self._commandOptions,...z};return this._self._execute($,J,q,(Z,W)=>Z.sendCommand(Q,W))}MULTI($){return new this.Multi(async(J,Q,z)=>{return(await this._self._slots.getClient(J,Q))._executeMulti(z)},async(J,Q,z)=>{return(await this._self._slots.getClient(J,Q))._executePipeline(z)},$,this._commandOptions?.typeMapping)}multi=this.MULTI;async SUBSCRIBE($,J,Q){return(await this._self._slots.getPubSubClient()).SUBSCRIBE($,J,Q)}subscribe=this.SUBSCRIBE;async UNSUBSCRIBE($,J,Q){return this._self._slots.executeUnsubscribeCommand((z)=>z.UNSUBSCRIBE($,J,Q))}unsubscribe=this.UNSUBSCRIBE;async PSUBSCRIBE($,J,Q){return(await this._self._slots.getPubSubClient()).PSUBSCRIBE($,J,Q)}pSubscribe=this.PSUBSCRIBE;async PUNSUBSCRIBE($,J,Q){return this._self._slots.executeUnsubscribeCommand((z)=>z.PUNSUBSCRIBE($,J,Q))}pUnsubscribe=this.PUNSUBSCRIBE;async SSUBSCRIBE($,J,Q){let z=this._self._options.maxCommandRedirections??16,q=Array.isArray($)?$[0]:$,Z=await this._self._slots.getShardedPubSubClient(q);for(let W=0;;W++)try{return await Z.SSUBSCRIBE($,J,Q)}catch(V){if(++W>z||!(V instanceof fy.ErrorReply))throw V;if(V.message.startsWith("MOVED")){await this._self._slots.rediscover(Z),Z=await this._self._slots.getShardedPubSubClient(q);continue}throw V}}sSubscribe=this.SSUBSCRIBE;SUNSUBSCRIBE($,J,Q){return this._self._slots.executeShardedUnsubscribeCommand(Array.isArray($)?$[0]:$,(z)=>z.SUNSUBSCRIBE($,J,Q))}resubscribeAllPubSubListeners($){for(let[J,Q]of $.CHANNELS)Q.buffers.forEach((z)=>{this.subscribe(J,z,!0)}),Q.strings.forEach((z)=>{this.subscribe(J,z)});for(let[J,Q]of $.PATTERNS)Q.buffers.forEach((z)=>{this.pSubscribe(J,z,!0)}),Q.strings.forEach((z)=>{this.pSubscribe(J,z)});for(let[J,Q]of $.SHARDED)Q.buffers.forEach((z)=>{this.sSubscribe(J,z,!0)}),Q.strings.forEach((z)=>{this.sSubscribe(J,z)})}sUnsubscribe=this.SUNSUBSCRIBE;quit(){return this._self._slots.quit()}disconnect(){return this._self._slots.disconnect()}close(){return this._self._slots.clientSideCache?.onPoolClose(),this._self._slots.close()}destroy(){return this._self._slots.clientSideCache?.onPoolClose(),this._self._slots.destroy()}nodeClient($){return this._self._slots.nodeClient($)}getRandomNode(){return this._self._slots.getRandomNode()}getSlotRandomNode($){return this._self._slots.getSlotRandomNode($)}getMasters(){return this.masters}getSlotMaster($){return this.slots[$].master}}b6.default=o});var pP=w((aP)=>{Object.defineProperty(aP,"__esModule",{value:!0});aP.createScriptCommand=aP.createModuleCommand=aP.createFunctionCommand=aP.createCommand=aP.clientSocketToNode=aP.createNodeList=aP.parseNode=void 0;var O7=d(),V$=t();function tP($){if($.flags.includes("s_down")||$.flags.includes("disconnected")||$.flags.includes("failover_in_progress"))return;return{host:$.ip,port:Number($.port)}}aP.parseNode=tP;function Ey($){var J=[];for(let Q of $){let z=tP(Q);if(z===void 0)continue;J.push(z)}return J}aP.createNodeList=Ey;function ky($){let J=$;return{host:J.host,port:J.port}}aP.clientSocketToNode=ky;function gy($,J){let Q=(0,V$.getTransformReply)($,J);return async function(...z){let q=new O7.BasicCommandParser;return $.parseCommand(q,...z),this._self._execute($.IS_READ_ONLY,(Z)=>Z._executeCommand($,q,this.commandOptions,Q))}}aP.createCommand=gy;function Ry($,J,Q){let z=(0,V$.functionArgumentsPrefix)($,J),q=(0,V$.getTransformReply)(J,Q);return async function(...Z){let W=new O7.BasicCommandParser;return W.push(...z),J.parseCommand(W,...Z),this._self._execute(J.IS_READ_ONLY,(V)=>V._executeCommand(J,W,this._self.commandOptions,q))}}aP.createFunctionCommand=Ry;function yy($,J){let Q=(0,V$.getTransformReply)($,J);return async function(...z){let q=new O7.BasicCommandParser;return $.parseCommand(q,...z),this._self._execute($.IS_READ_ONLY,(Z)=>Z._executeCommand($,q,this._self.commandOptions,Q))}}aP.createModuleCommand=yy;function uy($,J){let Q=(0,V$.scriptArgumentsPrefix)($),z=(0,V$.getTransformReply)($,J);return async function(...q){let Z=new O7.BasicCommandParser;return Z.push(...Q),$.parseCommand(Z,...q),this._self._execute($.IS_READ_ONLY,(W)=>W._executeScript($,Z,this.commandOptions,z))}}aP.createScriptCommand=uy});var eP=w((U6)=>{var rP=U6&&U6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(U6,"__esModule",{value:!0});var ny=rP(i()),sP=rP(B6()),Y$=t(),D7=d();class p0{static _createCommand($,J){let Q=(0,Y$.getTransformReply)($,J);return function(...z){let q=new D7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;return Z.preserve=q.preserve,this.addCommand($.IS_READ_ONLY,Z,Q)}}static _createModuleCommand($,J){let Q=(0,Y$.getTransformReply)($,J);return function(...z){let q=new D7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;return Z.preserve=q.preserve,this._self.addCommand($.IS_READ_ONLY,Z,Q)}}static _createFunctionCommand($,J,Q){let z=(0,Y$.functionArgumentsPrefix)($,J),q=(0,Y$.getTransformReply)(J,Q);return function(...Z){let W=new D7.BasicCommandParser;W.push(...z),J.parseCommand(W,...Z);let V=W.redisArgs;return V.preserve=W.preserve,this._self.addCommand(J.IS_READ_ONLY,V,q)}}static _createScriptCommand($,J){let Q=(0,Y$.getTransformReply)($,J);return function(...z){let q=new D7.BasicCommandParser;$.parseCommand(q,...z);let Z=q.redisArgs;return Z.preserve=q.preserve,this.#Z($.IS_READ_ONLY,$,Z,Q)}}static extend($){return(0,Y$.attachConfig)({BaseClass:p0,commands:ny.default,createCommand:p0._createCommand,createModuleCommand:p0._createModuleCommand,createFunctionCommand:p0._createFunctionCommand,createScriptCommand:p0._createScriptCommand,config:$})}#$=new sP.default;#J;#Q=!0;constructor($,J){this.#$=new sP.default(J),this.#J=$}#z($){this.#Q&&=$}addCommand($,J,Q){return this.#z($),this.#$.addCommand(J,Q),this}#Z($,J,Q,z){return this.#z($),this.#$.addScript(J,Q,z),this}async exec($=!1){if($)return this.execAsPipeline();return this.#$.transformReplies(await this.#J._executeMulti(this.#Q,this.#$.queue))}EXEC=this.exec;execTyped($=!1){return this.exec($)}async execAsPipeline(){if(this.#$.queue.length===0)return[];return this.#$.transformReplies(await this.#J._executePipeline(this.#Q,this.#$.queue))}execAsPipelineTyped(){return this.execAsPipeline()}}U6.default=p0});var zb=w((X$)=>{var Jb=X$&&X$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(X$,"__esModule",{value:!0});X$.PubSubProxy=void 0;var ty=Jb(C("node:events")),E0=Y6(),$b=Jb(w$());class Qb extends ty.default{#$;#J;#Q;#z;#Z;constructor($,J){super();this.#$=$,this.#J=J}#K(){if(this.#Q===void 0)throw Error("pubSubProxy: didn't define node to do pubsub against");return new $b.default({...this.#$,socket:{...this.#$.socket,host:this.#Q.host,port:this.#Q.port}})}async#q($=!1){let J=this.#K().on("error",this.#J),Q=J.connect().then(async(z)=>{if(this.#z?.client!==z)return z.destroy(),this.#z?.connectPromise;if($&&this.#Z)await Promise.all([z.extendPubSubListeners(E0.PUBSUB_TYPE.CHANNELS,this.#Z[E0.PUBSUB_TYPE.CHANNELS]),z.extendPubSubListeners(E0.PUBSUB_TYPE.PATTERNS,this.#Z[E0.PUBSUB_TYPE.PATTERNS])]);if(this.#z.client!==z)return z.destroy(),this.#z?.connectPromise;return this.#z.connectPromise=void 0,z}).catch((z)=>{throw this.#z=void 0,z});return this.#z={client:J,connectPromise:Q},Q}#w(){if(!this.#z)return this.#q();return this.#z.connectPromise??this.#z.client}async changeNode($){if(this.#Q=$,!this.#z)return;if(this.#z.connectPromise===void 0)this.#Z={[E0.PUBSUB_TYPE.CHANNELS]:this.#z.client.getPubSubListeners(E0.PUBSUB_TYPE.CHANNELS),[E0.PUBSUB_TYPE.PATTERNS]:this.#z.client.getPubSubListeners(E0.PUBSUB_TYPE.PATTERNS)},this.#z.client.destroy();await this.#q(!0)}#W($){let J=this.#w();if(J instanceof $b.default)return $(J);return J.then((Q)=>{if(Q===void 0)return;return $(Q)}).catch((Q)=>{if(this.#z?.client.isPubSubActive)this.#z.client.destroy(),this.#z=void 0;throw Q})}subscribe($,J,Q){return this.#W((z)=>z.SUBSCRIBE($,J,Q))}#X($){return this.#W(async(J)=>{let Q=await $(J);if(!J.isPubSubActive)J.destroy(),this.#z=void 0;return Q})}async unsubscribe($,J,Q){return this.#X((z)=>z.UNSUBSCRIBE($,J,Q))}async pSubscribe($,J,Q){return this.#W((z)=>z.PSUBSCRIBE($,J,Q))}async pUnsubscribe($,J,Q){return this.#X((z)=>z.PUNSUBSCRIBE($,J,Q))}destroy(){if(this.#Z=void 0,this.#z===void 0)return;if(!this.#z.connectPromise)this.#z.client.destroy();this.#z=void 0}}X$.PubSubProxy=Qb});var wb=w((qb)=>{Object.defineProperty(qb,"__esModule",{value:!0});var ay=X();qb.default={parseCommand($,J){$.push("SENTINEL","MASTER",J)},transformReply:{2:ay.transformTuplesReply,3:void 0}}});var Kb=w((Zb)=>{Object.defineProperty(Zb,"__esModule",{value:!0});Zb.default={parseCommand($,J,Q,z,q){$.push("SENTINEL","MONITOR",J,Q,z,q)},transformReply:void 0}});var Vb=w((Wb)=>{Object.defineProperty(Wb,"__esModule",{value:!0});var sy=X();Wb.default={parseCommand($,J){$.push("SENTINEL","REPLICAS",J)},transformReply:{2:($,J,Q)=>{let z=$,q=[];return z.reduce((Z,W)=>{return Z.push((0,sy.transformTuplesReply)(W,void 0,Q)),Z},q)},3:void 0}}});var Xb=w((Yb)=>{Object.defineProperty(Yb,"__esModule",{value:!0});var ey=X();Yb.default={parseCommand($,J){$.push("SENTINEL","SENTINELS",J)},transformReply:{2:($,J,Q)=>{let z=$,q=[];return z.reduce((Z,W)=>{return Z.push((0,ey.transformTuplesReply)(W,void 0,Q)),Z},q)},3:void 0}}});var Hb=w((Fb)=>{Object.defineProperty(Fb,"__esModule",{value:!0});Fb.default={parseCommand($,J,Q){$.push("SENTINEL","SET",J);for(let z of Q)$.push(z.option,z.value)},transformReply:void 0}});var bb=w((h6)=>{var N6=h6&&h6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(h6,"__esModule",{value:!0});var Bb=N6(wb()),jb=N6(Kb()),vb=N6(Vb()),Gb=N6(Xb()),Pb=N6(Hb());h6.default={SENTINEL_SENTINELS:Gb.default,sentinelSentinels:Gb.default,SENTINEL_MASTER:Bb.default,sentinelMaster:Bb.default,SENTINEL_REPLICAS:vb.default,sentinelReplicas:vb.default,SENTINEL_MONITOR:jb.default,sentinelMonitor:jb.default,SENTINEL_SET:Pb.default,sentinelSet:Pb.default}});var Ub=w((I6)=>{var Qu=I6&&I6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(I6,"__esModule",{value:!0});var zu=Qu(bb());I6.default={sentinel:zu.default}});var Db=w((Ib)=>{Object.defineProperty(Ib,"__esModule",{value:!0});Ib.WaitQueue=void 0;var hb=V7();class Nb{#$=new hb.SinglyLinkedList;#J=new hb.SinglyLinkedList;push($){let J=this.#J.shift();if(J!==void 0){J($);return}this.#$.push($)}shift(){return this.#$.shift()}wait(){return new Promise(($)=>this.#J.push($))}}Ib.WaitQueue=Nb});var Mb=w((b0)=>{var C7=b0&&b0.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(b0,"__esModule",{value:!0});b0.RedisSentinelFactory=b0.RedisSentinelClient=void 0;var Z8=C("node:events"),F$=C7(w$()),xb=t(),Cb=C7(i()),D=pP(),Tb=C7(eP()),qu=zb(),wu=C("node:timers/promises"),A7=C7(Ub()),Zu=Db(),Ab=z$();class H${#$;#J;_self;get isOpen(){return this._self.#J.isOpen}get isReady(){return this._self.#J.isReady}get commandOptions(){return this._self.#Q}#Q;constructor($,J,Q){this._self=this,this.#J=$,this.#$=J,this.#Q=Q}static factory($){let J=(0,xb.attachConfig)({BaseClass:H$,commands:Cb.default,createCommand:D.createCommand,createModuleCommand:D.createModuleCommand,createFunctionCommand:D.createFunctionCommand,createScriptCommand:D.createScriptCommand,config:$});return J.prototype.Multi=Tb.default.extend($),(Q,z,q)=>{return Object.create(new J(Q,z,q))}}static create($,J,Q,z){return H$.factory($)(J,Q,z)}withCommandOptions($){let J=Object.create(this);return J._commandOptions=$,J}_commandOptionsProxy($,J){let Q=Object.create(this);return Q._commandOptions=Object.create(this._self.#Q??null),Q._commandOptions[$]=J,Q}withTypeMapping($){return this._commandOptionsProxy("typeMapping",$)}async _execute($,J){if(this._self.#$===void 0)throw Error("Attempted execution on released RedisSentinelClient lease");return await this._self.#J.execute(J,this._self.#$)}async sendCommand($,J,Q){return this._execute($,(z)=>z.sendCommand(J,Q))}async _executePipeline($,J){return this._execute($,(Q)=>Q._executePipeline(J))}async _executeMulti($,J){return this._execute($,(Q)=>Q._executeMulti(J))}MULTI(){return new this.Multi(this)}multi=this.MULTI;WATCH($){if(this._self.#$===void 0)throw Error("Attempted execution on released RedisSentinelClient lease");return this._execute(!1,(J)=>J.watch($))}watch=this.WATCH;UNWATCH(){if(this._self.#$===void 0)throw Error("Attempted execution on released RedisSentinelClient lease");return this._execute(!1,($)=>$.unwatch())}unwatch=this.UNWATCH;release(){if(this._self.#$===void 0)throw Error("RedisSentinelClient lease already released");let $=this._self.#J.releaseClientLease(this._self.#$);return this._self.#$=void 0,$}}b0.RedisSentinelClient=H$;class x7 extends Z8.EventEmitter{_self;#$;#J;get isOpen(){return this._self.#$.isOpen}get isReady(){return this._self.#$.isReady}get commandOptions(){return this._self.#Q}#Q;#z=()=>{};#Z;#K=0;#q;get clientSideCache(){return this._self.#$.clientSideCache}constructor($){super();if(this._self=this,this.#J=$,$.commandOptions)this.#Q=$.commandOptions;this.#$=new Lb($),this.#$.on("error",(J)=>this.emit("error",J)),this.#$.on("topology-change",(J)=>{if(!this.emit("topology-change",J))this._self.#z(`RedisSentinel: re-emit for topology-change for ${J.type} event returned false`)})}static factory($){let J=(0,xb.attachConfig)({BaseClass:x7,commands:Cb.default,createCommand:D.createCommand,createModuleCommand:D.createModuleCommand,createFunctionCommand:D.createFunctionCommand,createScriptCommand:D.createScriptCommand,config:$});return J.prototype.Multi=Tb.default.extend($),(Q)=>{return Object.create(new J(Q))}}static create($){return x7.factory($)($)}withCommandOptions($){let J=Object.create(this);return J._commandOptions=$,J}_commandOptionsProxy($,J){let Q=Object.create(this);return Q._self.#Q={...this._self.#Q||{},[$]:J},Q}withTypeMapping($){return this._commandOptionsProxy("typeMapping",$)}async connect(){if(await this._self.#$.connect(),this._self.#J.reserveClient)this._self.#Z=await this._self.#$.getClientLease();return this}async _execute($,J){let Q;if(!$||!this._self.#$.useReplicas)if(this._self.#Z)Q=this._self.#Z;else this._self.#q??=await this._self.#$.getClientLease(),Q=this._self.#q,this._self.#K++;try{return await this._self.#$.execute(J,Q)}finally{if(Q!==void 0&&Q===this._self.#q&&--this._self.#K===0){let z=this._self.#$.releaseClientLease(Q);if(this._self.#q=void 0,z)await z}}}async use($){let J=await this._self.#$.getClientLease();try{return await $(H$.create(this._self.#J,this._self.#$,J,this._self.#Q))}finally{let Q=this._self.#$.releaseClientLease(J);if(Q)await Q}}async sendCommand($,J,Q){return this._execute($,(z)=>z.sendCommand(J,Q))}async _executePipeline($,J){return this._execute($,(Q)=>Q._executePipeline(J))}async _executeMulti($,J){return this._execute($,(Q)=>Q._executeMulti(J))}MULTI(){return new this.Multi(this)}multi=this.MULTI;async close(){return this._self.#$.close()}destroy(){return this._self.#$.destroy()}async SUBSCRIBE($,J,Q){return this._self.#$.subscribe($,J,Q)}subscribe=this.SUBSCRIBE;async UNSUBSCRIBE($,J,Q){return this._self.#$.unsubscribe($,J,Q)}unsubscribe=this.UNSUBSCRIBE;async PSUBSCRIBE($,J,Q){return this._self.#$.pSubscribe($,J,Q)}pSubscribe=this.PSUBSCRIBE;async PUNSUBSCRIBE($,J,Q){return this._self.#$.pUnsubscribe($,J,Q)}pUnsubscribe=this.PUNSUBSCRIBE;async acquire(){let $=await this._self.#$.getClientLease();return H$.create(this._self.#J,this._self.#$,$,this._self.#Q)}getSentinelNode(){return this._self.#$.getSentinelNode()}getMasterNode(){return this._self.#$.getMasterNode()}getReplicaNodes(){return this._self.#$.getReplicaNodes()}setTracer($){if($)this._self.#z=(J)=>{$.push(J)};else this._self.#z=()=>{};this._self.#$.setTracer($)}}b0.default=x7;class Lb extends Z8.EventEmitter{#$=!1;get isOpen(){return this.#$}#J=!1;get isReady(){return this.#J}#Q;#z;#Z;#K;#q;#w;#W=!1;#X=0;#B;#Y;#F=[];#H;#G;#j=[];#b=0;#P;get useReplicas(){return this.#P>0}#v;#I;#h;#U;#O=!1;#V=()=>{};#x;get clientSideCache(){return this.#x}#N($){if($?.clientSideCache&&$?.RESP!==3)throw Error("Client Side Caching is only supported with RESP3")}constructor($){super();if(this.#N($),this.#Q=$.name,this.#w=$.RESP,this.#B=Array.from($.sentinelRootNodes),this.#I=$.maxCommandRediscovers??16,this.#G=$.masterPoolSize??1,this.#P=$.replicaPoolSize??0,this.#K=$.scanInterval??0,this.#q=$.passthroughClientErrorEvents??!1,this.#z=$.nodeClientOptions?{...$.nodeClientOptions}:{},this.#z.url!==void 0)throw Error("invalid nodeClientOptions for Sentinel");if($.clientSideCache)if($.clientSideCache instanceof Ab.PooledClientSideCacheProvider)this.#x=this.#z.clientSideCache=$.clientSideCache;else{let J=$.clientSideCache;this.#x=this.#z.clientSideCache=new Ab.BasicPooledClientSideCache(J)}if(this.#Z=$.sentinelClientOptions?Object.assign({},$.sentinelClientOptions):{},this.#Z.modules=A7.default,this.#Z.url!==void 0)throw Error("invalid sentinelClientOptions for Sentinel");this.#H=new Zu.WaitQueue;for(let J=0;J<this.#G;J++)this.#H.push(J);this.#h=new qu.PubSubProxy(this.#z,(J)=>this.emit("error",J))}#T($,J,Q){return F$.default.create({RESP:this.#w,...J,socket:{...J.socket,host:$.host,port:$.port,...Q!==void 0&&{reconnectStrategy:Q}}})}getClientLease(){let $=this.#H.shift();if($!==void 0)return{id:$};return this.#H.wait().then((J)=>({id:J}))}releaseClientLease($){let J=this.#F[$.id];if(J!==void 0){let Q=J.resetIfDirty();if(Q)return Q.then(()=>this.#H.push($.id))}this.#H.push($.id)}async connect(){if(this.#$)throw Error("already attempting to open");try{this.#$=!0,this.#v=this.#C(),await this.#v,this.#J=!0}finally{if(this.#v=void 0,this.#K>0)this.#U=setInterval(this.#A.bind(this),this.#K)}}async#C(){let $=0;while(!0){if(this.#V("starting connect loop"),$+=1,this.#O){this.#V("in #connect and want to destroy");return}try{if(this.#W=!1,await this.transform(this.analyze(await this.observe())),this.#W){this.#V("#connect: anotherReset is true, so continuing");continue}this.#V("#connect: returning");return}catch(J){if(this.#V(`#connect: exception ${J.message}`),!this.#J&&$>this.#I)throw J;if(J.message!=="no valid master node")console.log(J);await(0,wu.setTimeout)(1000)}finally{this.#V("finished connect")}}}async execute($,J){let Q=0;while(!0){if(this.#v!==void 0)await this.#v;let z=this.#g(J);if(!z.isReady){await this.#A();continue}let q=z.options?.socket;this.#V("attemping to send command to "+q?.host+":"+q?.port);try{return await $(z)}catch(Z){if(++Q>this.#I||!(Z instanceof Error))throw Z;if(J!==void 0&&(Z.message.startsWith("READONLY")||!z.isReady)){await this.#A();continue}throw Z}}}async#D($){return await $.pSubscribe(["switch-master","[-+]sdown","+slave","+sentinel","[-+]odown","+slave-reconf-done"],(J,Q)=>{this.#f(Q,J)},!0),$}async#f($,J){this.#V("pubsub control channel message on "+$),this.#A()}#g($){if($!==void 0)return this.#F[$.id];if(this.#b>=this.#j.length)this.#b=0;if(this.#j.length==0)throw Error("no replicas available for read");return this.#j[this.#b++]}async#A(){if(this.#J==!1||this.#O==!0)return;if(this.#v!==void 0)return this.#W=!0,await this.#v;try{return this.#v=this.#C(),await this.#v}finally{this.#V("finished reconfgure"),this.#v=void 0}}#M($){let J=this.#B.findIndex((Q)=>Q.host===$.host&&Q.port===$.port);if(J!==-1)this.#B.splice(J,1);this.#A()}async close(){if(this.#O=!0,this.#v!=null)await this.#v;if(this.#J=!1,this.#x?.onPoolClose(),this.#U)clearInterval(this.#U),this.#U=void 0;let $=[];if(this.#Y!==void 0){if(this.#Y.isOpen)$.push(this.#Y.close());this.#Y=void 0}for(let J of this.#F)if(J.isOpen)$.push(J.close());this.#F=[];for(let J of this.#j)if(J.isOpen)$.push(J.close());this.#j=[],await Promise.all($),this.#h.destroy(),this.#$=!1}async destroy(){if(this.#O=!0,this.#v!=null)await this.#v;if(this.#J=!1,this.#x?.onPoolClose(),this.#U)clearInterval(this.#U),this.#U=void 0;if(this.#Y!==void 0){if(this.#Y.isOpen)this.#Y.destroy();this.#Y=void 0}for(let $ of this.#F)if($.isOpen)$.destroy();this.#F=[];for(let $ of this.#j)if($.isOpen)$.destroy();this.#j=[],this.#h.destroy(),this.#$=!1,this.#O=!1}async subscribe($,J,Q){return this.#h.subscribe($,J,Q)}async unsubscribe($,J,Q){return this.#h.unsubscribe($,J,Q)}async pSubscribe($,J,Q){return this.#h.pSubscribe($,J,Q)}async pUnsubscribe($,J,Q){return this.#h.pUnsubscribe($,J,Q)}async observe(){for(let $ of this.#B){let J;try{this.#V(`observe: trying to connect to sentinel: ${$.host}:${$.port}`),J=this.#T($,this.#Z,!1),J.on("error",(W)=>this.emit("error",`obseve client error: ${W}`)),await J.connect(),this.#V("observe: connected to sentinel");let[Q,z,q]=await Promise.all([J.sentinel.sentinelSentinels(this.#Q),J.sentinel.sentinelMaster(this.#Q),J.sentinel.sentinelReplicas(this.#Q)]);return this.#V("observe: got all sentinel data"),{sentinelConnected:$,sentinelData:Q,masterData:z,replicaData:q,currentMaster:this.getMasterNode(),currentReplicas:this.getReplicaNodes(),currentSentinel:this.getSentinelNode(),replicaPoolSize:this.#P,useReplicas:this.useReplicas}}catch(Q){this.#V(`observe: error ${Q}`),this.emit("error",Q)}finally{if(J!==void 0&&J.isOpen)this.#V("observe: destroying sentinel client"),J.destroy()}}throw this.#V("observe: none of the sentinels are available"),Error("None of the sentinels are available")}analyze($){let J=(0,D.parseNode)($.masterData);if(J===void 0)throw this.#V(`analyze: no valid master node because ${$.masterData.flags}`),Error("no valid master node");if(J.host===$.currentMaster?.host&&J.port===$.currentMaster?.port)this.#V(`analyze: master node hasn't changed from ${$.currentMaster?.host}:${$.currentMaster?.port}`),J=void 0;else this.#V(`analyze: master node has changed to ${J.host}:${J.port} from ${$.currentMaster?.host}:${$.currentMaster?.port}`);let Q=$.sentinelConnected;if(Q.host===$.currentSentinel?.host&&Q.port===$.currentSentinel.port)this.#V("analyze: sentinel node hasn't changed"),Q=void 0;else this.#V(`analyze: sentinel node has changed to ${Q.host}:${Q.port}`);let z=[],q=new Map,Z=new Set,W=new Set;if($.useReplicas){let Y=(0,D.createNodeList)($.replicaData);for(let F of Y)Z.add(JSON.stringify(F));for(let[F,H]of $.currentReplicas)if(!Z.has(JSON.stringify(F)))z.push(F),this.#V(`analyze: adding ${F.host}:${F.port} to replicsToClose`);else if(W.add(JSON.stringify(F)),H!=$.replicaPoolSize)q.set(F,$.replicaPoolSize-H),this.#V(`analyze: adding ${F.host}:${F.port} to replicsToOpen`);for(let F of Y)if(!W.has(JSON.stringify(F)))q.set(F,$.replicaPoolSize),this.#V(`analyze: adding ${F.host}:${F.port} to replicsToOpen`)}return{sentinelList:[$.sentinelConnected].concat((0,D.createNodeList)($.sentinelData)),epoch:Number($.masterData["config-epoch"]),sentinelToOpen:Q,masterToOpen:J,replicasToClose:z,replicasToOpen:q}}async transform($){this.#V("transform: enter");let J=[];if($.sentinelToOpen){if(this.#V("transform: opening a new sentinel"),this.#Y!==void 0&&this.#Y.isOpen)this.#V("transform: destroying old sentinel as open"),this.#Y.destroy(),this.#Y=void 0;else this.#V("transform: not destroying old sentinel as not open");this.#V(`transform: creating new sentinel to ${$.sentinelToOpen.host}:${$.sentinelToOpen.port}`);let Z=$.sentinelToOpen,W=this.#T($.sentinelToOpen,this.#Z,!1);W.on("error",(F)=>{if(this.#q)this.emit("error",Error(`Sentinel Client (${Z.host}:${Z.port}): ${F.message}`,{cause:F}));let H={type:"SENTINEL",node:(0,D.clientSocketToNode)(W.options.socket),error:F};this.emit("client-error",H),this.#M(Z)}).on("end",()=>this.#M(Z)),this.#Y=W,this.#V("transform: adding sentinel client connect() to promise list");let V=this.#Y.connect().then((F)=>{return this.#D(F)});J.push(V),this.#V(`created sentinel client to ${$.sentinelToOpen.host}:${$.sentinelToOpen.port}`);let Y={type:"SENTINEL_CHANGE",node:$.sentinelToOpen};if(this.#V("transform: emiting topology-change event for sentinel_change"),!this.emit("topology-change",Y))this.#V("transform: emit for topology-change for sentinel_change returned false")}if($.masterToOpen){this.#V("transform: opening a new master");let Z=[],W=[];this.#V("transform: destroying old masters if open");for(let Y of this.#F)if(W.push(Y.isWatching||Y.isDirtyWatch),Y.isOpen)Y.destroy();this.#F=[],this.#V("transform: creating all master clients and adding connect promises");for(let Y=0;Y<this.#G;Y++){let F=$.masterToOpen,H=this.#T($.masterToOpen,this.#z);if(H.on("error",(B)=>{if(this.#q)this.emit("error",Error(`Master Client (${F.host}:${F.port}): ${B.message}`,{cause:B}));let v={type:"MASTER",node:(0,D.clientSocketToNode)(H.options.socket),error:B};this.emit("client-error",v)}),W[Y])H.setDirtyWatch("sentinel config changed in middle of a WATCH Transaction");this.#F.push(H),Z.push(H.connect()),this.#V(`created master client to ${$.masterToOpen.host}:${$.masterToOpen.port}`)}this.#V("transform: adding promise to change #pubSubProxy node"),Z.push(this.#h.changeNode($.masterToOpen)),J.push(...Z);let V={type:"MASTER_CHANGE",node:$.masterToOpen};if(this.#V("transform: emiting topology-change event for master_change"),!this.emit("topology-change",V))this.#V("transform: emit for topology-change for master_change returned false");this.#X++}let Q=new Set;for(let Z of $.replicasToClose){let W=JSON.stringify(Z);Q.add(W)}let z=[],q=new Set;for(let Z of this.#j){let W=(0,D.clientSocketToNode)(Z.options.socket),V=JSON.stringify(W);if(Q.has(V)||!Z.isOpen){if(Z.isOpen){let Y=Z.options?.socket;this.#V(`destroying replica client to ${Y?.host}:${Y?.port}`),Z.destroy()}if(!q.has(V)){let Y={type:"REPLICA_REMOVE",node:W};this.emit("topology-change",Y),q.add(V)}}else z.push(Z)}if(this.#j=z,$.replicasToOpen.size!=0)for(let[Z,W]of $.replicasToOpen){for(let Y=0;Y<W;Y++){let F=this.#T(Z,this.#z);F.on("error",(H)=>{if(this.#q)this.emit("error",Error(`Replica Client (${Z.host}:${Z.port}): ${H.message}`,{cause:H}));let B={type:"REPLICA",node:(0,D.clientSocketToNode)(F.options.socket),error:H};this.emit("client-error",B)}),this.#j.push(F),J.push(F.connect()),this.#V(`created replica client to ${Z.host}:${Z.port}`)}let V={type:"REPLICA_ADD",node:Z};this.emit("topology-change",V)}if($.sentinelList.length!=this.#B.length){this.#B=$.sentinelList;let Z={type:"SENTINE_LIST_CHANGE",size:$.sentinelList.length};this.emit("topology-change",Z)}await Promise.all(J),this.#V("transform: exit")}getMasterNode(){if(this.#F.length==0)return;for(let $ of this.#F)if($.isReady)return(0,D.clientSocketToNode)($.options.socket);return}getSentinelNode(){if(this.#Y===void 0)return;return(0,D.clientSocketToNode)(this.#Y.options.socket)}getReplicaNodes(){let $=new Map,J=new Map;for(let Q of this.#j){let z=(0,D.clientSocketToNode)(Q.options.socket),q=JSON.stringify(z);if(Q.isReady)J.set(q,(J.get(q)??0)+1);else if(!J.has(q))J.set(q,0)}for(let[Q,z]of J)$.set(JSON.parse(Q),z);return $}setTracer($){if($)this.#V=(J)=>{$.push(J)};else this.#V=()=>{}}}class fb extends Z8.EventEmitter{options;#$;#J=-1;constructor($){super();this.options=$,this.#$=$.sentinelRootNodes}async updateSentinelRootNodes(){for(let $ of this.#$){let J=F$.default.create({...this.options.sentinelClientOptions,socket:{...this.options.sentinelClientOptions?.socket,host:$.host,port:$.port,reconnectStrategy:!1},modules:A7.default}).on("error",(Q)=>this.emit(`updateSentinelRootNodes: ${Q}`));try{await J.connect()}catch{if(J.isOpen)J.destroy();continue}try{let Q=await J.sentinel.sentinelSentinels(this.options.name);this.#$=[$].concat((0,D.createNodeList)(Q));return}finally{J.destroy()}}throw Error("Couldn't connect to any sentinel node")}async getMasterNode(){let $=!1;for(let J of this.#$){let Q=F$.default.create({...this.options.sentinelClientOptions,socket:{...this.options.sentinelClientOptions?.socket,host:J.host,port:J.port,reconnectStrategy:!1},modules:A7.default}).on("error",(z)=>this.emit(`getMasterNode: ${z}`));try{await Q.connect()}catch{if(Q.isOpen)Q.destroy();continue}$=!0;try{let z=await Q.sentinel.sentinelMaster(this.options.name),q=(0,D.parseNode)(z);if(q===void 0)continue;return q}finally{Q.destroy()}}if($)throw Error("Master Node Not Enumerated");throw Error("couldn't connect to any sentinels")}async getMasterClient(){let $=await this.getMasterNode();return F$.default.create({...this.options.nodeClientOptions,socket:{...this.options.nodeClientOptions?.socket,host:$.host,port:$.port}})}async getReplicaNodes(){let $=!1;for(let J of this.#$){let Q=F$.default.create({...this.options.sentinelClientOptions,socket:{...this.options.sentinelClientOptions?.socket,host:J.host,port:J.port,reconnectStrategy:!1},modules:A7.default}).on("error",(z)=>this.emit(`getReplicaNodes: ${z}`));try{await Q.connect()}catch{if(Q.isOpen)Q.destroy();continue}$=!0;try{let z=await Q.sentinel.sentinelReplicas(this.options.name),q=(0,D.createNodeList)(z);if(q.length==0)continue;return q}finally{Q.destroy()}}if($)throw Error("No Replicas Nodes Enumerated");throw Error("couldn't connect to any sentinels")}async getReplicaClient(){let $=await this.getReplicaNodes();if($.length==0)throw Error("no available replicas");if(this.#J++,this.#J>=$.length)this.#J=0;return F$.default.create({...this.options.nodeClientOptions,socket:{...this.options.nodeClientOptions?.socket,host:$[this.#J].host,port:$[this.#J].port}})}}b0.RedisSentinelFactory=fb});var D6=w((G)=>{var Ku=G&&G.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Wu=G&&G.__exportStar||function($,J){for(var Q in $)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(J,Q))Ku(J,$,Q)},K8=G&&G.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(G,"__esModule",{value:!0});G.BasicPooledClientSideCache=G.BasicClientSideCache=G.REDIS_FLUSH_MODES=G.COMMAND_LIST_FILTER_BY=G.CLUSTER_SLOT_STATES=G.FAILOVER_MODES=G.CLIENT_KILL_FILTERS=G.GEO_REPLY_WITH=G.createSentinel=G.createCluster=G.createClientPool=G.createClient=G.defineScript=G.VerbatimString=G.RESP_TYPES=void 0;var Vu=$7();Object.defineProperty(G,"RESP_TYPES",{enumerable:!0,get:function(){return Vu.RESP_TYPES}});var Yu=d7();Object.defineProperty(G,"VerbatimString",{enumerable:!0,get:function(){return Yu.VerbatimString}});var Xu=I4();Object.defineProperty(G,"defineScript",{enumerable:!0,get:function(){return Xu.defineScript}});Wu(c(),G);var Fu=K8(w$());G.createClient=Fu.default.create;var Hu=e5();G.createClientPool=Hu.RedisClientPool.create;var Bu=K8(nP());G.createCluster=Bu.default.create;var ju=K8(Mb());G.createSentinel=ju.default.create;var vu=M$();Object.defineProperty(G,"GEO_REPLY_WITH",{enumerable:!0,get:function(){return vu.GEO_REPLY_WITH}});var O6=i();Object.defineProperty(G,"CLIENT_KILL_FILTERS",{enumerable:!0,get:function(){return O6.CLIENT_KILL_FILTERS}});Object.defineProperty(G,"FAILOVER_MODES",{enumerable:!0,get:function(){return O6.FAILOVER_MODES}});Object.defineProperty(G,"CLUSTER_SLOT_STATES",{enumerable:!0,get:function(){return O6.CLUSTER_SLOT_STATES}});Object.defineProperty(G,"COMMAND_LIST_FILTER_BY",{enumerable:!0,get:function(){return O6.COMMAND_LIST_FILTER_BY}});Object.defineProperty(G,"REDIS_FLUSH_MODES",{enumerable:!0,get:function(){return O6.REDIS_FLUSH_MODES}});var Sb=z$();Object.defineProperty(G,"BasicClientSideCache",{enumerable:!0,get:function(){return Sb.BasicClientSideCache}});Object.defineProperty(G,"BasicPooledClientSideCache",{enumerable:!0,get:function(){return Sb.BasicPooledClientSideCache}})});var kb=w((Eb)=>{Object.defineProperty(Eb,"__esModule",{value:!0});var Gu=X();Eb.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("BF.ADD"),$.pushKey(J),$.push(Q)},transformReply:Gu.transformBooleanReply}});var Rb=w((gb)=>{Object.defineProperty(gb,"__esModule",{value:!0});gb.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("BF.CARD"),$.pushKey(J)},transformReply:void 0}});var ub=w((yb)=>{Object.defineProperty(yb,"__esModule",{value:!0});var Uu=X();yb.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("BF.EXISTS"),$.pushKey(J),$.push(Q)},transformReply:Uu.transformBooleanReply}});var W8=w((_b)=>{Object.defineProperty(_b,"__esModule",{value:!0});_b.transformInfoV2Reply=void 0;var Nu=D6();function Iu($,J){switch(J?J[Nu.RESP_TYPES.MAP]:void 0){case Array:return $;case Map:{let z=new Map;for(let q=0;q<$.length;q+=2)z.set($[q].toString(),$[q+1]);return z}default:{let z=Object.create(null);for(let q=0;q<$.length;q+=2)z[$[q].toString()]=$[q+1];return z}}}_b.transformInfoV2Reply=Iu});var lb=w((db)=>{Object.defineProperty(db,"__esModule",{value:!0});var Ou=W8();db.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("BF.INFO"),$.pushKey(J)},transformReply:{2:($,J,Q)=>{return(0,Ou.transformInfoV2Reply)($,Q)},3:void 0}}});var ib=w((mb)=>{Object.defineProperty(mb,"__esModule",{value:!0});var Au=X();mb.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("BF.INSERT"),$.pushKey(J),z?.CAPACITY!==void 0)$.push("CAPACITY",z.CAPACITY.toString());if(z?.ERROR!==void 0)$.push("ERROR",z.ERROR.toString());if(z?.EXPANSION!==void 0)$.push("EXPANSION",z.EXPANSION.toString());if(z?.NOCREATE)$.push("NOCREATE");if(z?.NONSCALING)$.push("NONSCALING");$.push("ITEMS"),$.pushVariadic(Q)},transformReply:Au.transformBooleanArrayReply}});var tb=w((nb)=>{Object.defineProperty(nb,"__esModule",{value:!0});nb.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("BF.LOADCHUNK"),$.pushKey(J),$.push(Q.toString(),z)},transformReply:void 0}});var ob=w((ab)=>{Object.defineProperty(ab,"__esModule",{value:!0});var Tu=X();ab.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("BF.MADD"),$.pushKey(J),$.pushVariadic(Q)},transformReply:Tu.transformBooleanArrayReply}});var sb=w((pb)=>{Object.defineProperty(pb,"__esModule",{value:!0});var fu=X();pb.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("BF.MEXISTS"),$.pushKey(J),$.pushVariadic(Q)},transformReply:fu.transformBooleanArrayReply}});var eb=w((rb)=>{Object.defineProperty(rb,"__esModule",{value:!0});rb.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("BF.RESERVE"),$.pushKey(J),$.push(Q.toString(),z.toString()),q?.EXPANSION)$.push("EXPANSION",q.EXPANSION.toString());if(q?.NONSCALING)$.push("NONSCALING")},transformReply:void 0}});var JU=w(($U)=>{Object.defineProperty($U,"__esModule",{value:!0});$U.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("BF.SCANDUMP"),$.pushKey(J),$.push(Q.toString())},transformReply($){return{iterator:$[0],chunk:$[1]}}}});var B$=w((p)=>{var ku=p&&p.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),gu=p&&p.__exportStar||function($,J){for(var Q in $)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(J,Q))ku(J,$,Q)},s=p&&p.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(p,"__esModule",{value:!0});var QU=s(kb()),zU=s(Rb()),qU=s(ub()),wU=s(lb()),ZU=s(ib()),KU=s(tb()),WU=s(ob()),VU=s(sb()),YU=s(eb()),XU=s(JU());gu(W8(),p);p.default={ADD:QU.default,add:QU.default,CARD:zU.default,card:zU.default,EXISTS:qU.default,exists:qU.default,INFO:wU.default,info:wU.default,INSERT:ZU.default,insert:ZU.default,LOADCHUNK:KU.default,loadChunk:KU.default,MADD:WU.default,mAdd:WU.default,MEXISTS:VU.default,mExists:VU.default,RESERVE:YU.default,reserve:YU.default,SCANDUMP:XU.default,scanDump:XU.default}});var BU=w((HU)=>{Object.defineProperty(HU,"__esModule",{value:!0});HU.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("CMS.INCRBY"),$.pushKey(J),Array.isArray(Q))for(let z of Q)FU($,z);else FU($,Q)},transformReply:void 0};function FU($,{item:J,incrementBy:Q}){$.push(J,Q.toString())}});var vU=w((jU)=>{Object.defineProperty(jU,"__esModule",{value:!0});var yu=B$();jU.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("CMS.INFO"),$.pushKey(J)},transformReply:{2:($,J,Q)=>{return(0,yu.transformInfoV2Reply)($,Q)},3:void 0}}});var PU=w((GU)=>{Object.defineProperty(GU,"__esModule",{value:!0});GU.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("CMS.INITBYDIM"),$.pushKey(J),$.push(Q.toString(),z.toString())},transformReply:void 0}});var UU=w((bU)=>{Object.defineProperty(bU,"__esModule",{value:!0});bU.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("CMS.INITBYPROB"),$.pushKey(J),$.push(Q.toString(),z.toString())},transformReply:void 0}});var NU=w((hU)=>{Object.defineProperty(hU,"__esModule",{value:!0});hU.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("CMS.MERGE"),$.pushKey(J),$.push(Q.length.toString()),du(Q))$.pushVariadic(Q);else{for(let z=0;z<Q.length;z++)$.push(Q[z].name);$.push("WEIGHTS");for(let z=0;z<Q.length;z++)$.push(Q[z].weight.toString())}},transformReply:void 0};function du($){return typeof $[0]==="string"||$[0]instanceof Buffer}});var OU=w((IU)=>{Object.defineProperty(IU,"__esModule",{value:!0});IU.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("CMS.QUERY"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var fU=w((A6)=>{var j$=A6&&A6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(A6,"__esModule",{value:!0});var DU=j$(BU()),AU=j$(vU()),xU=j$(PU()),CU=j$(UU()),TU=j$(NU()),LU=j$(OU());A6.default={INCRBY:DU.default,incrBy:DU.default,INFO:AU.default,info:AU.default,INITBYDIM:xU.default,initByDim:xU.default,INITBYPROB:CU.default,initByProb:CU.default,MERGE:TU.default,merge:TU.default,QUERY:LU.default,query:LU.default}});var SU=w((MU)=>{Object.defineProperty(MU,"__esModule",{value:!0});var iu=X();MU.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("CF.ADD"),$.pushKey(J),$.push(Q)},transformReply:iu.transformBooleanReply}});var kU=w((EU)=>{Object.defineProperty(EU,"__esModule",{value:!0});var tu=X();EU.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("CF.ADDNX"),$.pushKey(J),$.push(Q)},transformReply:tu.transformBooleanReply}});var RU=w((gU)=>{Object.defineProperty(gU,"__esModule",{value:!0});gU.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("CF.COUNT"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var uU=w((yU)=>{Object.defineProperty(yU,"__esModule",{value:!0});var pu=X();yU.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("CF.DEL"),$.pushKey(J),$.push(Q)},transformReply:pu.transformBooleanReply}});var cU=w((_U)=>{Object.defineProperty(_U,"__esModule",{value:!0});var ru=X();_U.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("CF.EXISTS"),$.pushKey(J),$.push(Q)},transformReply:ru.transformBooleanReply}});var lU=w((dU)=>{Object.defineProperty(dU,"__esModule",{value:!0});var $_=B$();dU.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("CF.INFO"),$.pushKey(J)},transformReply:{2:($,J,Q)=>{return(0,$_.transformInfoV2Reply)($,Q)},3:void 0}}});var V8=w((iU)=>{Object.defineProperty(iU,"__esModule",{value:!0});iU.parseCfInsertArguments=void 0;var Q_=X();function mU($,J,Q,z){if($.pushKey(J),z?.CAPACITY!==void 0)$.push("CAPACITY",z.CAPACITY.toString());if(z?.NOCREATE)$.push("NOCREATE");$.push("ITEMS"),$.pushVariadic(Q)}iU.parseCfInsertArguments=mU;iU.default={IS_READ_ONLY:!1,parseCommand(...$){$[0].push("CF.INSERT"),mU(...$)},transformReply:Q_.transformBooleanArrayReply}});var tU=w((U0)=>{var q_=U0&&U0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),w_=U0&&U0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Z_=U0&&U0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))q_(J,$,Q)}return w_(J,$),J};Object.defineProperty(U0,"__esModule",{value:!0});var Y8=Z_(V8());U0.default={IS_READ_ONLY:Y8.default.IS_READ_ONLY,parseCommand(...$){$[0].push("CF.INSERTNX"),(0,Y8.parseCfInsertArguments)(...$)},transformReply:Y8.default.transformReply}});var oU=w((aU)=>{Object.defineProperty(aU,"__esModule",{value:!0});aU.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("CF.LOADCHUNK"),$.pushKey(J),$.push(Q.toString(),z)},transformReply:void 0}});var sU=w((pU)=>{Object.defineProperty(pU,"__esModule",{value:!0});pU.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("CF.RESERVE"),$.pushKey(J),$.push(Q.toString()),z?.BUCKETSIZE!==void 0)$.push("BUCKETSIZE",z.BUCKETSIZE.toString());if(z?.MAXITERATIONS!==void 0)$.push("MAXITERATIONS",z.MAXITERATIONS.toString());if(z?.EXPANSION!==void 0)$.push("EXPANSION",z.EXPANSION.toString())},transformReply:void 0}});var eU=w((rU)=>{Object.defineProperty(rU,"__esModule",{value:!0});rU.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("CF.SCANDUMP"),$.pushKey(J),$.push(Q.toString())},transformReply($){return{iterator:$[0],chunk:$[1]}}}});var Xh=w((x6)=>{var u=x6&&x6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(x6,"__esModule",{value:!0});var $h=u(SU()),Jh=u(kU()),Qh=u(RU()),zh=u(uU()),qh=u(cU()),wh=u(lU()),Zh=u(V8()),Kh=u(tU()),Wh=u(oU()),Vh=u(sU()),Yh=u(eU());x6.default={ADD:$h.default,add:$h.default,ADDNX:Jh.default,addNX:Jh.default,COUNT:Qh.default,count:Qh.default,DEL:zh.default,del:zh.default,EXISTS:qh.default,exists:qh.default,INFO:wh.default,info:wh.default,INSERT:Zh.default,insert:Zh.default,INSERTNX:Kh.default,insertNX:Kh.default,LOADCHUNK:Wh.default,loadChunk:Wh.default,RESERVE:Vh.default,reserve:Vh.default,SCANDUMP:Yh.default,scanDump:Yh.default}});var Hh=w((Fh)=>{Object.defineProperty(Fh,"__esModule",{value:!0});Fh.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("TDIGEST.ADD"),$.pushKey(J);for(let z of Q)$.push(z.toString())},transformReply:void 0}});var X8=w((jh)=>{Object.defineProperty(jh,"__esModule",{value:!0});jh.transformByRankArguments=void 0;var X_=X();function Bh($,J,Q){$.pushKey(J);for(let z of Q)$.push(z.toString())}jh.transformByRankArguments=Bh;jh.default={IS_READ_ONLY:!0,parseCommand(...$){$[0].push("TDIGEST.BYRANK"),Bh(...$)},transformReply:X_.transformDoubleArrayReply}});var Gh=w((h0)=>{var H_=h0&&h0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),B_=h0&&h0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),j_=h0&&h0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))H_(J,$,Q)}return B_(J,$),J};Object.defineProperty(h0,"__esModule",{value:!0});var F8=j_(X8());h0.default={IS_READ_ONLY:F8.default.IS_READ_ONLY,parseCommand(...$){$[0].push("TDIGEST.BYREVRANK"),(0,F8.transformByRankArguments)(...$)},transformReply:F8.default.transformReply}});var bh=w((Ph)=>{Object.defineProperty(Ph,"__esModule",{value:!0});var v_=X();Ph.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("TDIGEST.CDF"),$.pushKey(J);for(let z of Q)$.push(z.toString())},transformReply:v_.transformDoubleArrayReply}});var hh=w((Uh)=>{Object.defineProperty(Uh,"__esModule",{value:!0});Uh.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("TDIGEST.CREATE"),$.pushKey(J),Q?.COMPRESSION!==void 0)$.push("COMPRESSION",Q.COMPRESSION.toString())},transformReply:void 0}});var Ih=w((Nh)=>{Object.defineProperty(Nh,"__esModule",{value:!0});var b_=B$();Nh.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("TDIGEST.INFO"),$.pushKey(J)},transformReply:{2:($,J,Q)=>{return(0,b_.transformInfoV2Reply)($,Q)},3:void 0}}});var Dh=w((Oh)=>{Object.defineProperty(Oh,"__esModule",{value:!0});var h_=X();Oh.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("TDIGEST.MAX"),$.pushKey(J)},transformReply:h_.transformDoubleReply}});var xh=w((Ah)=>{Object.defineProperty(Ah,"__esModule",{value:!0});Ah.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("TDIGEST.MERGE"),$.pushKey(J),$.pushKeysLength(Q),z?.COMPRESSION!==void 0)$.push("COMPRESSION",z.COMPRESSION.toString());if(z?.OVERRIDE)$.push("OVERRIDE")},transformReply:void 0}});var Th=w((Ch)=>{Object.defineProperty(Ch,"__esModule",{value:!0});var O_=X();Ch.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("TDIGEST.MIN"),$.pushKey(J)},transformReply:O_.transformDoubleReply}});var fh=w((Lh)=>{Object.defineProperty(Lh,"__esModule",{value:!0});var A_=X();Lh.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("TDIGEST.QUANTILE"),$.pushKey(J);for(let z of Q)$.push(z.toString())},transformReply:A_.transformDoubleArrayReply}});var H8=w((Sh)=>{Object.defineProperty(Sh,"__esModule",{value:!0});Sh.transformRankArguments=void 0;function Mh($,J,Q){$.pushKey(J);for(let z of Q)$.push(z.toString())}Sh.transformRankArguments=Mh;Sh.default={IS_READ_ONLY:!0,parseCommand(...$){$[0].push("TDIGEST.RANK"),Mh(...$)},transformReply:void 0}});var gh=w((kh)=>{Object.defineProperty(kh,"__esModule",{value:!0});kh.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("TDIGEST.RESET"),$.pushKey(J)},transformReply:void 0}});var Rh=w((N0)=>{var L_=N0&&N0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),f_=N0&&N0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),M_=N0&&N0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))L_(J,$,Q)}return f_(J,$),J};Object.defineProperty(N0,"__esModule",{value:!0});var B8=M_(H8());N0.default={IS_READ_ONLY:B8.default.IS_READ_ONLY,parseCommand(...$){$[0].push("TDIGEST.REVRANK"),(0,B8.transformRankArguments)(...$)},transformReply:B8.default.transformReply}});var uh=w((yh)=>{Object.defineProperty(yh,"__esModule",{value:!0});var S_=X();yh.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("TDIGEST.TRIMMED_MEAN"),$.pushKey(J),$.push(Q.toString(),z.toString())},transformReply:S_.transformDoubleReply}});var $N=w((C6)=>{var E=C6&&C6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(C6,"__esModule",{value:!0});var _h=E(Hh()),ch=E(X8()),dh=E(Gh()),lh=E(bh()),mh=E(hh()),ih=E(Ih()),nh=E(Dh()),th=E(xh()),ah=E(Th()),oh=E(fh()),ph=E(H8()),sh=E(gh()),rh=E(Rh()),eh=E(uh());C6.default={ADD:_h.default,add:_h.default,BYRANK:ch.default,byRank:ch.default,BYREVRANK:dh.default,byRevRank:dh.default,CDF:lh.default,cdf:lh.default,CREATE:mh.default,create:mh.default,INFO:ih.default,info:ih.default,MAX:nh.default,max:nh.default,MERGE:th.default,merge:th.default,MIN:ah.default,min:ah.default,QUANTILE:oh.default,quantile:oh.default,RANK:ph.default,rank:ph.default,RESET:sh.default,reset:sh.default,REVRANK:rh.default,revRank:rh.default,TRIMMED_MEAN:eh.default,trimmedMean:eh.default}});var QN=w((JN)=>{Object.defineProperty(JN,"__esModule",{value:!0});JN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("TOPK.ADD"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var qN=w((zN)=>{Object.defineProperty(zN,"__esModule",{value:!0});zN.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("TOPK.COUNT"),$.pushKey(J),$.pushVariadic(Q)},transformReply:void 0}});var KN=w((ZN)=>{Object.defineProperty(ZN,"__esModule",{value:!0});function wN($,{item:J,incrementBy:Q}){$.push(J,Q.toString())}ZN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("TOPK.INCRBY"),$.pushKey(J),Array.isArray(Q))for(let z of Q)wN($,z);else wN($,Q)},transformReply:void 0}});var VN=w((WN)=>{Object.defineProperty(WN,"__esModule",{value:!0});var y_=X(),u_=B$();WN.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("TOPK.INFO"),$.pushKey(J)},transformReply:{2:($,J,Q)=>{return $[7]=y_.transformDoubleReply[2]($[7],J,Q),(0,u_.transformInfoV2Reply)($,Q)},3:void 0}}});var XN=w((YN)=>{Object.defineProperty(YN,"__esModule",{value:!0});YN.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("TOPK.LIST"),$.pushKey(J),$.push("WITHCOUNT")},transformReply($){let J=[];for(let Q=0;Q<$.length;Q++)J.push({item:$[Q],count:$[++Q]});return J}}});var HN=w((FN)=>{Object.defineProperty(FN,"__esModule",{value:!0});FN.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("TOPK.LIST"),$.pushKey(J)},transformReply:void 0}});var jN=w((BN)=>{Object.defineProperty(BN,"__esModule",{value:!0});var l_=X();BN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("TOPK.QUERY"),$.pushKey(J),$.pushVariadic(Q)},transformReply:l_.transformBooleanArrayReply}});var GN=w((vN)=>{Object.defineProperty(vN,"__esModule",{value:!0});vN.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("TOPK.RESERVE"),$.pushKey(J),$.push(Q.toString()),z)$.push(z.width.toString(),z.depth.toString(),z.decay.toString())},transformReply:void 0}});var AN=w((T6)=>{var k0=T6&&T6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(T6,"__esModule",{value:!0});var PN=k0(QN()),bN=k0(qN()),UN=k0(KN()),hN=k0(VN()),NN=k0(XN()),IN=k0(HN()),ON=k0(jN()),DN=k0(GN());T6.default={ADD:PN.default,add:PN.default,COUNT:bN.default,count:bN.default,INCRBY:UN.default,incrBy:UN.default,INFO:hN.default,info:hN.default,LIST_WITHCOUNT:NN.default,listWithCount:NN.default,LIST:IN.default,list:IN.default,QUERY:ON.default,query:ON.default,RESERVE:DN.default,reserve:DN.default}});var xN=w((L6)=>{var f6=L6&&L6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(L6,"__esModule",{value:!0});var n_=f6(B$()),t_=f6(fU()),a_=f6(Xh()),o_=f6($N()),p_=f6(AN());L6.default={bf:n_.default,cms:t_.default,cf:a_.default,tDigest:o_.default,topK:p_.default}});var j8=w((v$)=>{var s_=v$&&v$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(v$,"__esModule",{value:!0});v$.default=void 0;var r_=xN();Object.defineProperty(v$,"default",{enumerable:!0,get:function(){return s_(r_).default}})});var LN=w((TN)=>{Object.defineProperty(TN,"__esModule",{value:!0});var CN=X();TN.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,...q){$.push("JSON.ARRAPPEND"),$.pushKey(J),$.push(Q,(0,CN.transformRedisJsonArgument)(z));for(let Z=0;Z<q.length;Z++)$.push((0,CN.transformRedisJsonArgument)(q[Z]))},transformReply:void 0}});var MN=w((fN)=>{Object.defineProperty(fN,"__esModule",{value:!0});var $c=X();fN.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("JSON.ARRINDEX"),$.pushKey(J),$.push(Q,(0,$c.transformRedisJsonArgument)(z)),q?.range){if($.push(q.range.start.toString()),q.range.stop!==void 0)$.push(q.range.stop.toString())}},transformReply:void 0}});var kN=w((EN)=>{Object.defineProperty(EN,"__esModule",{value:!0});var SN=X();EN.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,...Z){$.push("JSON.ARRINSERT"),$.pushKey(J),$.push(Q,z.toString(),(0,SN.transformRedisJsonArgument)(q));for(let W=0;W<Z.length;W++)$.push((0,SN.transformRedisJsonArgument)(Z[W]))},transformReply:void 0}});var RN=w((gN)=>{Object.defineProperty(gN,"__esModule",{value:!0});gN.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("JSON.ARRLEN"),$.pushKey(J),Q?.path!==void 0)$.push(Q.path)},transformReply:void 0}});var uN=w((yN)=>{Object.defineProperty(yN,"__esModule",{value:!0});var v8=X();yN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("JSON.ARRPOP"),$.pushKey(J),Q){if($.push(Q.path),Q.index!==void 0)$.push(Q.index.toString())}},transformReply($){return(0,v8.isArrayReply)($)?$.map((J)=>(0,v8.transformRedisJsonNullReply)(J)):(0,v8.transformRedisJsonNullReply)($)}}});var cN=w((_N)=>{Object.defineProperty(_N,"__esModule",{value:!0});_N.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){$.push("JSON.ARRTRIM"),$.pushKey(J),$.push(Q,z.toString(),q.toString())},transformReply:void 0}});var lN=w((dN)=>{Object.defineProperty(dN,"__esModule",{value:!0});dN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("JSON.CLEAR"),$.pushKey(J),Q?.path!==void 0)$.push(Q.path)},transformReply:void 0}});var iN=w((mN)=>{Object.defineProperty(mN,"__esModule",{value:!0});mN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("JSON.DEBUG","MEMORY"),$.pushKey(J),Q?.path!==void 0)$.push(Q.path)},transformReply:void 0}});var tN=w((nN)=>{Object.defineProperty(nN,"__esModule",{value:!0});nN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("JSON.DEL"),$.pushKey(J),Q?.path!==void 0)$.push(Q.path)},transformReply:void 0}});var oN=w((aN)=>{Object.defineProperty(aN,"__esModule",{value:!0});aN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("JSON.FORGET"),$.pushKey(J),Q?.path!==void 0)$.push(Q.path)},transformReply:void 0}});var sN=w((pN)=>{Object.defineProperty(pN,"__esModule",{value:!0});var Yc=X();pN.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("JSON.GET"),$.pushKey(J),Q?.path!==void 0)$.pushVariadic(Q.path)},transformReply:Yc.transformRedisJsonNullReply}});var eN=w((rN)=>{Object.defineProperty(rN,"__esModule",{value:!0});var Fc=X();rN.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("JSON.MERGE"),$.pushKey(J),$.push(Q,(0,Fc.transformRedisJsonArgument)(z))},transformReply:void 0}});var JI=w(($I)=>{Object.defineProperty($I,"__esModule",{value:!0});var Bc=X();$I.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("JSON.MGET"),$.pushKeys(J),$.push(Q)},transformReply($){return $.map((J)=>(0,Bc.transformRedisJsonNullReply)(J))}}});var zI=w((QI)=>{Object.defineProperty(QI,"__esModule",{value:!0});var vc=X();QI.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("JSON.MSET");for(let Q=0;Q<J.length;Q++)$.pushKey(J[Q].key),$.push(J[Q].path,(0,vc.transformRedisJsonArgument)(J[Q].value))},transformReply:void 0}});var G8=w((qI)=>{Object.defineProperty(qI,"__esModule",{value:!0});qI.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("JSON.NUMINCRBY"),$.pushKey(J),$.push(Q,z.toString())},transformReply:{2:($)=>{return JSON.parse($.toString())},3:void 0}}});var wI=w((M6)=>{var bc=M6&&M6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(M6,"__esModule",{value:!0});var Uc=bc(G8());M6.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("JSON.NUMMULTBY"),$.pushKey(J),$.push(Q,z.toString())},transformReply:Uc.default.transformReply}});var KI=w((ZI)=>{Object.defineProperty(ZI,"__esModule",{value:!0});ZI.default={IS_READ_ONLY:!1,parseCommand($,J,Q){if($.push("JSON.OBJKEYS"),$.pushKey(J),Q?.path!==void 0)$.push(Q.path)},transformReply:void 0}});var VI=w((WI)=>{Object.defineProperty(WI,"__esModule",{value:!0});WI.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("JSON.OBJLEN"),$.pushKey(J),Q?.path!==void 0)$.push(Q.path)},transformReply:void 0}});var XI=w((YI)=>{Object.defineProperty(YI,"__esModule",{value:!0});var Ic=X();YI.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){if($.push("JSON.SET"),$.pushKey(J),$.push(Q,(0,Ic.transformRedisJsonArgument)(z)),q?.condition)$.push(q?.condition);else if(q?.NX)$.push("NX");else if(q?.XX)$.push("XX")},transformReply:void 0}});var HI=w((FI)=>{Object.defineProperty(FI,"__esModule",{value:!0});var Dc=X();FI.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){if($.push("JSON.STRAPPEND"),$.pushKey(J),z?.path!==void 0)$.push(z.path);$.push((0,Dc.transformRedisJsonArgument)(Q))},transformReply:void 0}});var jI=w((BI)=>{Object.defineProperty(BI,"__esModule",{value:!0});BI.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("JSON.STRLEN"),$.pushKey(J),Q?.path)$.push(Q.path)},transformReply:void 0}});var GI=w((vI)=>{Object.defineProperty(vI,"__esModule",{value:!0});vI.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("JSON.TOGGLE"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var bI=w((PI)=>{Object.defineProperty(PI,"__esModule",{value:!0});PI.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("JSON.TYPE"),$.pushKey(J),Q?.path)$.push(Q.path)},transformReply:{2:void 0,3:($)=>{return $[0]}}}});var lI=w((_)=>{var I=_&&_.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(_,"__esModule",{value:!0});_.transformRedisJsonNullReply=_.transformRedisJsonReply=_.transformRedisJsonArgument=void 0;var UI=I(LN()),hI=I(MN()),NI=I(kN()),II=I(RN()),OI=I(uN()),DI=I(cN()),AI=I(lN()),xI=I(iN()),CI=I(tN()),TI=I(oN()),LI=I(sN()),fI=I(eN()),MI=I(JI()),SI=I(zI()),EI=I(G8()),kI=I(wI()),gI=I(KI()),RI=I(VI()),yI=I(XI()),uI=I(HI()),_I=I(jI()),cI=I(GI()),dI=I(bI()),P8=X();Object.defineProperty(_,"transformRedisJsonArgument",{enumerable:!0,get:function(){return P8.transformRedisJsonArgument}});Object.defineProperty(_,"transformRedisJsonReply",{enumerable:!0,get:function(){return P8.transformRedisJsonReply}});Object.defineProperty(_,"transformRedisJsonNullReply",{enumerable:!0,get:function(){return P8.transformRedisJsonNullReply}});_.default={ARRAPPEND:UI.default,arrAppend:UI.default,ARRINDEX:hI.default,arrIndex:hI.default,ARRINSERT:NI.default,arrInsert:NI.default,ARRLEN:II.default,arrLen:II.default,ARRPOP:OI.default,arrPop:OI.default,ARRTRIM:DI.default,arrTrim:DI.default,CLEAR:AI.default,clear:AI.default,DEBUG_MEMORY:xI.default,debugMemory:xI.default,DEL:CI.default,del:CI.default,FORGET:TI.default,forget:TI.default,GET:LI.default,get:LI.default,MERGE:fI.default,merge:fI.default,MGET:MI.default,mGet:MI.default,MSET:SI.default,mSet:SI.default,NUMINCRBY:EI.default,numIncrBy:EI.default,NUMMULTBY:kI.default,numMultBy:kI.default,OBJKEYS:gI.default,objKeys:gI.default,OBJLEN:RI.default,objLen:RI.default,SET:yI.default,set:yI.default,STRAPPEND:uI.default,strAppend:uI.default,STRLEN:_I.default,strLen:_I.default,TOGGLE:cI.default,toggle:cI.default,TYPE:dI.default,type:dI.default}});var b8=w((G$)=>{var Lc=G$&&G$.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(G$,"__esModule",{value:!0});G$.default=void 0;var fc=lI();Object.defineProperty(G$,"default",{enumerable:!0,get:function(){return Lc(fc).default}})});var iI=w((mI)=>{Object.defineProperty(mI,"__esModule",{value:!0});mI.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($){$.push("FT._LIST")},transformReply:{2:void 0,3:void 0}}});var L7=w((aI)=>{Object.defineProperty(aI,"__esModule",{value:!0});aI.REDISEARCH_LANGUAGE=aI.parseSchema=aI.SCHEMA_GEO_SHAPE_COORD_SYSTEM=aI.VAMANA_COMPRESSION_ALGORITHM=aI.SCHEMA_VECTOR_FIELD_ALGORITHM=aI.SCHEMA_TEXT_FIELD_PHONETIC=aI.SCHEMA_FIELD_TYPE=void 0;var nI=X();aI.SCHEMA_FIELD_TYPE={TEXT:"TEXT",NUMERIC:"NUMERIC",GEO:"GEO",TAG:"TAG",VECTOR:"VECTOR",GEOSHAPE:"GEOSHAPE"};aI.SCHEMA_TEXT_FIELD_PHONETIC={DM_EN:"dm:en",DM_FR:"dm:fr",FM_PT:"dm:pt",DM_ES:"dm:es"};aI.SCHEMA_VECTOR_FIELD_ALGORITHM={FLAT:"FLAT",HNSW:"HNSW",VAMANA:"SVS-VAMANA"};aI.VAMANA_COMPRESSION_ALGORITHM={LVQ4:"LVQ4",LVQ8:"LVQ8",LVQ4x4:"LVQ4x4",LVQ4x8:"LVQ4x8",LeanVec4x8:"LeanVec4x8",LeanVec8x8:"LeanVec8x8"};aI.SCHEMA_GEO_SHAPE_COORD_SYSTEM={SPHERICAL:"SPHERICAL",FLAT:"FLAT"};function U8($,J){if(J.SORTABLE){if($.push("SORTABLE"),J.SORTABLE==="UNF")$.push("UNF")}if(J.NOINDEX)$.push("NOINDEX")}function tI($,J){for(let[Q,z]of Object.entries(J)){if($.push(Q),typeof z==="string"){$.push(z);continue}if(z.AS)$.push("AS",z.AS);if($.push(z.type),z.INDEXMISSING)$.push("INDEXMISSING");switch(z.type){case aI.SCHEMA_FIELD_TYPE.TEXT:if(z.NOSTEM)$.push("NOSTEM");if(z.WEIGHT!==void 0)$.push("WEIGHT",z.WEIGHT.toString());if(z.PHONETIC)$.push("PHONETIC",z.PHONETIC);if(z.WITHSUFFIXTRIE)$.push("WITHSUFFIXTRIE");if(z.INDEXEMPTY)$.push("INDEXEMPTY");U8($,z);break;case aI.SCHEMA_FIELD_TYPE.NUMERIC:case aI.SCHEMA_FIELD_TYPE.GEO:U8($,z);break;case aI.SCHEMA_FIELD_TYPE.TAG:if(z.SEPARATOR)$.push("SEPARATOR",z.SEPARATOR);if(z.CASESENSITIVE)$.push("CASESENSITIVE");if(z.WITHSUFFIXTRIE)$.push("WITHSUFFIXTRIE");if(z.INDEXEMPTY)$.push("INDEXEMPTY");U8($,z);break;case aI.SCHEMA_FIELD_TYPE.VECTOR:$.push(z.ALGORITHM);let q=[];if(q.push("TYPE",z.TYPE,"DIM",z.DIM.toString(),"DISTANCE_METRIC",z.DISTANCE_METRIC),z.INITIAL_CAP!==void 0)q.push("INITIAL_CAP",z.INITIAL_CAP.toString());switch(z.ALGORITHM){case aI.SCHEMA_VECTOR_FIELD_ALGORITHM.FLAT:if(z.BLOCK_SIZE!==void 0)q.push("BLOCK_SIZE",z.BLOCK_SIZE.toString());break;case aI.SCHEMA_VECTOR_FIELD_ALGORITHM.HNSW:if(z.M!==void 0)q.push("M",z.M.toString());if(z.EF_CONSTRUCTION!==void 0)q.push("EF_CONSTRUCTION",z.EF_CONSTRUCTION.toString());if(z.EF_RUNTIME!==void 0)q.push("EF_RUNTIME",z.EF_RUNTIME.toString());break;case aI.SCHEMA_VECTOR_FIELD_ALGORITHM.VAMANA:if(z.COMPRESSION)q.push("COMPRESSION",z.COMPRESSION);if(z.CONSTRUCTION_WINDOW_SIZE!==void 0)q.push("CONSTRUCTION_WINDOW_SIZE",z.CONSTRUCTION_WINDOW_SIZE.toString());if(z.GRAPH_MAX_DEGREE!==void 0)q.push("GRAPH_MAX_DEGREE",z.GRAPH_MAX_DEGREE.toString());if(z.SEARCH_WINDOW_SIZE!==void 0)q.push("SEARCH_WINDOW_SIZE",z.SEARCH_WINDOW_SIZE.toString());if(z.EPSILON!==void 0)q.push("EPSILON",z.EPSILON.toString());if(z.TRAINING_THRESHOLD!==void 0)q.push("TRAINING_THRESHOLD",z.TRAINING_THRESHOLD.toString());if(z.REDUCE!==void 0)q.push("REDUCE",z.REDUCE.toString());break}$.pushVariadicWithLength(q);break;case aI.SCHEMA_FIELD_TYPE.GEOSHAPE:if(z.COORD_SYSTEM!==void 0)$.push("COORD_SYSTEM",z.COORD_SYSTEM);break}}}aI.parseSchema=tI;aI.REDISEARCH_LANGUAGE={ARABIC:"Arabic",BASQUE:"Basque",CATALANA:"Catalan",DANISH:"Danish",DUTCH:"Dutch",ENGLISH:"English",FINNISH:"Finnish",FRENCH:"French",GERMAN:"German",GREEK:"Greek",HUNGARIAN:"Hungarian",INDONESAIN:"Indonesian",IRISH:"Irish",ITALIAN:"Italian",LITHUANIAN:"Lithuanian",NEPALI:"Nepali",NORWEIGAN:"Norwegian",PORTUGUESE:"Portuguese",ROMANIAN:"Romanian",RUSSIAN:"Russian",SPANISH:"Spanish",SWEDISH:"Swedish",TAMIL:"Tamil",TURKISH:"Turkish",CHINESE:"Chinese"};aI.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("FT.CREATE",J),z?.ON)$.push("ON",z.ON);if((0,nI.parseOptionalVariadicArgument)($,"PREFIX",z?.PREFIX),z?.FILTER)$.push("FILTER",z.FILTER);if(z?.LANGUAGE)$.push("LANGUAGE",z.LANGUAGE);if(z?.LANGUAGE_FIELD)$.push("LANGUAGE_FIELD",z.LANGUAGE_FIELD);if(z?.SCORE)$.push("SCORE",z.SCORE.toString());if(z?.SCORE_FIELD)$.push("SCORE_FIELD",z.SCORE_FIELD);if(z?.MAXTEXTFIELDS)$.push("MAXTEXTFIELDS");if(z?.TEMPORARY)$.push("TEMPORARY",z.TEMPORARY.toString());if(z?.NOOFFSETS)$.push("NOOFFSETS");if(z?.NOHL)$.push("NOHL");if(z?.NOFIELDS)$.push("NOFIELDS");if(z?.NOFREQS)$.push("NOFREQS");if(z?.SKIPINITIALSCAN)$.push("SKIPINITIALSCAN");(0,nI.parseOptionalVariadicArgument)($,"STOPWORDS",z?.STOPWORDS),$.push("SCHEMA"),tI($,Q)},transformReply:void 0}});var sI=w((pI)=>{Object.defineProperty(pI,"__esModule",{value:!0});var yc=L7();pI.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.ALTER",J,"SCHEMA","ADD"),(0,yc.parseSchema)($,Q)},transformReply:void 0}});var P$=w((rI)=>{Object.defineProperty(rI,"__esModule",{value:!0});rI.DEFAULT_DIALECT=void 0;rI.DEFAULT_DIALECT="2"});var b$=w((QO)=>{Object.defineProperty(QO,"__esModule",{value:!0});QO.parseSearchOptions=QO.parseParamsArgument=void 0;var S6=X(),_c=P$();function $O($,J){if(J){$.push("PARAMS");let Q=[];for(let z in J){if(!Object.hasOwn(J,z))continue;let q=J[z];Q.push(z,typeof q==="number"?q.toString():q)}$.pushVariadicWithLength(Q)}}QO.parseParamsArgument=$O;function JO($,J){if(J?.VERBATIM)$.push("VERBATIM");if(J?.NOSTOPWORDS)$.push("NOSTOPWORDS");if((0,S6.parseOptionalVariadicArgument)($,"INKEYS",J?.INKEYS),(0,S6.parseOptionalVariadicArgument)($,"INFIELDS",J?.INFIELDS),(0,S6.parseOptionalVariadicArgument)($,"RETURN",J?.RETURN),J?.SUMMARIZE){if($.push("SUMMARIZE"),typeof J.SUMMARIZE==="object"){if((0,S6.parseOptionalVariadicArgument)($,"FIELDS",J.SUMMARIZE.FIELDS),J.SUMMARIZE.FRAGS!==void 0)$.push("FRAGS",J.SUMMARIZE.FRAGS.toString());if(J.SUMMARIZE.LEN!==void 0)$.push("LEN",J.SUMMARIZE.LEN.toString());if(J.SUMMARIZE.SEPARATOR!==void 0)$.push("SEPARATOR",J.SUMMARIZE.SEPARATOR)}}if(J?.HIGHLIGHT){if($.push("HIGHLIGHT"),typeof J.HIGHLIGHT==="object"){if((0,S6.parseOptionalVariadicArgument)($,"FIELDS",J.HIGHLIGHT.FIELDS),J.HIGHLIGHT.TAGS)$.push("TAGS",J.HIGHLIGHT.TAGS.open,J.HIGHLIGHT.TAGS.close)}}if(J?.SLOP!==void 0)$.push("SLOP",J.SLOP.toString());if(J?.TIMEOUT!==void 0)$.push("TIMEOUT",J.TIMEOUT.toString());if(J?.INORDER)$.push("INORDER");if(J?.LANGUAGE)$.push("LANGUAGE",J.LANGUAGE);if(J?.EXPANDER)$.push("EXPANDER",J.EXPANDER);if(J?.SCORER)$.push("SCORER",J.SCORER);if(J?.SORTBY){if($.push("SORTBY"),typeof J.SORTBY==="string"||J.SORTBY instanceof Buffer)$.push(J.SORTBY);else if($.push(J.SORTBY.BY),J.SORTBY.DIRECTION)$.push(J.SORTBY.DIRECTION)}if(J?.LIMIT)$.push("LIMIT",J.LIMIT.from.toString(),J.LIMIT.size.toString());if($O($,J?.PARAMS),J?.DIALECT)$.push("DIALECT",J.DIALECT.toString());else $.push("DIALECT",_c.DEFAULT_DIALECT)}QO.parseSearchOptions=JO;QO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("FT.SEARCH",J,Q),JO($,z)},transformReply:{2:($)=>{let J=$.length>2&&!Array.isArray($[2]),Q=[],z=1;while(z<$.length)Q.push({id:$[z++],value:J?Object.create(null):cc($[z++])});return{total:$[0],documents:Q}},3:void 0},unstableResp3:!0};function cc($){let J=Object.create(null);if(!$)return J;let Q=0;while(Q<$.length){let z=$[Q++],q=$[Q++];if(z==="$")try{Object.assign(J,JSON.parse(q));continue}catch{}J[z]=q}return J}});var E6=w((WO)=>{Object.defineProperty(WO,"__esModule",{value:!0});WO.parseAggregateOptions=WO.FT_AGGREGATE_GROUP_BY_REDUCERS=WO.FT_AGGREGATE_STEPS=void 0;var mc=b$(),ic=X(),nc=P$();WO.FT_AGGREGATE_STEPS={GROUPBY:"GROUPBY",SORTBY:"SORTBY",APPLY:"APPLY",LIMIT:"LIMIT",FILTER:"FILTER"};WO.FT_AGGREGATE_GROUP_BY_REDUCERS={COUNT:"COUNT",COUNT_DISTINCT:"COUNT_DISTINCT",COUNT_DISTINCTISH:"COUNT_DISTINCTISH",SUM:"SUM",MIN:"MIN",MAX:"MAX",AVG:"AVG",STDDEV:"STDDEV",QUANTILE:"QUANTILE",TOLIST:"TOLIST",FIRST_VALUE:"FIRST_VALUE",RANDOM_SAMPLE:"RANDOM_SAMPLE"};WO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!1,parseCommand($,J,Q,z){return $.push("FT.AGGREGATE",J,Q),KO($,z)},transformReply:{2:($,J,Q)=>{let z=[];for(let q=1;q<$.length;q++)z.push((0,ic.transformTuplesReply)($[q],J,Q));return{total:Number($[0]),results:z}},3:void 0},unstableResp3:!0};function KO($,J){if(J?.VERBATIM)$.push("VERBATIM");if(J?.ADDSCORES)$.push("ADDSCORES");if(J?.LOAD){let Q=[];if(Array.isArray(J.LOAD))for(let z of J.LOAD)qO(Q,z);else qO(Q,J.LOAD);$.push("LOAD"),$.pushVariadicWithLength(Q)}if(J?.TIMEOUT!==void 0)$.push("TIMEOUT",J.TIMEOUT.toString());if(J?.STEPS)for(let Q of J.STEPS)switch($.push(Q.type),Q.type){case WO.FT_AGGREGATE_STEPS.GROUPBY:if(!Q.properties)$.push("0");else $.pushVariadicWithLength(Q.properties);if(Array.isArray(Q.REDUCE))for(let q of Q.REDUCE)wO($,q);else wO($,Q.REDUCE);break;case WO.FT_AGGREGATE_STEPS.SORTBY:let z=[];if(Array.isArray(Q.BY))for(let q of Q.BY)ZO(z,q);else ZO(z,Q.BY);if(Q.MAX)z.push("MAX",Q.MAX.toString());$.pushVariadicWithLength(z);break;case WO.FT_AGGREGATE_STEPS.APPLY:$.push(Q.expression,"AS",Q.AS);break;case WO.FT_AGGREGATE_STEPS.LIMIT:$.push(Q.from.toString(),Q.size.toString());break;case WO.FT_AGGREGATE_STEPS.FILTER:$.push(Q.expression);break}if((0,mc.parseParamsArgument)($,J?.PARAMS),J?.DIALECT)$.push("DIALECT",J.DIALECT.toString());else $.push("DIALECT",nc.DEFAULT_DIALECT)}WO.parseAggregateOptions=KO;function qO($,J){if(typeof J==="string"||J instanceof Buffer)$.push(J);else if($.push(J.identifier),J.AS)$.push("AS",J.AS)}function wO($,J){switch($.push("REDUCE",J.type),J.type){case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.COUNT:$.push("0");break;case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.COUNT_DISTINCT:case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.COUNT_DISTINCTISH:case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.SUM:case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.MIN:case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.MAX:case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.AVG:case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.STDDEV:case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.TOLIST:$.push("1",J.property);break;case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.QUANTILE:$.push("2",J.property,J.quantile.toString());break;case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.FIRST_VALUE:{let Q=[J.property];if(J.BY){if(Q.push("BY"),typeof J.BY==="string"||J.BY instanceof Buffer)Q.push(J.BY);else if(Q.push(J.BY.property),J.BY.direction)Q.push(J.BY.direction)}$.pushVariadicWithLength(Q);break}case WO.FT_AGGREGATE_GROUP_BY_REDUCERS.RANDOM_SAMPLE:$.push("2",J.property,J.sampleSize.toString());break}if(J.AS)$.push("AS",J.AS)}function ZO($,J){if(typeof J==="string"||J instanceof Buffer)$.push(J);else if($.push(J.BY),J.DIRECTION)$.push(J.DIRECTION)}});var N8=w((k6)=>{var ac=k6&&k6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(k6,"__esModule",{value:!0});var h8=ac(E6());k6.default={IS_READ_ONLY:h8.default.IS_READ_ONLY,parseCommand($,J,Q,z){if(h8.default.parseCommand($,J,Q,z),$.push("WITHCURSOR"),z?.COUNT!==void 0)$.push("COUNT",z.COUNT.toString());if(z?.MAXIDLE!==void 0)$.push("MAXIDLE",z.MAXIDLE.toString())},transformReply:{2:($)=>{return{...h8.default.transformReply[2]($[0]),cursor:$[1]}},3:void 0},unstableResp3:!0}});var XO=w((YO)=>{Object.defineProperty(YO,"__esModule",{value:!0});YO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.ALIASADD",J,Q)},transformReply:void 0}});var HO=w((FO)=>{Object.defineProperty(FO,"__esModule",{value:!0});FO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("FT.ALIASDEL",J)},transformReply:void 0}});var jO=w((BO)=>{Object.defineProperty(BO,"__esModule",{value:!0});BO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.ALIASUPDATE",J,Q)},transformReply:void 0}});var GO=w((vO)=>{Object.defineProperty(vO,"__esModule",{value:!0});vO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("FT.CONFIG","GET",J)},transformReply($){let J=Object.create(null);for(let Q of $){let[z,q]=Q;J[z.toString()]=q}return J}}});var bO=w((PO)=>{Object.defineProperty(PO,"__esModule",{value:!0});PO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.CONFIG","SET",J,Q)},transformReply:void 0}});var hO=w((UO)=>{Object.defineProperty(UO,"__esModule",{value:!0});UO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.CURSOR","DEL",J,Q.toString())},transformReply:void 0}});var NO=w((g6)=>{var Jd=g6&&g6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(g6,"__esModule",{value:!0});var Qd=Jd(N8());g6.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("FT.CURSOR","READ",J,Q.toString()),z?.COUNT!==void 0)$.push("COUNT",z.COUNT.toString())},transformReply:Qd.default.transformReply,unstableResp3:!0}});var OO=w((IO)=>{Object.defineProperty(IO,"__esModule",{value:!0});IO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.DICTADD",J),$.pushVariadic(Q)},transformReply:void 0}});var AO=w((DO)=>{Object.defineProperty(DO,"__esModule",{value:!0});DO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.DICTDEL",J),$.pushVariadic(Q)},transformReply:void 0}});var CO=w((xO)=>{Object.defineProperty(xO,"__esModule",{value:!0});xO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("FT.DICTDUMP",J)},transformReply:{2:void 0,3:void 0}}});var LO=w((TO)=>{Object.defineProperty(TO,"__esModule",{value:!0});TO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("FT.DROPINDEX",J),Q?.DD)$.push("DD")},transformReply:{2:void 0,3:void 0}}});var MO=w((fO)=>{Object.defineProperty(fO,"__esModule",{value:!0});var Kd=b$(),Wd=P$();fO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("FT.EXPLAIN",J,Q),(0,Kd.parseParamsArgument)($,z?.PARAMS),z?.DIALECT)$.push("DIALECT",z.DIALECT.toString());else $.push("DIALECT",Wd.DEFAULT_DIALECT)},transformReply:void 0}});var EO=w((SO)=>{Object.defineProperty(SO,"__esModule",{value:!0});var Yd=P$();SO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("FT.EXPLAINCLI",J,Q),z?.DIALECT)$.push("DIALECT",z.DIALECT.toString());else $.push("DIALECT",Yd.DEFAULT_DIALECT)},transformReply:void 0}});var gO=w((kO)=>{Object.defineProperty(kO,"__esModule",{value:!0});var I8=X();kO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("FT.INFO",J)},transformReply:{2:Fd,3:void 0},unstableResp3:!0};function Fd($,J,Q){let z=(0,I8.createTransformTuplesReplyFunc)(J,Q),q={};for(let Z=0;Z<$.length;Z+=2){let W=$[Z].toString();switch(W){case"index_name":case"index_options":case"num_docs":case"max_doc_id":case"num_terms":case"num_records":case"total_inverted_index_blocks":case"hash_indexing_failures":case"indexing":case"number_of_uses":case"cleaning":case"stopwords_list":q[W]=$[Z+1];break;case"inverted_sz_mb":case"vector_index_sz_mb":case"offset_vectors_sz_mb":case"doc_table_size_mb":case"sortable_values_size_mb":case"key_table_size_mb":case"text_overhead_sz_mb":case"tag_overhead_sz_mb":case"total_index_memory_sz_mb":case"geoshapes_sz_mb":case"records_per_doc_avg":case"bytes_per_record_avg":case"offsets_per_term_avg":case"offset_bits_per_record_avg":case"total_indexing_time":case"percent_indexed":q[W]=I8.transformDoubleReply[2]($[Z+1],void 0,Q);break;case"index_definition":q[W]=z($[Z+1]);break;case"attributes":q[W]=$[Z+1].map((V)=>z(V));break;case"gc_stats":{let V={},Y=$[Z+1];for(let F=0;F<Y.length;F+=2){let H=Y[F].toString();switch(H){case"bytes_collected":case"total_ms_run":case"total_cycles":case"average_cycle_time_ms":case"last_run_time_ms":case"gc_numeric_trees_missed":case"gc_blocks_denied":V[H]=I8.transformDoubleReply[2](Y[F+1],void 0,Q);break}}q[W]=V;break}case"cursor_stats":{let V={},Y=$[Z+1];for(let F=0;F<Y.length;F+=2){let H=Y[F].toString();switch(H){case"global_idle":case"global_total":case"index_capacity":case"index_total":V[H]=Y[F+1];break}}q[W]=V;break}}}return q}});var yO=w((I0)=>{var Bd=I0&&I0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),jd=I0&&I0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),vd=I0&&I0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Bd(J,$,Q)}return jd(J,$),J};Object.defineProperty(I0,"__esModule",{value:!0});var RO=vd(b$());I0.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("FT.PROFILE",J,"SEARCH"),z?.LIMITED)$.push("LIMITED");$.push("QUERY",Q),(0,RO.parseSearchOptions)($,z)},transformReply:{2:($)=>{return{results:RO.default.transformReply[2]($[0]),profile:$[1]}},3:($)=>$},unstableResp3:!0}});var _O=w((O0)=>{var Gd=O0&&O0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Pd=O0&&O0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),bd=O0&&O0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Gd(J,$,Q)}return Pd(J,$),J};Object.defineProperty(O0,"__esModule",{value:!0});var uO=bd(E6());O0.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("FT.PROFILE",J,"AGGREGATE"),z?.LIMITED)$.push("LIMITED");$.push("QUERY",Q),(0,uO.parseAggregateOptions)($,z)},transformReply:{2:($)=>{return{results:uO.default.transformReply[2]($[0]),profile:$[1]}},3:($)=>$},unstableResp3:!0}});var cO=w((R6)=>{var Ud=R6&&R6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(R6,"__esModule",{value:!0});var O8=Ud(b$());R6.default={NOT_KEYED_COMMAND:O8.default.NOT_KEYED_COMMAND,IS_READ_ONLY:O8.default.IS_READ_ONLY,parseCommand(...$){O8.default.parseCommand(...$),$[0].push("NOCONTENT")},transformReply:{2:($)=>{return{total:$[0],documents:$.slice(1)}},3:void 0},unstableResp3:!0}});var mO=w((lO)=>{Object.defineProperty(lO,"__esModule",{value:!0});var hd=P$();lO.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("FT.SPELLCHECK",J,Q),z?.DISTANCE)$.push("DISTANCE",z.DISTANCE.toString());if(z?.TERMS)if(Array.isArray(z.TERMS))for(let q of z.TERMS)dO($,q);else dO($,z.TERMS);if(z?.DIALECT)$.push("DIALECT",z.DIALECT.toString());else $.push("DIALECT",hd.DEFAULT_DIALECT)},transformReply:{2:($)=>{return $.map(([,J,Q])=>({term:J,suggestions:Q.map(([z,q])=>({score:Number(z),suggestion:q}))}))},3:void 0},unstableResp3:!0};function dO($,{mode:J,dictionary:Q}){$.push("TERMS",J,Q)}});var nO=w((iO)=>{Object.defineProperty(iO,"__esModule",{value:!0});iO.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("FT.SUGADD"),$.pushKey(J),$.push(Q,z.toString()),q?.INCR)$.push("INCR");if(q?.PAYLOAD)$.push("PAYLOAD",q.PAYLOAD)},transformReply:void 0}});var aO=w((tO)=>{Object.defineProperty(tO,"__esModule",{value:!0});tO.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.SUGDEL"),$.pushKey(J),$.push(Q)},transformReply:void 0}});var y6=w((oO)=>{Object.defineProperty(oO,"__esModule",{value:!0});oO.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){if($.push("FT.SUGGET"),$.pushKey(J),$.push(Q),z?.FUZZY)$.push("FUZZY");if(z?.MAX!==void 0)$.push("MAX",z.MAX.toString())},transformReply:void 0}});var sO=w((u6)=>{var Ad=u6&&u6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(u6,"__esModule",{value:!0});var xd=X(),pO=Ad(y6());u6.default={IS_READ_ONLY:pO.default.IS_READ_ONLY,parseCommand(...$){pO.default.parseCommand(...$),$[0].push("WITHPAYLOADS")},transformReply($){if((0,xd.isNullReply)($))return null;let J=Array($.length/2),Q=0,z=0;while(Q<$.length)J[z++]={suggestion:$[Q++],payload:$[Q++]};return J}}});var eO=w((_6)=>{var Cd=_6&&_6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(_6,"__esModule",{value:!0});var D8=X(),rO=Cd(y6());_6.default={IS_READ_ONLY:rO.default.IS_READ_ONLY,parseCommand(...$){rO.default.parseCommand(...$),$[0].push("WITHSCORES","WITHPAYLOADS")},transformReply:{2:($,J,Q)=>{if((0,D8.isNullReply)($))return null;let z=Array($.length/3),q=0,Z=0;while(q<$.length)z[Z++]={suggestion:$[q++],score:D8.transformDoubleReply[2]($[q++],J,Q),payload:$[q++]};return z},3:($)=>{if((0,D8.isNullReply)($))return null;let J=Array($.length/3),Q=0,z=0;while(Q<$.length)J[z++]={suggestion:$[Q++],score:$[Q++],payload:$[Q++]};return J}}}});var JD=w((c6)=>{var Td=c6&&c6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(c6,"__esModule",{value:!0});var A8=X(),$D=Td(y6());c6.default={IS_READ_ONLY:$D.default.IS_READ_ONLY,parseCommand(...$){$D.default.parseCommand(...$),$[0].push("WITHSCORES")},transformReply:{2:($,J,Q)=>{if((0,A8.isNullReply)($))return null;let z=Array($.length/2),q=0,Z=0;while(q<$.length)z[Z++]={suggestion:$[q++],score:A8.transformDoubleReply[2]($[q++],J,Q)};return z},3:($)=>{if((0,A8.isNullReply)($))return null;let J=Array($.length/2),Q=0,z=0;while(Q<$.length)J[z++]={suggestion:$[Q++],score:$[Q++]};return J}}}});var zD=w((QD)=>{Object.defineProperty(QD,"__esModule",{value:!0});QD.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("FT.SUGLEN",J)},transformReply:void 0}});var wD=w((qD)=>{Object.defineProperty(qD,"__esModule",{value:!0});qD.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("FT.SYNDUMP",J)},transformReply:{2:($)=>{let J={},Q=0;while(Q<$.length){let z=$[Q++].toString(),q=$[Q++];J[z]=q}return J},3:void 0}}});var KD=w((ZD)=>{Object.defineProperty(ZD,"__esModule",{value:!0});ZD.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q,z,q){if($.push("FT.SYNUPDATE",J,Q),q?.SKIPINITIALSCAN)$.push("SKIPINITIALSCAN");$.pushVariadic(z)},transformReply:void 0}});var VD=w((WD)=>{Object.defineProperty(WD,"__esModule",{value:!0});WD.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("FT.TAGVALS",J,Q)},transformReply:{2:void 0,3:void 0}}});var mD=w((d6)=>{var U=d6&&d6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(d6,"__esModule",{value:!0});var YD=U(iI()),XD=U(sI()),FD=U(N8()),HD=U(E6()),BD=U(XO()),jD=U(HO()),vD=U(jO()),GD=U(GO()),PD=U(bO()),bD=U(L7()),UD=U(hO()),hD=U(NO()),ND=U(OO()),ID=U(AO()),OD=U(CO()),DD=U(LO()),AD=U(MO()),xD=U(EO()),CD=U(gO()),TD=U(yO()),LD=U(_O()),fD=U(cO()),MD=U(b$()),SD=U(mO()),ED=U(nO()),kD=U(aO()),gD=U(sO()),RD=U(eO()),yD=U(JD()),uD=U(y6()),_D=U(zD()),cD=U(wD()),dD=U(KD()),lD=U(VD());d6.default={_LIST:YD.default,_list:YD.default,ALTER:XD.default,alter:XD.default,AGGREGATE_WITHCURSOR:FD.default,aggregateWithCursor:FD.default,AGGREGATE:HD.default,aggregate:HD.default,ALIASADD:BD.default,aliasAdd:BD.default,ALIASDEL:jD.default,aliasDel:jD.default,ALIASUPDATE:vD.default,aliasUpdate:vD.default,CONFIG_GET:GD.default,configGet:GD.default,CONFIG_SET:PD.default,configSet:PD.default,CREATE:bD.default,create:bD.default,CURSOR_DEL:UD.default,cursorDel:UD.default,CURSOR_READ:hD.default,cursorRead:hD.default,DICTADD:ND.default,dictAdd:ND.default,DICTDEL:ID.default,dictDel:ID.default,DICTDUMP:OD.default,dictDump:OD.default,DROPINDEX:DD.default,dropIndex:DD.default,EXPLAIN:AD.default,explain:AD.default,EXPLAINCLI:xD.default,explainCli:xD.default,INFO:CD.default,info:CD.default,PROFILESEARCH:TD.default,profileSearch:TD.default,PROFILEAGGREGATE:LD.default,profileAggregate:LD.default,SEARCH_NOCONTENT:fD.default,searchNoContent:fD.default,SEARCH:MD.default,search:MD.default,SPELLCHECK:SD.default,spellCheck:SD.default,SUGADD:ED.default,sugAdd:ED.default,SUGDEL:kD.default,sugDel:kD.default,SUGGET_WITHPAYLOADS:gD.default,sugGetWithPayloads:gD.default,SUGGET_WITHSCORES_WITHPAYLOADS:RD.default,sugGetWithScoresWithPayloads:RD.default,SUGGET_WITHSCORES:yD.default,sugGetWithScores:yD.default,SUGGET:uD.default,sugGet:uD.default,SUGLEN:_D.default,sugLen:_D.default,SYNDUMP:cD.default,synDump:cD.default,SYNUPDATE:dD.default,synUpdate:dD.default,TAGVALS:lD.default,tagVals:lD.default}});var x8=w((T)=>{var Ed=T&&T.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(T,"__esModule",{value:!0});T.FT_AGGREGATE_STEPS=T.FT_AGGREGATE_GROUP_BY_REDUCERS=T.SCHEMA_VECTOR_FIELD_ALGORITHM=T.SCHEMA_TEXT_FIELD_PHONETIC=T.SCHEMA_FIELD_TYPE=T.REDISEARCH_LANGUAGE=T.default=void 0;var kd=mD();Object.defineProperty(T,"default",{enumerable:!0,get:function(){return Ed(kd).default}});var f7=L7();Object.defineProperty(T,"REDISEARCH_LANGUAGE",{enumerable:!0,get:function(){return f7.REDISEARCH_LANGUAGE}});Object.defineProperty(T,"SCHEMA_FIELD_TYPE",{enumerable:!0,get:function(){return f7.SCHEMA_FIELD_TYPE}});Object.defineProperty(T,"SCHEMA_TEXT_FIELD_PHONETIC",{enumerable:!0,get:function(){return f7.SCHEMA_TEXT_FIELD_PHONETIC}});Object.defineProperty(T,"SCHEMA_VECTOR_FIELD_ALGORITHM",{enumerable:!0,get:function(){return f7.SCHEMA_VECTOR_FIELD_ALGORITHM}});var iD=E6();Object.defineProperty(T,"FT_AGGREGATE_GROUP_BY_REDUCERS",{enumerable:!0,get:function(){return iD.FT_AGGREGATE_GROUP_BY_REDUCERS}});Object.defineProperty(T,"FT_AGGREGATE_STEPS",{enumerable:!0,get:function(){return iD.FT_AGGREGATE_STEPS}})});var L=w((nD)=>{Object.defineProperty(nD,"__esModule",{value:!0});nD.transformRESP2LabelsWithSources=nD.transformRESP2Labels=nD.parseSelectedLabelsArguments=nD.resp3MapToValue=nD.resp2MapToValue=nD.transformSamplesReply=nD.transformSampleReply=nD.parseLabelsArgument=nD.transformTimestampArgument=nD.parseDuplicatePolicy=nD.TIME_SERIES_DUPLICATE_POLICIES=nD.parseChunkSizeArgument=nD.parseEncodingArgument=nD.TIME_SERIES_ENCODING=nD.parseRetentionArgument=nD.parseIgnoreArgument=void 0;var T8=D6();function gd($,J){if(J!==void 0)$.push("IGNORE",J.maxTimeDiff.toString(),J.maxValDiff.toString())}nD.parseIgnoreArgument=gd;function Rd($,J){if(J!==void 0)$.push("RETENTION",J.toString())}nD.parseRetentionArgument=Rd;nD.TIME_SERIES_ENCODING={COMPRESSED:"COMPRESSED",UNCOMPRESSED:"UNCOMPRESSED"};function yd($,J){if(J!==void 0)$.push("ENCODING",J)}nD.parseEncodingArgument=yd;function ud($,J){if(J!==void 0)$.push("CHUNK_SIZE",J.toString())}nD.parseChunkSizeArgument=ud;nD.TIME_SERIES_DUPLICATE_POLICIES={BLOCK:"BLOCK",FIRST:"FIRST",LAST:"LAST",MIN:"MIN",MAX:"MAX",SUM:"SUM"};function _d($,J){if(J!==void 0)$.push("DUPLICATE_POLICY",J)}nD.parseDuplicatePolicy=_d;function cd($){if(typeof $==="string")return $;return(typeof $==="number"?$:$.getTime()).toString()}nD.transformTimestampArgument=cd;function dd($,J){if(J){$.push("LABELS");for(let[Q,z]of Object.entries(J))$.push(Q,z)}}nD.parseLabelsArgument=dd;nD.transformSampleReply={2($){let[J,Q]=$;return{timestamp:J,value:Number(Q)}},3($){let[J,Q]=$;return{timestamp:J,value:Q}}};nD.transformSamplesReply={2($){return $.map((J)=>nD.transformSampleReply[2](J))},3($){return $.map((J)=>nD.transformSampleReply[3](J))}};function ld($,J,Q){let z=$;switch(Q?.[T8.RESP_TYPES.MAP]){case Map:{let q=new Map;for(let Z of z){let W=Z,V=W[0];q.set(V.toString(),J(W))}return q}case Array:{for(let q of z){let Z=q;Z[1]=J(Z)}return z}default:{let q=Object.create(null);for(let Z of z){let W=Z,V=W[0];q[V.toString()]=J(W)}return q}}}nD.resp2MapToValue=ld;function md($,J){let Q=$;if(Q instanceof Array)for(let z=1;z<Q.length;z+=2)Q[z]=J(Q[z]);else if(Q instanceof Map)for(let[z,q]of Q.entries())Q.set(z,J(q));else for(let[z,q]of Object.entries(Q))Q[z]=J(q);return Q}nD.resp3MapToValue=md;function id($,J){$.push("SELECTED_LABELS"),$.pushVariadic(J)}nD.parseSelectedLabelsArguments=id;function nd($,J){let Q=$;switch(J?.[T8.RESP_TYPES.MAP]){case Map:let z=new Map;for(let Z of Q){let[W,V]=Z,Y=W;z.set(Y.toString(),V)}return z;case Array:return Q.flat();case Object:default:let q=Object.create(null);for(let Z of Q){let[W,V]=Z,Y=W;q[Y.toString()]=V}return q}}nD.transformRESP2Labels=nd;function td($,J){let Q=$,z=Q.length-2,q;switch(J?.[T8.RESP_TYPES.MAP]){case Map:let Y=new Map;for(let H=0;H<z;H++){let[B,v]=Q[H],x=B;Y.set(x.toString(),v)}q=Y;break;case Array:q=Q.slice(0,z).flat();break;case Object:default:let F=Object.create(null);for(let H=0;H<z;H++){let[B,v]=Q[H],x=B;F[x.toString()]=v}q=F;break}let W=Q[Q.length-1],V=ad(W[1]);return{labels:q,sources:V}}nD.transformRESP2LabelsWithSources=td;function ad($){let J=$;if(typeof J==="string")return J.split(",");let Q=J.indexOf(",");if(Q===-1)return[J];let z=[J.subarray(0,Q)],q=Q+1;while(!0){let Z=J.indexOf(",",q);if(Z===-1){z.push(J.subarray(q));break}let W=J.subarray(q,Z);z.push(W),q=Z+1}return z}});var oD=w((aD)=>{Object.defineProperty(aD,"__esModule",{value:!0});var h$=L();aD.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q){if($.push("TS.ADD"),$.pushKey(J),$.push((0,h$.transformTimestampArgument)(Q),z.toString()),(0,h$.parseRetentionArgument)($,q?.RETENTION),(0,h$.parseEncodingArgument)($,q?.ENCODING),(0,h$.parseChunkSizeArgument)($,q?.CHUNK_SIZE),q?.ON_DUPLICATE)$.push("ON_DUPLICATE",q.ON_DUPLICATE);(0,h$.parseLabelsArgument)($,q?.LABELS),(0,h$.parseIgnoreArgument)($,q?.IGNORE)},transformReply:void 0}});var sD=w((pD)=>{Object.defineProperty(pD,"__esModule",{value:!0});var l6=L();pD.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("TS.ALTER"),$.pushKey(J),(0,l6.parseRetentionArgument)($,Q?.RETENTION),(0,l6.parseChunkSizeArgument)($,Q?.CHUNK_SIZE),(0,l6.parseDuplicatePolicy)($,Q?.DUPLICATE_POLICY),(0,l6.parseLabelsArgument)($,Q?.LABELS),(0,l6.parseIgnoreArgument)($,Q?.IGNORE)},transformReply:void 0}});var eD=w((rD)=>{Object.defineProperty(rD,"__esModule",{value:!0});var N$=L();rD.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("TS.CREATE"),$.pushKey(J),(0,N$.parseRetentionArgument)($,Q?.RETENTION),(0,N$.parseEncodingArgument)($,Q?.ENCODING),(0,N$.parseChunkSizeArgument)($,Q?.CHUNK_SIZE),(0,N$.parseDuplicatePolicy)($,Q?.DUPLICATE_POLICY),(0,N$.parseLabelsArgument)($,Q?.LABELS),(0,N$.parseIgnoreArgument)($,Q?.IGNORE)},transformReply:void 0}});var L8=w(($A)=>{Object.defineProperty($A,"__esModule",{value:!0});$A.TIME_SERIES_AGGREGATION_TYPE=void 0;$A.TIME_SERIES_AGGREGATION_TYPE={AVG:"AVG",FIRST:"FIRST",LAST:"LAST",MIN:"MIN",MAX:"MAX",SUM:"SUM",RANGE:"RANGE",COUNT:"COUNT",STD_P:"STD.P",STD_S:"STD.S",VAR_P:"VAR.P",VAR_S:"VAR.S",TWA:"TWA"};$A.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z,q,Z){if($.push("TS.CREATERULE"),$.pushKeys([J,Q]),$.push("AGGREGATION",z,q.toString()),Z!==void 0)$.push(Z.toString())},transformReply:void 0}});var f8=w((zA)=>{Object.defineProperty(zA,"__esModule",{value:!0});zA.parseIncrByArguments=void 0;var m6=L();function QA($,J,Q,z){if($.pushKey(J),$.push(Q.toString()),z?.TIMESTAMP!==void 0&&z?.TIMESTAMP!==null)$.push("TIMESTAMP",(0,m6.transformTimestampArgument)(z.TIMESTAMP));if((0,m6.parseRetentionArgument)($,z?.RETENTION),z?.UNCOMPRESSED)$.push("UNCOMPRESSED");(0,m6.parseChunkSizeArgument)($,z?.CHUNK_SIZE),(0,m6.parseLabelsArgument)($,z?.LABELS),(0,m6.parseIgnoreArgument)($,z?.IGNORE)}zA.parseIncrByArguments=QA;zA.default={IS_READ_ONLY:!1,parseCommand(...$){$[0].push("TS.INCRBY"),QA(...$)},transformReply:void 0}});var wA=w((D0)=>{var Bl=D0&&D0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),jl=D0&&D0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),vl=D0&&D0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Bl(J,$,Q)}return jl(J,$),J};Object.defineProperty(D0,"__esModule",{value:!0});var M8=vl(f8());D0.default={IS_READ_ONLY:M8.default.IS_READ_ONLY,parseCommand(...$){$[0].push("TS.DECRBY"),(0,M8.parseIncrByArguments)(...$)},transformReply:M8.default.transformReply}});var WA=w((KA)=>{Object.defineProperty(KA,"__esModule",{value:!0});var ZA=L();KA.default={IS_READ_ONLY:!1,parseCommand($,J,Q,z){$.push("TS.DEL"),$.pushKey(J),$.push((0,ZA.transformTimestampArgument)(Q),(0,ZA.transformTimestampArgument)(z))},transformReply:void 0}});var YA=w((VA)=>{Object.defineProperty(VA,"__esModule",{value:!0});VA.default={IS_READ_ONLY:!1,parseCommand($,J,Q){$.push("TS.DELETERULE"),$.pushKeys([J,Q])},transformReply:void 0}});var FA=w((XA)=>{Object.defineProperty(XA,"__esModule",{value:!0});XA.default={IS_READ_ONLY:!0,parseCommand($,J,Q){if($.push("TS.GET"),$.pushKey(J),Q?.LATEST)$.push("LATEST")},transformReply:{2($){return $.length===0?null:{timestamp:$[0],value:Number($[1])}},3($){return $.length===0?null:{timestamp:$[0],value:$[1]}}}}});var S8=w((HA)=>{Object.defineProperty(HA,"__esModule",{value:!0});var Ul=X();HA.default={IS_READ_ONLY:!0,parseCommand($,J){$.push("TS.INFO"),$.pushKey(J)},transformReply:{2:($,J,Q)=>{let z={};for(let q=0;q<$.length;q+=2){let Z=$[q].toString();switch(Z){case"totalSamples":case"memoryUsage":case"firstTimestamp":case"lastTimestamp":case"retentionTime":case"chunkCount":case"chunkSize":case"chunkType":case"duplicatePolicy":case"sourceKey":case"ignoreMaxTimeDiff":z[Z]=$[q+1];break;case"labels":z[Z]=$[q+1].map(([W,V])=>({name:W,value:V}));break;case"rules":z[Z]=$[q+1].map(([W,V,Y])=>({key:W,timeBucket:V,aggregationType:Y}));break;case"ignoreMaxValDiff":z[Z]=Ul.transformDoubleReply[2]($[27],void 0,Q);break}}return z},3:void 0},unstableResp3:!0}});var BA=w((i6)=>{var Nl=i6&&i6.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(i6,"__esModule",{value:!0});var E8=Nl(S8());i6.default={IS_READ_ONLY:E8.default.IS_READ_ONLY,parseCommand($,J){E8.default.parseCommand($,J),$.push("DEBUG")},transformReply:{2:($,J,Q)=>{let z=E8.default.transformReply[2]($,J,Q);for(let q=0;q<$.length;q+=2){let Z=$[q].toString();switch(Z){case"keySelfName":{z[Z]=$[q+1];break}case"Chunks":{z.chunks=$[q+1].map((W)=>({startTimestamp:W[1],endTimestamp:W[3],samples:W[5],size:W[7],bytesPerSample:W[9]}));break}}}return z},3:void 0},unstableResp3:!0}});var vA=w((jA)=>{Object.defineProperty(jA,"__esModule",{value:!0});var Il=L();jA.default={IS_READ_ONLY:!1,parseCommand($,J){$.push("TS.MADD");for(let{key:Q,timestamp:z,value:q}of J)$.pushKey(Q),$.push((0,Il.transformTimestampArgument)(z),q.toString())},transformReply:void 0}});var r=w((bA)=>{Object.defineProperty(bA,"__esModule",{value:!0});bA.parseFilterArgument=bA.parseLatestArgument=void 0;var M7=L();function GA($,J){if(J)$.push("LATEST")}bA.parseLatestArgument=GA;function PA($,J){$.push("FILTER"),$.pushVariadic(J)}bA.parseFilterArgument=PA;bA.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("TS.MGET"),GA($,Q?.LATEST),PA($,J)},transformReply:{2($,J,Q){return(0,M7.resp2MapToValue)($,([,,z])=>{return{sample:M7.transformSampleReply[2](z)}},Q)},3($){return(0,M7.resp3MapToValue)($,([,J])=>{return{sample:M7.transformSampleReply[3](J)}})}}}});var k8=w((IA)=>{Object.defineProperty(IA,"__esModule",{value:!0});IA.createTransformMGetLabelsReply=void 0;var hA=r(),n6=L();function NA(){return{2($,J,Q){return(0,n6.resp2MapToValue)($,([,z,q])=>{return{labels:(0,n6.transformRESP2Labels)(z),sample:n6.transformSampleReply[2](q)}},Q)},3($){return(0,n6.resp3MapToValue)($,([J,Q])=>{return{labels:J,sample:n6.transformSampleReply[3](Q)}})}}}IA.createTransformMGetLabelsReply=NA;IA.default={IS_READ_ONLY:!0,parseCommand($,J,Q){$.push("TS.MGET"),(0,hA.parseLatestArgument)($,Q?.LATEST),$.push("WITHLABELS"),(0,hA.parseFilterArgument)($,J)},transformReply:NA()}});var xA=w((AA)=>{Object.defineProperty(AA,"__esModule",{value:!0});var DA=r(),Cl=L(),Tl=k8();AA.default={IS_READ_ONLY:!0,parseCommand($,J,Q,z){$.push("TS.MGET"),(0,DA.parseLatestArgument)($,z?.LATEST),(0,Cl.parseSelectedLabelsArguments)($,Q),(0,DA.parseFilterArgument)($,J)},transformReply:(0,Tl.createTransformMGetLabelsReply)()}});var e=w((LA)=>{Object.defineProperty(LA,"__esModule",{value:!0});LA.transformRangeArguments=LA.parseRangeArguments=LA.TIME_SERIES_BUCKET_TIMESTAMP=void 0;var r0=L();LA.TIME_SERIES_BUCKET_TIMESTAMP={LOW:"-",MIDDLE:"~",END:"+"};function CA($,J,Q,z){if($.push((0,r0.transformTimestampArgument)(J),(0,r0.transformTimestampArgument)(Q)),z?.LATEST)$.push("LATEST");if(z?.FILTER_BY_TS){$.push("FILTER_BY_TS");for(let q of z.FILTER_BY_TS)$.push((0,r0.transformTimestampArgument)(q))}if(z?.FILTER_BY_VALUE)$.push("FILTER_BY_VALUE",z.FILTER_BY_VALUE.min.toString(),z.FILTER_BY_VALUE.max.toString());if(z?.COUNT!==void 0)$.push("COUNT",z.COUNT.toString());if(z?.AGGREGATION){if(z?.ALIGN!==void 0)$.push("ALIGN",(0,r0.transformTimestampArgument)(z.ALIGN));if($.push("AGGREGATION",z.AGGREGATION.type,(0,r0.transformTimestampArgument)(z.AGGREGATION.timeBucket)),z.AGGREGATION.BUCKETTIMESTAMP)$.push("BUCKETTIMESTAMP",z.AGGREGATION.BUCKETTIMESTAMP);if(z.AGGREGATION.EMPTY)$.push("EMPTY")}}LA.parseRangeArguments=CA;function TA($,J,Q,z,q){$.pushKey(J),CA($,Q,z,q)}LA.transformRangeArguments=TA;LA.default={IS_READ_ONLY:!0,parseCommand(...$){$[0].push("TS.RANGE"),TA(...$)},transformReply:{2($){return r0.transformSamplesReply[2]($)},3($){return r0.transformSamplesReply[3]($)}}}});var I$=w((kA)=>{Object.defineProperty(kA,"__esModule",{value:!0});kA.extractResp3MRangeSources=kA.createTransformMRangeGroupByArguments=kA.parseGroupByArguments=kA.TIME_SERIES_REDUCERS=void 0;var S7=L(),El=e(),kl=r();kA.TIME_SERIES_REDUCERS={AVG:"AVG",SUM:"SUM",MIN:"MIN",MAX:"MAX",RANGE:"RANGE",COUNT:"COUNT",STD_P:"STD.P",STD_S:"STD.S",VAR_P:"VAR.P",VAR_S:"VAR.S"};function MA($,J){$.push("GROUPBY",J.label,"REDUCE",J.REDUCE)}kA.parseGroupByArguments=MA;function SA($){return(J,Q,z,q,Z,W)=>{J.push($),(0,El.parseRangeArguments)(J,Q,z,W),(0,kl.parseFilterArgument)(J,q),MA(J,Z)}}kA.createTransformMRangeGroupByArguments=SA;function EA($){let J=$;if(J instanceof Map)return J.get("sources");else if(J instanceof Array)return J[1];else return J.sources}kA.extractResp3MRangeSources=EA;kA.default={IS_READ_ONLY:!0,parseCommand:SA("TS.MRANGE"),transformReply:{2($,J,Q){return(0,S7.resp2MapToValue)($,([z,q,Z])=>{return{samples:S7.transformSamplesReply[2](Z)}},Q)},3($){return(0,S7.resp3MapToValue)($,([J,Q,z,q])=>{return{sources:EA(z),samples:S7.transformSamplesReply[3](q)}})}}}});var E7=w((yA)=>{Object.defineProperty(yA,"__esModule",{value:!0});yA.createTransformMRangeSelectedLabelsArguments=void 0;var O$=L(),_l=e(),cl=r();function RA($){return(J,Q,z,q,Z,W)=>{J.push($),(0,_l.parseRangeArguments)(J,Q,z,W),(0,O$.parseSelectedLabelsArguments)(J,q),(0,cl.parseFilterArgument)(J,Z)}}yA.createTransformMRangeSelectedLabelsArguments=RA;yA.default={IS_READ_ONLY:!0,parseCommand:RA("TS.MRANGE"),transformReply:{2($,J,Q){return(0,O$.resp2MapToValue)($,([z,q,Z])=>{return{labels:(0,O$.transformRESP2Labels)(q,Q),samples:O$.transformSamplesReply[2](Z)}},Q)},3($){return(0,O$.resp3MapToValue)($,([J,Q,z])=>{return{labels:Q,samples:O$.transformSamplesReply[3](z)}})}}}});var R8=w((e0)=>{var ll=e0&&e0.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(e0,"__esModule",{value:!0});e0.createMRangeSelectedLabelsGroupByTransformArguments=void 0;var g8=L(),ml=e(),_A=I$(),il=r(),nl=ll(E7());function cA($){return(J,Q,z,q,Z,W,V)=>{J.push($),(0,ml.parseRangeArguments)(J,Q,z,V),(0,g8.parseSelectedLabelsArguments)(J,q),(0,il.parseFilterArgument)(J,Z),(0,_A.parseGroupByArguments)(J,W)}}e0.createMRangeSelectedLabelsGroupByTransformArguments=cA;e0.default={IS_READ_ONLY:!0,parseCommand:cA("TS.MRANGE"),transformReply:{2:nl.default.transformReply[2],3($){return(0,g8.resp3MapToValue)($,([J,Q,z,q])=>{return{labels:J,sources:(0,_A.extractResp3MRangeSources)(z),samples:g8.transformSamplesReply[3](q)}})}}}});var y8=w((mA)=>{Object.defineProperty(mA,"__esModule",{value:!0});mA.createMRangeWithLabelsGroupByTransformArguments=void 0;var t6=L(),tl=e(),dA=I$(),al=r();function lA($){return(J,Q,z,q,Z,W)=>{J.push($),(0,tl.parseRangeArguments)(J,Q,z,W),J.push("WITHLABELS"),(0,al.parseFilterArgument)(J,q),(0,dA.parseGroupByArguments)(J,Z)}}mA.createMRangeWithLabelsGroupByTransformArguments=lA;mA.default={IS_READ_ONLY:!0,parseCommand:lA("TS.MRANGE"),transformReply:{2($,J,Q){return(0,t6.resp2MapToValue)($,([z,q,Z])=>{let W=(0,t6.transformRESP2LabelsWithSources)(q);return{labels:W.labels,sources:W.sources,samples:t6.transformSamplesReply[2](Z)}},Q)},3($){return(0,t6.resp3MapToValue)($,([J,Q,z,q])=>{return{labels:J,sources:(0,dA.extractResp3MRangeSources)(z),samples:t6.transformSamplesReply[3](q)}})}}}});var u8=w((tA)=>{Object.defineProperty(tA,"__esModule",{value:!0});tA.createTransformMRangeWithLabelsArguments=void 0;var k7=L(),pl=e(),sl=r();function nA($){return(J,Q,z,q,Z)=>{J.push($),(0,pl.parseRangeArguments)(J,Q,z,Z),J.push("WITHLABELS"),(0,sl.parseFilterArgument)(J,q)}}tA.createTransformMRangeWithLabelsArguments=nA;tA.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand:nA("TS.MRANGE"),transformReply:{2($,J,Q){return(0,k7.resp2MapToValue)($,([z,q,Z])=>{let W=q,V=Object.create(null);for(let Y of W){let[F,H]=Y,B=F;V[B.toString()]=H}return{labels:V,samples:k7.transformSamplesReply[2](Z)}},Q)},3($){return(0,k7.resp3MapToValue)($,([J,Q,z])=>{return{labels:J,samples:k7.transformSamplesReply[3](z)}})}}}});var _8=w((pA)=>{Object.defineProperty(pA,"__esModule",{value:!0});pA.createTransformMRangeArguments=void 0;var g7=L(),el=e(),$m=r();function oA($){return(J,Q,z,q,Z)=>{J.push($),(0,el.parseRangeArguments)(J,Q,z,Z),(0,$m.parseFilterArgument)(J,q)}}pA.createTransformMRangeArguments=oA;pA.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand:oA("TS.MRANGE"),transformReply:{2($,J,Q){return(0,g7.resp2MapToValue)($,([z,q,Z])=>{return g7.transformSamplesReply[2](Z)},Q)},3($){return(0,g7.resp3MapToValue)($,([J,Q,z])=>{return g7.transformSamplesReply[3](z)})}}}});var rA=w((A0)=>{var Qm=A0&&A0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),zm=A0&&A0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),qm=A0&&A0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Qm(J,$,Q)}return zm(J,$),J};Object.defineProperty(A0,"__esModule",{value:!0});var c8=qm(I$());A0.default={IS_READ_ONLY:c8.default.IS_READ_ONLY,parseCommand:(0,c8.createTransformMRangeGroupByArguments)("TS.MREVRANGE"),transformReply:c8.default.transformReply}});var eA=w((x0)=>{var wm=x0&&x0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Zm=x0&&x0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Km=x0&&x0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))wm(J,$,Q)}return Zm(J,$),J};Object.defineProperty(x0,"__esModule",{value:!0});var d8=Km(R8());x0.default={IS_READ_ONLY:d8.default.IS_READ_ONLY,parseCommand:(0,d8.createMRangeSelectedLabelsGroupByTransformArguments)("TS.MREVRANGE"),transformReply:d8.default.transformReply}});var $x=w((C0)=>{var Wm=C0&&C0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Vm=C0&&C0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Ym=C0&&C0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Wm(J,$,Q)}return Vm(J,$),J};Object.defineProperty(C0,"__esModule",{value:!0});var l8=Ym(E7());C0.default={IS_READ_ONLY:l8.default.IS_READ_ONLY,parseCommand:(0,l8.createTransformMRangeSelectedLabelsArguments)("TS.MREVRANGE"),transformReply:l8.default.transformReply}});var Jx=w((T0)=>{var Xm=T0&&T0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Fm=T0&&T0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Hm=T0&&T0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Xm(J,$,Q)}return Fm(J,$),J};Object.defineProperty(T0,"__esModule",{value:!0});var m8=Hm(y8());T0.default={IS_READ_ONLY:m8.default.IS_READ_ONLY,parseCommand:(0,m8.createMRangeWithLabelsGroupByTransformArguments)("TS.MREVRANGE"),transformReply:m8.default.transformReply}});var Qx=w((L0)=>{var Bm=L0&&L0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),jm=L0&&L0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),vm=L0&&L0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Bm(J,$,Q)}return jm(J,$),J};Object.defineProperty(L0,"__esModule",{value:!0});var R7=vm(u8());L0.default={NOT_KEYED_COMMAND:R7.default.NOT_KEYED_COMMAND,IS_READ_ONLY:R7.default.IS_READ_ONLY,parseCommand:(0,R7.createTransformMRangeWithLabelsArguments)("TS.MREVRANGE"),transformReply:R7.default.transformReply}});var zx=w((f0)=>{var Gm=f0&&f0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Pm=f0&&f0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),bm=f0&&f0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))Gm(J,$,Q)}return Pm(J,$),J};Object.defineProperty(f0,"__esModule",{value:!0});var y7=bm(_8());f0.default={NOT_KEYED_COMMAND:y7.default.NOT_KEYED_COMMAND,IS_READ_ONLY:y7.default.IS_READ_ONLY,parseCommand:(0,y7.createTransformMRangeArguments)("TS.MREVRANGE"),transformReply:y7.default.transformReply}});var wx=w((qx)=>{Object.defineProperty(qx,"__esModule",{value:!0});qx.default={NOT_KEYED_COMMAND:!0,IS_READ_ONLY:!0,parseCommand($,J){$.push("TS.QUERYINDEX"),$.pushVariadic(J)},transformReply:{2:void 0,3:void 0}}});var Zx=w((M0)=>{var hm=M0&&M0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Nm=M0&&M0.__setModuleDefault||(Object.create?function($,J){Object.defineProperty($,"default",{enumerable:!0,value:J})}:function($,J){$.default=J}),Im=M0&&M0.__importStar||function($){if($&&$.__esModule)return $;var J={};if($!=null){for(var Q in $)if(Q!=="default"&&Object.prototype.hasOwnProperty.call($,Q))hm(J,$,Q)}return Nm(J,$),J};Object.defineProperty(M0,"__esModule",{value:!0});var i8=Im(e());M0.default={IS_READ_ONLY:i8.default.IS_READ_ONLY,parseCommand(...$){$[0].push("TS.REVRANGE"),(0,i8.transformRangeArguments)(...$)},transformReply:i8.default.transformReply}});var Rx=w(($0)=>{var Om=$0&&$0.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),Dm=$0&&$0.__exportStar||function($,J){for(var Q in $)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(J,Q))Om(J,$,Q)},h=$0&&$0.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty($0,"__esModule",{value:!0});var Kx=h(oD()),Wx=h(sD()),Vx=h(eD()),Yx=h(L8()),Xx=h(wA()),Fx=h(WA()),Hx=h(YA()),Bx=h(FA()),jx=h(f8()),vx=h(BA()),Gx=h(S8()),Px=h(vA()),bx=h(xA()),Ux=h(k8()),hx=h(r()),Nx=h(I$()),Ix=h(R8()),Ox=h(E7()),Dx=h(y8()),Ax=h(u8()),xx=h(_8()),Cx=h(rA()),Tx=h(eA()),Lx=h($x()),fx=h(Jx()),Mx=h(Qx()),Sx=h(zx()),Ex=h(wx()),kx=h(e()),gx=h(Zx());Dm(L(),$0);$0.default={ADD:Kx.default,add:Kx.default,ALTER:Wx.default,alter:Wx.default,CREATE:Vx.default,create:Vx.default,CREATERULE:Yx.default,createRule:Yx.default,DECRBY:Xx.default,decrBy:Xx.default,DEL:Fx.default,del:Fx.default,DELETERULE:Hx.default,deleteRule:Hx.default,GET:Bx.default,get:Bx.default,INCRBY:jx.default,incrBy:jx.default,INFO_DEBUG:vx.default,infoDebug:vx.default,INFO:Gx.default,info:Gx.default,MADD:Px.default,mAdd:Px.default,MGET_SELECTED_LABELS:bx.default,mGetSelectedLabels:bx.default,MGET_WITHLABELS:Ux.default,mGetWithLabels:Ux.default,MGET:hx.default,mGet:hx.default,MRANGE_GROUPBY:Nx.default,mRangeGroupBy:Nx.default,MRANGE_SELECTED_LABELS_GROUPBY:Ix.default,mRangeSelectedLabelsGroupBy:Ix.default,MRANGE_SELECTED_LABELS:Ox.default,mRangeSelectedLabels:Ox.default,MRANGE_WITHLABELS_GROUPBY:Dx.default,mRangeWithLabelsGroupBy:Dx.default,MRANGE_WITHLABELS:Ax.default,mRangeWithLabels:Ax.default,MRANGE:xx.default,mRange:xx.default,MREVRANGE_GROUPBY:Cx.default,mRevRangeGroupBy:Cx.default,MREVRANGE_SELECTED_LABELS_GROUPBY:Tx.default,mRevRangeSelectedLabelsGroupBy:Tx.default,MREVRANGE_SELECTED_LABELS:Lx.default,mRevRangeSelectedLabels:Lx.default,MREVRANGE_WITHLABELS_GROUPBY:fx.default,mRevRangeWithLabelsGroupBy:fx.default,MREVRANGE_WITHLABELS:Mx.default,mRevRangeWithLabels:Mx.default,MREVRANGE:Sx.default,mRevRange:Sx.default,QUERYINDEX:Ex.default,queryIndex:Ex.default,RANGE:kx.default,range:kx.default,REVRANGE:gx.default,revRange:gx.default}});var t8=w((M)=>{var Am=M&&M.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(M,"__esModule",{value:!0});M.TIME_SERIES_REDUCERS=M.TIME_SERIES_BUCKET_TIMESTAMP=M.TIME_SERIES_AGGREGATION_TYPE=M.TIME_SERIES_DUPLICATE_POLICIES=M.TIME_SERIES_ENCODING=M.default=void 0;var n8=Rx();Object.defineProperty(M,"default",{enumerable:!0,get:function(){return Am(n8).default}});Object.defineProperty(M,"TIME_SERIES_ENCODING",{enumerable:!0,get:function(){return n8.TIME_SERIES_ENCODING}});Object.defineProperty(M,"TIME_SERIES_DUPLICATE_POLICIES",{enumerable:!0,get:function(){return n8.TIME_SERIES_DUPLICATE_POLICIES}});var xm=L8();Object.defineProperty(M,"TIME_SERIES_AGGREGATION_TYPE",{enumerable:!0,get:function(){return xm.TIME_SERIES_AGGREGATION_TYPE}});var Cm=e();Object.defineProperty(M,"TIME_SERIES_BUCKET_TIMESTAMP",{enumerable:!0,get:function(){return Cm.TIME_SERIES_BUCKET_TIMESTAMP}});var Tm=I$();Object.defineProperty(M,"TIME_SERIES_REDUCERS",{enumerable:!0,get:function(){return Tm.TIME_SERIES_REDUCERS}})});var yx=w((A)=>{var Lm=A&&A.__createBinding||(Object.create?function($,J,Q,z){if(z===void 0)z=Q;var q=Object.getOwnPropertyDescriptor(J,Q);if(!q||("get"in q?!J.__esModule:q.writable||q.configurable))q={enumerable:!0,get:function(){return J[Q]}};Object.defineProperty($,z,q)}:function($,J,Q,z){if(z===void 0)z=Q;$[z]=J[Q]}),a6=A&&A.__exportStar||function($,J){for(var Q in $)if(Q!=="default"&&!Object.prototype.hasOwnProperty.call(J,Q))Lm(J,$,Q)},u7=A&&A.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(A,"__esModule",{value:!0});A.createSentinel=A.createCluster=A.createClientPool=A.createClient=void 0;var _7=D6(),fm=u7(j8()),Mm=u7(b8()),Sm=u7(x8()),Em=u7(t8());a6(D6(),A);a6(j8(),A);a6(b8(),A);a6(x8(),A);a6(t8(),A);var c7={...fm.default,json:Mm.default,ft:Sm.default,ts:Em.default};function km($){return(0,_7.createClient)({...$,modules:{...c7,...$?.modules}})}A.createClient=km;function gm($,J){return(0,_7.createClientPool)({...$,modules:{...c7,...$?.modules}},J)}A.createClientPool=gm;function Rm($){return(0,_7.createCluster)({...$,modules:{...c7,...$?.modules}})}A.createCluster=Rm;function ym($){return(0,_7.createSentinel)({...$,modules:{...c7,...$?.modules}})}A.createSentinel=ym});var a8=mx(yx(),1),o6=null;function p6($,J){if(!o6)o6=a8.createClient({url:$}),o6.on("error",(Q)=>{J?.error(`Redis Client Error: ${Q.message}`)}),o6.connect().catch((Q)=>{J?.error(`Redis Connect Error: ${Q.message}`)});return o6}function ux($,J){async function Q(Y){let H=await p6($,J).get(Y);return H?JSON.parse(H):null}async function z(Y,F,H,B){let v=p6($,J),x=JSON.stringify(F??null);if(B)await v.sAdd(B,Y);if(H)await v.set(Y,x,{EX:H});else await v.set(Y,x)}async function q(Y,F){let H=p6($,J);if(F)await H.sRem(F,Y);await H.del(Y)}async function Z(Y){let F=p6($,J),H=await F.sMembers(Y);if(H.length)await Promise.all(H.map((B)=>F.del(B))),await F.del(Y)}async function W(Y,F){await p6($,J).publish(Y,F)}async function V(Y,F){let H=a8.createClient({url:$});return H.on("error",(B)=>{J?.error(`Redis Subscriber Error: ${B.message}`)}),await H.connect(),await H.subscribe(Y,async(B)=>{await Promise.resolve(F(B))}),async()=>{await H.unsubscribe(Y),await H.quit()}}return{read:Q,create:z,delete:q,deleteAll:Z,publish:W,subscribe:V}}var S={};function um($,J,Q){let z=`@aperta/cache:channel:${$}`,q=ux(J,Q);function Z(B){let v=new Date;return v.setSeconds(v.getSeconds()+B),v}async function W(B,v,x){if(!S[$])S[$]={};S[$][B]={value:v,expires:Z(x)},await q.create(B,v,x);let s6=JSON.stringify({type:"create",key:B,value:v,ttl:x});await q.publish(z,s6)}async function V(B){if(S[$])delete S[$][B];await q.delete(B);let v=JSON.stringify({type:"delete",key:B});await q.publish(z,v)}async function Y(){delete S[$]}async function F(B){let v=S[$];if(v&&B in v){let s6=v[B];if(new Date<s6.expires)return s6.value;delete v[B]}let x=await q.read(B);if(x)S[$]=S[$]||{},S[$][B]={value:x,expires:Z(60)};return x}async function H(){await q.subscribe(z,async(B)=>{try{let v=JSON.parse(B);if(v.type==="create"){if(!S[$])S[$]={};S[$][v.key]={value:v.value,expires:Z(v.ttl??60)}}else if(v.type==="delete"){if(S[$])delete S[$][v.key]}}catch(v){Q?.error(v.message)}})}return H().catch(Q?.error),{create:W,delete:V,deleteAll:Y,read:F}}export{um as cache};
